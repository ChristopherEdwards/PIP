<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<head>
<title>getRecord (Db Class)</title>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<meta name="generator" content="RoboHelp by eHelp Corporation www.ehelp.com">
<link rel="stylesheet" href="../reports_ns.css"><script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='../reports.css'>");}
//-->
</script>
<script LANGUAGE="JavaScript" TITLE="BSSC Special Effects" src="../ehlpdhtm.js" name="EHELP_DHTM"></script>

<style type="text/css">
<!--
p.whs1 { margin-left:24px; }
table.whs2 { x-cell-content-align:top; width:100%; border-spacing:0px; }
col.whs3 { width:8.865%; }
col.whs4 { width:91.135%; }
tr.whs5 { x-cell-content-align:top; }
td.whs6 { width:8.865%; padding-right:10px; padding-left:10px; border-left-width:1px; border-left-color:#000000; border-top-width:1px; border-top-color:#000000; border-bottom-width:1px; border-bottom-color:#000000; border-right-style:none; }
p.whs7 { margin-left:12px; }
img_whs8 { border:none; width:15px; height:15px; float:none; border-style:none; }
td.whs9 { width:91.135%; padding-right:10px; padding-left:10px; border-top-width:1px; border-top-color:#000000; border-right-width:1px; border-right-color:#000000; border-bottom-width:1px; border-bottom-color:#000000; }
table.whs10 { width:534px; margin-left:18pt; border-spacing:0px; }
td.whs11 { width:102px; padding-left:1px; padding-top:1px; padding-right:1px; padding-bottom:1px; }
td.whs12 { width:432px; padding-left:1px; padding-top:1px; padding-right:1px; padding-bottom:1px; }
p.whs13 { margin-left:24px; x-condition:NotPrintedDocn; }
-->
</style><script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute; left:0px; top:0px; z-index:4; visibility:hidden; }
-->
</style><script type="text/javascript" language="javascript1.2" src="../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whtopic.js"></script>
</head>
<body><script type="text/javascript" language="javascript1.2">
<!--
if (window.gbWhTopic)
{
	if (window.addTocInfo)
	{
	addTocInfo("PSL Classes, Properties, and Methods\nDb Class\nMethods\ngetRecord");
addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	if (window.setRelStartPage)
	{
	setRelStartPage("../pslprogramming_guide.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();
//-->
</script>
<h1>getRecord Method</h1>

<p class=BodyTextBold
	style="x-condition: NotPrintedDocn;">Class: <span style="font-weight: normal;">Db</span></p>

<p class=BodyTextBold
	style="x-condition: NotPrintedDocn;">Description</p>

<p class="whs1">This method retrieves a single record from 
 the database and instantiates an object. The system copies the record 
 from the database into the object incrementally as it references its properties. 
 Use this method to create a new object in modify mode.</p>

<p class="whs1">As of Profile v6.3, this method supports 
 lowercase variables, object.property, and system variables within the 
 host variable syntax. PSL maps these variables and object references into 
 uppercase host variables.</p>

<p class="whs1">Use of the <a href="psl_db_select.htm">Db.select</a> 
 method is preferred over Db.getRecord if either of the following conditions 
 exist:</p>

<ul>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">Retrieving 
 multiple records from a database</p></li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">Retrieving 
 one or more records based on a WHERE clause</p></li>
</ul>

<p class="whs1">Use of the <a href="psl_db_selectdbset.htm">Db.selectDbSet</a> 
 method is preferred over Db.getRecord if any of the following conditions 
 exist:</p>

<ul>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The program 
 subsequently instantiates records using selected columns (i.e., the procedure 
 uses Db.getRecord based on information it retrieved from a select).</p></li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The program 
 passes the object as a parameter.</p></li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The program 
 references more than a few selected columns (e.g., five or more). Db.selectDbSet 
 improves readability in this scenario; however, this is a subjective decision.</p></li>
</ul>

<table x-use-null-cells cellspacing="0" width="100%" class="whs2">
<col class="whs3">
<col class="whs4">

<tr valign="top" class="whs5">
<td width="8.865%" class="whs6">
<p class="whs7"><img src="../image/i_blue_sm.jpg" x-maintain-ratio="TRUE" width="15px" height="15px" border="0" class="img_whs8"></td>
<td width="91.135%" class="whs9">
<p>You should still use the Db.getRecord method when instantiating a single 
 Record&lt;Class&gt; object versus a set of Record&lt;Class&gt; objects. 
 To retrieve multiple records simultaneously, use the <a href="psl_db_select.htm">Db.select</a> 
 method. To define a new object in create mode, use the <a href="psl_class_new.htm">Class.new</a> 
 method.</td></tr>
</table>

<p class=BodyTextBold>Declaration of Record Class Object</p>

<p class=Code>type Record<span style="font-style: italic;"><I>TABLE</I></span> 
 objectName = Db.getRecord(...)</p>

<p class=BodyTextBold>Syntax</p>

<p class=Code>Db.getRecord(literal String table,literal String accessKeys,</p>

<p class=Code>literal boolean classNew)</p>

<p class=BodyTextBold>Parameters</p>

<table x-use-null-cells cellspacing="0" width="534" class="whs10">

<tr valign="top" class="whs5">
<td width="102px" class="whs11">
<p>table</td>
<td width="432px" class="whs12">
<p>A valid database table name.</td></tr>

<tr valign="top" class="whs5">
<td colspan="1" rowspan="1" width="102px" class="whs11">
<p>accessKeys</td>
<td colspan="1" rowspan="1" width="432px" class="whs12">
<p>A comma-separated list of access keys for the table. This parameter 
 can also specify an assignment (e.g., &quot;ACN=:CIFNUM&quot;) or a column 
 reference (e.g., DEP.ACN).</p>
<p>When using this method to instantiate a <a href="psl_literal_scope_variables.htm">literal 
 scope variable</a>, the access keys must be either string literals or 
 literal variables.</td></tr>

<tr valign="top" class="whs5">
<td colspan="1" rowspan="1" width="102px" class="whs11">
<p>classNew</td>
<td colspan="1" rowspan="1" width="432px" class="whs12">
<p>An option that indicates whether a new object is instantiated if the 
 record does not exist. Valid values include 1 to instantiate or <span 
 style="font-weight: bold;"><B>0</B></span> to not instantiate.</p>
<p>The classNew PSL source logic optimizes database IO by eliminating the 
 requirement to use the <a href="psl_db_isdefined.htm">Db.isDefined</a> 
 method in many cases. This parameter can be used in conjunction with the 
 <a href="psl_record_getmode.htm">getMode</a> method, which determines 
 whether the record was instantiated.</p>
<p>For example, you should always check the mode when using getRecord to 
 retrieve DEP or LN records. The generated code for a getRecord for a RecordDEP 
 checks the class of the object. If the class is &quot;L&quot;, the code 
 interprets that as a class.new, even though a record with the keys exists 
 as a loan record. If you do not check the mode and actually save the record, 
 a <a href="psl_record_bypasssave.htm">Record.bypassSave</a> removes the 
 loan record and inserts a deposit record.</td></tr>
</table>

<p class=BodyTextBold>Returns</p>

<p class=BodyIndent>An object of type Record<span style="font-style: italic;"><I>TABLE</I></span> 
 (e.g.,&nbsp;RecordDEP, RecordLN).</p>

<p class=BodyTextBold
	style="x-condition: NotPrintedDocn;">When Became Available</p>

<p class="whs13">v6.4</p>

<p class=Example
	style="background-color: Transparent;">Examples</p>

<p class=Code>type RecordCIF cif = <span style="font-weight: bold;"><B>Db.getRecord(&quot;CIF&quot;,&quot;ACN=:ACN&quot;)</B></span></p>

<p class=Code>set NAM = cif.nam</p>

<p class=Code>set DOB = cif.dob</p>

<p class=Code>set TAXID = cif.taxid</p>

<p class=Code>___________________________________________________________</p>

<p class=Code>type RecordHIST hist = <span style="font-weight: bold;"><B>Db.getRecord(&quot;HIST&quot;,&quot;CID=:CID,TSEQ=:TSEQ&quot;)</B></span></p>

<p class=Code>set TAMT = hist.tamt</p>

<p class=Code>set TLO = hist.tlo</p>

<p class=Code>set TSO = hist.tso</p>

<p class=Code>___________________________________________________________</p>

<p class=Code>type RecordACH ach = <span style="font-weight: bold;"><B>Db.getRecord(&quot;ACH&quot;,&quot;COID=:COID&quot;,1)</B></span></p>

<p class=Code>if ‘ach.getMode() W !,”Record not found so create new one”</p>

<p class=Code>&nbsp;</p>

<p class=Code>*ACN, CID, COID,and TSEQ must be defined prior to these </p>

<p class=Code>getRecord statements.</p>

<script type="text/javascript" language="javascript1.2">
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);
//-->
</script>
</body>
</html>
