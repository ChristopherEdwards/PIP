<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<head>
<title>selectDbSet</title>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<meta name="generator" content="RoboHelp by eHelp Corporation www.ehelp.com">
<link rel="stylesheet" href="../reports_ns.css"><script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='../reports.css'>");}
//-->
</script>
<script LANGUAGE="JavaScript" TITLE="BSSC Special Effects" src="../ehlpdhtm.js" name="EHELP_DHTM"></script>

<style type="text/css">
<!--
p.whs1 { margin-left:24px; }
table.whs2 { x-cell-content-align:top; width:100%; border-spacing:0px; }
col.whs3 { width:8.014%; }
col.whs4 { width:91.986%; }
tr.whs5 { x-cell-content-align:top; }
td.whs6 { width:8.014%; padding-right:10px; padding-left:10px; border-left-width:1px; border-left-color:#000000; border-top-width:1px; border-top-color:#000000; border-bottom-width:1px; border-bottom-color:#000000; border-right-style:none; }
p.whs7 { margin-left:12px; }
img_whs8 { border:none; width:15px; height:15px; float:none; border-style:none; }
td.whs9 { width:91.986%; padding-right:10px; padding-left:10px; border-top-width:1px; border-top-color:#000000; border-right-width:1px; border-right-color:#000000; border-bottom-width:1px; border-bottom-color:#000000; }
table.whs10 { width:552px; margin-left:18pt; border-spacing:0px; }
td.whs11 { width:114px; padding-left:1px; padding-top:1px; padding-right:1px; padding-bottom:1px; }
td.whs12 { width:438px; padding-left:1px; padding-top:1px; padding-right:1px; padding-bottom:1px; }
p.whs13 { margin-left:24px; x-condition:NotPrintedDocn; }
-->
</style><script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute; left:0px; top:0px; z-index:4; visibility:hidden; }
-->
</style><script type="text/javascript" language="javascript1.2" src="../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whtopic.js"></script>
</head>
<body><script type="text/javascript" language="javascript1.2">
<!--
if (window.gbWhTopic)
{
	if (window.addTocInfo)
	{
	addTocInfo("PSL Classes, Properties, and Methods\nDb Class\nMethods\nselectDbSet");
addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	if (window.setRelStartPage)
	{
	setRelStartPage("../pslprogramming_guide.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();
//-->
</script>
<h1>selectDbSet Method</h1>

<p class=BodyTextBold
	style="x-condition: NotPrintedDocn;">Class: <span style="font-weight: normal;">Db</span></p>

<p class=BodyTextBold
	style="x-condition: NotPrintedDocn;">Description</p>

<p class="whs1">This method selects all columns from a table 
 based on the conditions specified in the WHERE clause and stores the information 
 in a type DbSet object. <span style="margin-left: 24px;">Use Db.selectDbSet 
 any time the program logic loops through a ResultSet and subsequently 
 instantiates Record&lt;class&gt; objects based on the key columns.</span></p>

<p class="whs1">Use the <a href="psl_db_getrecord.htm">Db.getRecord</a> 
 method to move the data into an object where the individual columns can 
 be referenced. The instantiated record can be passed and used in other 
 elements.</p>

<p class="whs1">In contrast, the result set from a <a href="psl_db_select.htm">Db.select</a> 
 can be passed; however, the value of passing it is limited, as other elements 
 cannot trust the source of a result set that has been passed into it. 
 </p>

<p class=BodyTextBold
	style="margin-left: 24px;">Using selectDbSet Method versus Result Sets</p>

<p class="whs1">Use of this method is preferred over Db.getRecord 
 if the following conditions exist:</p>

<ul>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The program 
 subsequently instantiates records using selected columns.</p></li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The program 
 passes the object as a parameter.</p></li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The program 
 references more than a few selected columns (e.g., five or more). Db.selectDbSet 
 improves readability in this scenario; however, this is a subjective decision.</p></li>
</ul>

<table x-use-null-cells cellspacing="0" width="100%" class="whs2">
<col class="whs3">
<col class="whs4">

<tr valign="top" class="whs5">
<td width="8.014%" class="whs6">
<p class="whs7"><img src="../image/i_blue_sm.jpg" x-maintain-ratio="TRUE" width="15px" height="15px" border="0" class="img_whs8"></td>
<td width="91.986%" class="whs9">
<p>You should still use the Db.getRecord method when instantiating a single 
 Record&lt;Class&gt; object versus a set of Record&lt;Class&gt; objects. 
 Also, if you only need to select the data, consider using the Db.select 
 method.</td></tr>
</table>

<p class="whs1">Db.selectDbSet does not require validation 
 that a record exists (i.e., Db.isDefined) because it only returns valid 
 records from the database. Using the Db.selectDbSet method (instead of 
 the combination of Db.select and Db.getRecord) results in half of the 
 database IO. Benchmark results on the M database comparing the combination 
 of Db.selectDbSet and Db.getRecord to Db.select and Db.getRecord produced 
 a significant benefit by using the first pair (about 15%). The anticipated 
 benefit on an ORACLE database is more significant (probably over 100% 
 or less than half run-time) due to the reduction in SELECT statements 
 by half.</p>

<p class=BodyTextBold
	style="margin-left: 24px;">Dynamic/Run-Time Parameters</p>

<p class="whs1">The Db.selectDbSet method supports dynamic/run-time 
 parameters (i.e., any combination of SELECT, FROM, WHERE, ORDERBY, GROUPBY). 
 The dynamic select is supported under the following conditions:</p>

<ul>
	
	<li style="font-size: 10pt;"
		class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The variables 
 exe and vsql are not in scope in the subroutine.</p></li>
	
	<li style="font-size: 10pt;"
		class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">Only one 
 dynamic select is allowed within the subroutine.</p></li>
	
	<li style="font-size: 10pt;"
		class=kadov-p-CBullet1><p class=Bullet1
									style="margin-left: 24px;">The ResultSet 
 or DbSet object cannot be passed into or out of the subroutine.</p></li>
</ul>

<p class="whs1">The dynamic select generates a run-time error 
 if the input parameters cause an error within the SQL parser or compiler.</p>

<p class=BodyTextBold
	style="margin-left: 24px;">Lowercase Variables, Properties, and System 
 Variables</p>

<p class="whs1">As of Profile version 6.3, this method supports 
 lowercase variables, object.property, and system variables within the 
 host variable syntax. PSL maps these variables and object references into 
 uppercase host variables.</p>

<p class=BodyTextBold>Declaration of DbSet Class Object</p>

<p class=Code>type DbSet ds = Db.selectDbSet(...)</p>

<p class=BodyTextBold>Syntax</p>

<p class=Code>Db.selectDbSet(literal String table,String whereClause,String 
 orderByClause)</p>

<p class=BodyTextBold>Parameters</p>

<table x-use-null-cells cellspacing="0" width="552" class="whs10">

<tr valign="top" class="whs5">
<td width="114px" class="whs11">
<p>table</td>
<td width="438px" class="whs12">
<p>The name of the table from which to select rows. The table name must 
 be literal.</td></tr>

<tr valign="top" class="whs5">
<td width="114px" class="whs11">
<p>whereClause</td>
<td width="438px" class="whs12">
<p>A valid SQL WHERE clause (optional). Include all query conditions that 
 may exclude a record from retrieval. Minimize the number of records in 
 the DbSet by executing the selection criteria in the DBMS, not in the 
 PSL code.</td></tr>

<tr valign="top" class="whs5">
<td width="114px" class="whs11">
<p>orderByClause</td>
<td width="438px" class="whs12">
<p>A valid SQL ORDER BY clause (optional).</td></tr>
</table>

<p class=BodyTextBold>Returns</p>

<p class=BodyIndent>A DbSet instance<span style="margin-left: 24px;">.</span></p>

<p class=BodyTextBold
	style="x-condition: NotPrintedDocn;">When Became Available</p>

<p class="whs13">Profile&nbsp;v6.4</p>

<p class=Example>Example</p>

<p class=Code>type String BRCITY,BRSTATE,BRZIP,DESC</p>

<p class=Code
	style="font-weight: bold;">type DbSet ds = Db.selectDbSet(“UTBLBRCD”)</p>

<p class=Code>while ds.next() do {</p>

<p class=Code>&nbsp;&nbsp;type 
 RecordUTBLBRCD utblbrcd = ds.getRecord(&quot;UTBLBRCD&quot;)</p>

<p class=Code>&nbsp;&nbsp;set 
 DESC &nbsp;&nbsp;&nbsp;= 
 utblbrcd.desc</p>

<p class=Code>&nbsp;&nbsp;set 
 BRCITY &nbsp;= 
 utblbrcd.brcity</p>

<p class=Code>&nbsp;&nbsp;set 
 BRSTATE = utblbrcd.brstate</p>

<p class=Code>&nbsp;&nbsp;set 
 BRZIP &nbsp;&nbsp;= 
 utblbrcd.brzip</p>

<p class=Code>&nbsp;&nbsp;}</p>

<script type="text/javascript" language="javascript1.2">
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);
//-->
</script>
</body>
</html>
