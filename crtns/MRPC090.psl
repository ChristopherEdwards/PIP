MRPC090(return,versn,CID,crth,drth)
       /*

	// ORIG: VETSENM - 12/06/1999
       // DESC: Manual Generation of SWIFT MT942


        Procedure ID: MRPC090
        DESC: Manual Generation of SWIFT MT942.
        KEYWORDS:
 
        ARGUMENTS:
                . versn   ^MRPC090 version number       /TYP=N/REQ/MECH=VAL
                          current version=1
 
                . MT942CRTH Credit Thresholds          /TYP=T/REQ/MECH=VAL
 
                . MT942DRTH Debit Thresholds          /TYP=T/REQ/MECH=VAL
 
        RETURNS:
                . $$      Error Message                 /TYP=T
                          Null= No Error
  	
		

  ---- Revision History -----------------------------------------------------
  
         11/05/99 - VETSENM - 34282
-----------------------------------------------------------------------------
          */  
       // Version number of client message is not compatible with server
        if $G(versn)'=1 quit $$ERRMSG^PBSUTL($$^MSG(2951))

        // Get the DEP.MT942 and DEP.CRCD.
        new mt942,crcd
        type RecordDEP dep=Db.getRecord("DEP","CID")
        set mt942=dep.mt942
        set crcd=dep.crcd
        // Verify that the DEP.MT942 is set.
        // If not set, set and return error "generate mt942 flag must be setto

        if mt942'=1 set ER=1,RM=$$^MSG(4114),return=""
        quit:$G(ER) $$ERRMSG^PBSUTL($G(RM))
 
        // Verify the decimal precision of the thresholds.
        // If invalid, set and return error
        // MT942CRTH,MT942DRTH


        if crth'=$$^SCARND(crth,0,"",crcd) set ER=1,RM=$$^MSG(775)
        quit:$G(ER) return=$$ERRMSG^PBSUTL($G(RM))
        if drth'=$$^SCARND(drth,0,"",crcd) set ER=1,RM=$$^MSG(775)
        quit:$G(ER) $$ERRMSG^PBSUTL($G(RM))
 
        // Get the current time.
        set gentime=%CurrentTime
	set gendate=%SystemDate
 
        if $G(CID)="" set return=""
        quit:$G(RM)!$G(ER) $$ERRMSG^PBSUTL($G(RM))
	set return=$$V2LV^MSG($G(str))
        // quit ""          

        // Call SW942GEN(account, CRTH, DRTH, Generation Time) routine to
        // generate the MT942 message
        // If an error is returned, return the error.
        //do ext^SW942GEN(CID,gendate,gentime,crth,drth) quit:ER
        set ER=$$ext^SW942GEN(CID,gendate,gentime,crth,drth)
        quit:$G(ER) $$ERRMSG^PBSUTL($G(RM))

        quit ""
  
	
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43589^Sanchez SCM Administrator^2251"	// Signature - LTD^TIME^USER^SIZE
