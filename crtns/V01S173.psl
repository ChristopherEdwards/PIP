V01S173(Number %ProcessMode,RecordCUVAR fCUVAR)   //PBS -  - SID= <CUVARGEN1> General Information (Inst. Identity)
 ;;Copyright(c)2007 Sanchez Computer Associates, Inc.  All Rights Reserved - 08/30/2007 14:25 - joynerd
  /*
ORIG: CHENARDP - 03/03/2003
DESC: PSL Screen Compiler Template

---- Comments --------------------------------------------------------
	This procedure is used as the base template for the PSL screen compiler.
	It is referenced by the PSL screen compiler - procedure DBS2PSL4
	
	
---- Revision History ------------------------------------------------
	02/18/07 - Pete Chenard - CR23555
		   Corrected compiler warnings.
		   
	02/23/06 - Pete Chenard - CR19551
		   Fixed routine label.
		   
	05/19/05 - Pete Chenard - CR 14146
		   Modified to type variables.
		   
	12/1/03 - Spier -cr7178
	   	     Modifications to correct dead code warnings and
	   	     other issues that occurred during mass compile of screens.

	09/24/03 - Pete Chenard - 45497
		       Created screen template for compiler.
----------------------------------------------------------------------

 */

 #WARN SCOPE OFF
	type Public String %MODS,%PAGE,%PG,%REPEAT,ER,RM
	type String KEYS(),KVAR,VFSN(),VO,VODFT,VPGM,vPSL,VSID,VSNAME

	// %O (0-Create  1-Modify  2-Inquiry  3-Delete  4-Print  5-Blank screen)

	set:'%ProcessMode.exists() %ProcessMode=5
 if (%ProcessMode = 5) do {
  if 'fCUVAR.exists() set fCUVAR = Class.new("RecordCUVAR")
 }
 set KVAR="kill %TAB,VFSN,VO,VPTBL,vtab",VSID="CUVARGEN1",VPGM=$T(+0),VSNAME="General Information (Inst. Identity)"
 set VFSN("CUVAR")="zfCUVAR"
 set vPSL=1
 //
	// ==================== Display blank screen         (%O=5)

 if %ProcessMode=5 do VPR(.fCUVAR),VDA1(.fCUVAR),^DBSPNT() quit

 set ER=0 do VSCRPRE(.fCUVAR) if ER quit  // Screen Pre-Processor
 
 if '%ProcessMode do VNEW(.fCUVAR),VPR(.fCUVAR),VDA1(.fCUVAR)
 if %ProcessMode do VLOD(.fCUVAR) quit:$G(ER)  do VPR(.fCUVAR),VDA1(.fCUVAR)

	// ====================  Display Form
	do ^DBSPNT()
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=XECUTE
	if %ProcessMode=2!(%ProcessMode=3) do ^DBSCRT8A X:'$D(%PAGE) KVAR quit  // Inquiry/Delete
	// ====================  Set up data entry control table


 if %ProcessMode<2 do VTAB(.fCUVAR)
	quit


VNEW(RecordCUVAR fCUVAR) // Initialize arrays if %O=0
 
 do VDEF(.fCUVAR)
 do VLOD(.fCUVAR)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
	
VDEF(RecordCUVAR fCUVAR)
 if Db.isDefined("CUVAR","") S ER=1,RM=$$^MSG(2327) Q
 do fCUVAR.setAuditFlag(1)
 if fCUVAR.%ET="" set fCUVAR.%ET="ZE^UTLERR"
 if fCUVAR.%HELP="" set fCUVAR.%HELP=0
 if fCUVAR.%HELPCNT="" set fCUVAR.%HELPCNT=0
 if fCUVAR.ALCOUNT="" set fCUVAR.ALCOUNT=5
 if fCUVAR.BANNER="" set fCUVAR.BANNER=1
 if fCUVAR.BOBR="" set fCUVAR.BOBR=0
 if fCUVAR.DBSPH132="" set fCUVAR.DBSPH132="SCAU$HELP:OOE_SCA132.EXP"
 if fCUVAR.DBSPH80="" set fCUVAR.DBSPH80="SCAU$HELP:OOE_SCA80.EXP"
 if fCUVAR.EDITMASK="" set fCUVAR.EDITMASK="US"
 if fCUVAR.EMURND="" set fCUVAR.EMURND=9
 if fCUVAR.IRAHIST="" set fCUVAR.IRAHIST=365
 if fCUVAR.LNCC="" set fCUVAR.LNCC=0
 if fCUVAR.LNCFP="" set fCUVAR.LNCFP=0
 if fCUVAR.LNCPI="" set fCUVAR.LNCPI=0
 if fCUVAR.LNCPP="" set fCUVAR.LNCPP=0
 if fCUVAR.MAXCIFL="" set fCUVAR.MAXCIFL=12
 if fCUVAR.MINCIFL="" set fCUVAR.MINCIFL=1
 if fCUVAR.ODP="" set fCUVAR.ODP=0
 if fCUVAR.ORCIFN="" set fCUVAR.ORCIFN=1
 if fCUVAR.SFEEOPT="" set fCUVAR.SFEEOPT=0
 if fCUVAR.TAXREQ="" set fCUVAR.TAXREQ=1
 if fCUVAR.USERNAME="" set fCUVAR.USERNAME=0
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
 ;
VLOD(RecordCUVAR fCUVAR) // Load data from disc - %O = (1-5)
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


	type Public String %MODS,%REPEAT
	quit
	

VPR(RecordCUVAR fCUVAR) // Display screen prompts
 set VO="23||13|0"
 set VO(0)="|0"
 set VO(1)=$C(1,28,25,1,0,0,0,0,0,0)_"01T Institution Information "
 set VO(2)=$C(3,10,14,1,0,0,0,0,0,0)_"01T Company Name:"
 set VO(3)=$C(4,4,20,1,0,0,0,0,0,0)_"01T Company Short Name:"
 set VO(4)=$C(4,39,20,1,0,0,0,0,0,0)_"01T Employer ID Number:"
 set VO(5)=$C(5,1,23,0,0,0,0,0,0,0)_"01T Routing and Transit #:"
 set VO(6)=$C(5,47,12,0,0,0,0,0,0,0)_"01T ISO Number:"
 set VO(7)=$C(6,1,23,0,0,0,0,0,0,0)_"01TP.O. Mailer Info (IRS):"
 set VO(8)=$C(7,10,14,0,0,0,0,0,0,0)_"01TSWIFT Address:"
 set VO(9)=$C(7,47,12,0,0,0,0,0,0,0)_"01TMICR Number:"
 set VO(10)=$C(8,11,13,0,0,0,0,0,0,0)_"01TBSA Examiner:"
 set VO(11)=$C(8,51,8,0,0,0,0,0,0,0)_"01TBANK ID:"
 set VO(12)=$C(10,26,29,2,0,0,0,0,0,0)_"01TInstitution's Mailing Address"
 set VO(13)=$C(12,18,6,1,0,0,0,0,0,0)_"01T Name:"
 set VO(14)=$C(13,15,9,1,0,0,0,0,0,0)_"01T Address:"
 set VO(15)=$C(16,18,6,1,0,0,0,0,0,0)_"01T City:"
 set VO(16)=$C(16,50,9,1,0,0,0,0,0,0)_"01T Country:"
 set VO(17)=$C(17,8,16,0,0,0,0,0,0,0)_"01T State/Province:"
 set VO(18)=$C(17,42,17,0,0,0,0,0,0,0)_"01T ZIP/Postal Code:"
 set VO(19)=$C(18,7,17,0,0,0,0,0,0,0)_"01TTelephone Number:"
 set VO(20)=$C(19,7,17,0,0,0,0,0,0,0)_"01TCourtesy Message:"
 set VO(21)=$C(21,28,26,2,0,0,0,0,0,0)_"01TService Bureau Information"
 set VO(22)=$C(22,4,20,0,0,0,0,0,0,0)_"01T Distributor's Name:"
 set VO(23)=$C(23,1,23,1,0,0,0,0,0,0)_"01T Service Bureau Inst #:"
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VDA1(RecordCUVAR fCUVAR)  // Display screen data
 new V
 //
 set VO="45|24|13|0"
 set VO(24)=$C(3,25,40,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CONAM,1,40)
 set VO(25)=$C(4,25,12,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CO,1,12)
 set VO(26)=$C(4,60,20,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.EIN,1,20)
 set VO(27)=$C(5,25,9,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.RT,1,9)
 set VO(28)=$C(5,60,12,2,0,0,0,0,0,0)_"00N"_fCUVAR.ISO
 set VO(29)=$C(6,25,34,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.POINST,1,34)
 set VO(30)=$C(7,25,15,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.SWIFTADD,1,15)
 set VO(31)=$C(7,60,9,2,0,0,0,0,0,0)_"00N"_fCUVAR.MICR
 set VO(32)=$C(8,25,1,2,0,0,0,0,0,0)_"00N"_fCUVAR.BSA
 set VO(33)=$C(8,60,3,2,0,0,0,0,0,0)_"00N"_fCUVAR.BANKID
 set VO(34)=$C(12,25,40,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CNAME,1,40)
 set VO(35)=$C(13,25,40,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CAD1,1,40)
 set VO(36)=$C(14,25,40,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CAD2,1,40)
 set VO(37)=$C(15,25,40,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CAD3,1,40)
 set VO(38)=$C(16,25,20,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CCITY,1,20)
 set VO(39)=$C(16,60,2,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CCNTRY,1,2)
 set VO(40)=$C(17,25,2,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CSTATE,1,2)
 set VO(41)=$C(17,60,10,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.CZIP,1,10)
 set VO(42)=$C(18,25,15,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.TELEPHONE,1,15)
 set VO(43)=$C(19,25,50,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.COURTMSG,1,50)
 set VO(44)=$C(22,25,40,2,0,0,0,0,0,0)_"00T"_$E(fCUVAR.DISTNAM,1,40)
 set VO(45)=$C(23,25,3,2,0,0,0,0,0,0)_"00N"_fCUVAR.SBINSTNO
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
	
	
VTAB(RecordCUVAR fCUVAR)
 
 kill VSCRPP,REQ,%TAB,%MOD,%MODOFF,%MODGRP,%REPREQ,vtab
 set %MAX=22,VPT=1,VPB=23,PGM=$T(+0),DLIB="SYSDEV",DFID="CUVAR"
 set OLNTB=23025
 
 set VFSN("CUVAR")="zfCUVAR"
 //
 // 
	
	
 set %TAB(1)=$C(2,24,40)_"01T12401|1|[CUVAR]CONAM|||do VP1^V01S173(.fCUVAR)"
 set %TAB(2)=$C(3,24,12)_"01T12401|1|[CUVAR]CO"
 set %TAB(3)=$C(3,59,20)_"00T12401|1|[CUVAR]EIN|||do VP2^V01S173(.fCUVAR)"
 set %TAB(4)=$C(4,24,9)_"00T12401|1|[CUVAR]RT"
 set %TAB(5)=$C(4,59,12)_"00N12401|1|[CUVAR]ISO"
 set %TAB(6)=$C(5,24,34)_"00T12401|1|[CUVAR]POINST"
 set %TAB(7)=$C(6,24,15)_"00T12401|1|[CUVAR]SWIFTADD"
 set %TAB(8)=$C(6,59,9)_"00N12401|1|[CUVAR]MICR|||||||||20"
 set %TAB(9)=$C(7,24,1)_"00N12401|1|[CUVAR]BSA|[STBLBSA]"
 set %TAB(10)=$C(7,59,3)_"00N12418|1|[CUVAR]BANKID"
 set %TAB(11)=$C(11,24,40)_"01T12407|1|[CUVAR]CNAME"
 set %TAB(12)=$C(12,24,40)_"01T12404|1|[CUVAR]CAD1"
 set %TAB(13)=$C(13,24,40)_"00T12405|1|[CUVAR]CAD2"
 set %TAB(14)=$C(14,24,40)_"00T12406|1|[CUVAR]CAD3"
 set %TAB(15)=$C(15,24,20)_"01T12401|1|[CUVAR]CCITY|||||||||40"
 set %TAB(16)=$C(15,59,2)_"01T12408|1|[CUVAR]CCNTRY|[STBLCNTRY]||do VP3^V01S173(.fCUVAR)"
 set %TAB(17)=$C(16,24,2)_"00T12402|1|[CUVAR]CSTATE|[STBLCNTRY1]||do VP4^V01S173(.fCUVAR)"
 set %TAB(18)=$C(16,59,10)_"00T12403|1|[CUVAR]CZIP|||do VP5^V01S173(.fCUVAR)"
 set %TAB(19)=$C(17,24,15)_"00T12409|1|[CUVAR]TELEPHONE"
 set %TAB(20)=$C(18,24,50)_"00T12401|1|[CUVAR]COURTMSG"
 set %TAB(21)=$C(21,24,40)_"00T12402|1|[CUVAR]DISTNAM"
 set %TAB(22)=$C(22,24,3)_"01N12401|1|[CUVAR]SBINSTNO"
 do VTBL(.fCUVAR)
	do ^DBSCRT8 	// data entry
	quit


VREQ   // Create REQ() array
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VTBL(RecordCUVAR fCUVAR) //Create %TAB(array)
 	// 1 2 3  4 5   6   7-9 10-11
 	// DY,DX,SZ PT REQ TYPE DEL POS |NODE|ITEM NAME|TBL|FMT|PP|PRE|MIN|MAX|DEC

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


  //user-defined post procs
 //
VP1(RecordCUVAR fCUVAR) //
 if $F(X,"""")!$F(X,"|") set ER=1,RM=$$^MSG(517)    
 set X=$TR(X,"|","")
 quit 

VP2(RecordCUVAR fCUVAR) //
 do EXT1^VERTIN(X)
 quit 

VP3(RecordCUVAR fCUVAR) //
 set CNTRY=X
 quit 

VP4(RecordCUVAR fCUVAR) //
 new data
 set data=""
 if CNTRY="CA" set PROV=X
 type ResultSet rs=Db.select("STATE","STBLCNTRY1","CNTRY=:CNTRY") 
 if rs.next() set data=rs.getCol("STATE")
 if data="" quit
 if X="" set ER=1,RM=$$^MSG(2385)
 quit 

VP5(RecordCUVAR fCUVAR) //
 set ST=fCUVAR.cstate

 do VPO1(.fCUVAR)

 quit 

VPO1(RecordCUVAR fCUVAR)  // user library ZIP
 ; The code previously found in this routine has been moved to the new filer
 ; processer library.  This library contains code shared by the filers and by
 ; DQ screens. ; code removed 12/9/96 Spier
 ; Zip Code Verification
 ;
 D ZIP^PROCZIP($G(CNTRY),$G(ST),$G(X))
 Q
 #ACCEPT DATE=11/05/03;pgm=screen compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit								// User defined post processor's


VRV(V,L) quit V_$J("",L-$L(V))
VREPRNT
 type Public RecordCUVAR fCUVAR
 do VPR(.fCUVAR)
 do VDA1(.fCUVAR)
 do ^DBSPNT()
 quit

VW(RecordCUVAR fCUVAR)
 do VDA1(.fCUVAR)
 do ^DBSPNT(10)
 quit

VDAPNT(RecordCUVAR fCUVAR)
 do VDA1(.fCUVAR)
 do ^DBSPNT(0,2)
 quit

VDA
 type Public RecordCUVAR fCUVAR
 do VDA1(.fCUVAR)
 quit

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
 
vSET(sn,di,X)
 type Public RecordCUVAR fCUVAR
 if sn="CUVAR" do vSET1(.fCUVAR,di,X)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
vSET1(RecordCUVAR fCUVAR,di,X)
 do fCUVAR.setAuditFlag(1)
 set fCUVAR.@di=X
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
vREAD(fid,di)
 type Public RecordCUVAR fCUVAR
 if fid="CUVAR" quit $$vREAD1(.fCUVAR,di)
 quit ""
vREAD1(RecordCUVAR fCUVAR,di)
 quit fCUVAR.@di
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
 //
VSCRPRE(RecordCUVAR fCUVAR)  // Screen Pre-Processor
 new %TAB,vtab // Disable .MACRO. references to %TAB()
 //
 if fCUVAR.ccntry="CA" set PS=$$^MSG(6176),PZ=$$^MSG(6031) quit     
 set PS=$$^MSG(6037) 
 set PZ=$$^MSG(6038)        
 quit

 #ACCEPT date=11/05/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
