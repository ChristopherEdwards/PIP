LNSVF001		/*
	ORIG: RUSSELL - 04/12/2002
	DESC: IDSI-80 Security pricing fmt template

	---- Comments --------------------------------------------------------

	This procedure is never run independently.  It is used as a template
	by LNSVINI for the compilation of security pricing loading.

	See notes at top of procedure LNSVINI related to what this code
	should do.

	This is the formatter for IDSI-80.

	*/

RECCALL	// Verify CUSIP number
	set CUSIP=$E(REC,2,10)
	set Z=$$VCUSIP^SPSTD(.CUSIP) if ER set ER=0,TINV=TINV+1 quit

	if UPD,'Db.isDefined("UTBLSVAL","CUSIP=:CUSIP") set TSKIP=TSKIP+1 quit

	set TMP(CUSIP)=""

	// Extract needed information

	// Effective Date (date of evaluation)
	set %DS=$E(REC,65,68),DT=$$DAT^%ZM(%SystemDate,"MM/DD/YY")
	if $E(REC,69)=$E(DT,$L(DT)) set %DS=$E(%DS,1,4)_$E(DT,7,$L(DT))
	else  set %DS=$E(%DS,1,4)_($E(DT,7,$L(DT))-1)
	set EFD=$$^SCAJD(%DS)

	// Security Description - IDSI 80 character format has no description
	set DES=""	// SPSFILE will not update if null

	// Current Value per Unit
	if $E(REC,1)=5!($E(REC,1)=8) set VAL=$E(REC,74,76)_"."_$E(REC,77,80)
	else  set VAL=$E(REC,74,76)_"."_$E(REC,77,80)
	set VAL=$J(VAL,0,2)
	do SPSFILE

	quit


SPSFILE	// This label is required to avoid compile errors

vSIG()	quit "59886^43573^Sanchez SCM Administrator^1197"	// Signature - LTD^TIME^USER^SIZE
