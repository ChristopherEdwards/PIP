NOTINQ	
	/*
		ORIG:  GREENE -  1 FEB 1991
		Procedure ID: NOTINQ
		DESC: Function driving routine for note inquiry
		
	---- Revision History ------------------------------------------------
	  
	01/15/04 - RussellDS - CR 7514
	  	   Modified to eliminate use of tables NOTESACN and NOTESCIF
	  	   (obsoleted) and replace with table NOTES.
	  	   
	  	   Removed a large amount of code that is no longer used.

	12/17/03 - CARROLLJ - CR7239
		   Added #ACCEPT prior to xecute command.

	06/09/03 - Dan Russell - 51351
		   Removed use of schema class methods and replaced
		   references to temporary table TMPNOTES with TMPRPT4.
		   	
	02/14/02 - YENDAPALLIS - 43583
		   Converted the routine to PSL.
	
	08/15/01 - CAIN - 46763
		   Modified GETNOT section to clear array variable NUMTBL.
		   If previously entered account had more note selection
		   items, problem was some of them would be displayed.

	----------------------------------------------------------------------
	*/
	
	type String OPT(),%READ,RID,%TAB(),VFMQ

	//Account Notes Only
	set OPT("A")=$$^MSG("4332")
	
	// Customer Notes Only
	set OPT("C")=$$^MSG("4334")
	
	// Customer and Account Notes
	set OPT("R")=$$^MSG("4333")
	
	set %TAB("OPT")=".OPT8/TBL=OPT("
	set %READ="@@%FN,,,OPT/REQ"

	do ^UTLREAD if VFMQ="Q" quit 
	
	if OPT="C" set RID="SCA233CIF" do RPT^URID quit 
	if OPT="A" set RID="SCA233ACN" do RPT^URID quit 
	if OPT="R" set RID="SCA233" do RPT^URID quit 

	quit 

	
Public GETNOT	// Report query post-processor -- Get Notes for Account Or Customer 

	type Public String NUMTBL(),OPT
	
	type Number NOTNUM
	type String FILE
	
	if OPT="A" set FILE="ACN"
	if OPT="C" set FILE="CIF"

	kill NUMTBL
	
	type ResultSet rs=Db.select("NUM,DESC,LUPD,EXP,UID,NTYPE,NSTAT,RBDATE,RPERSON,ORIGIN,ODATE","NOTES","FILE=:FILE AND CID=:X")
	if rs.isEmpty() quit

	while rs.next() do {

		set NOTNUM=rs.getCol(1)		
		set NUMTBL(NOTNUM)=rs.getCol(2)_"|"_rs.getCol(3)_"|"_rs.getCol(4)_"|"_rs.getCol(5)_"|"_rs.getCol(6)_"|"_rs.getCol(7)_"|"_rs.getCol(8)_"|"_rs.getCol(9)_"|"_rs.getCol(10)_"|"_rs.getCol(11)
		}
	quit 		
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43593^Sanchez SCM Administrator^2002"	// Signature - LTD^TIME^USER^SIZE
