S0000160(sqlcur,vsql,sqldta,sqlind,sqlcnt)	; S0000160 ; 
	;;Copyright(c)2006 Sanchez Computer Associates, Inc.  All Rights Reserved - 10/09/2006 18:41 - kini
	; 
CID,EXPDT,ALCAMT,AMT FROM HLD8 WHERE ( HLD8.CID = :CID ) 
AND ( HLD8.AMT <>:C1 ) AND (HLD8.EXPDT >= :TJD)
	; 
	;
	D OPEN(.sqlcur,.vsql) I vsql(0)=100 S vsql=0 Q
	D FETCH(.sqlcur,.vsql,.sqldta,.sqlind) I vsql(0)=100 S vsql=0
	S sqlcnt=1 Q
	;
	;
0	S vsql(0)=100 Q
	;
1	S vsql(1)=$G(CID) I vsql(1)="" G 0
	S vsql(2)=$G(C1) I vsql(2)="",'$D(C1) G 0
	S vsql(2)=+vsql(2)
	S vsql(3)=$G(TJD) I vsql(3)="",'$D(TJD) G 0
	I vsql(3)'?.N S vsql(3)=$$FDAT^%ZM(vsql(3))
	S vsql(4)=vsql(3)
	I $D(^HLD(8,vsql(1),vsql(4))) G 1
8	S vsql(4)=$O(^HLD(8,vsql(1),vsql(4)),1) I vsql(4)="" G 0
	S vsql(5)=$G(^HLD(8,vsql(1),vsql(4)))
	I '(+$P(vsql(5),"|",1)'=+vsql(2)) G 8
	Q
	;
OPEN(sqlcur,vsql)	; Open Cursor
	S sqlcnt=0,sqlind=""
	;
	S vsql=1,vsql(0)=1,vsql("K")=5,vsql("D")=""
	S vsql("D")=vsql("D")_"N0D0$2$2" D 1
	Q
	;
FETCH(sqlcur,vsql,vd,vi)	; Fetch Row
	;
	I vsql(0)=100 S vsql=-1 Q
	;
	S vd=vsql(1)_$C(9)_vsql(4)_$C(9)_$P(vsql(5),"|",3)_$C(9)_$P(vsql(5),"|",1)
	;
	D 8
	Q
PREPARE()	; ODBC prepare information
	N v
	S v=$C(52,160,78,0,13,0,13,0,12,0,0)_"HLD8.CID"_$C(255)
	S v=v_$C(52,96,68,0,10,0,10,0,10,0,5)_"EXPDT"_$C(255)
	S v=v_$C(243,96,36,0,20,0,20,0,18,2,5)_"ALCAMT"_$C(255)
	S v=v_$C(243,96,36,0,14,0,14,0,12,2,6)_"MT"_$C(255)
	Q v
PREPARE3()	; PFW/PIA column format information
	Q "0D$$|HLD8.CID,HLD8.EXPDT"
