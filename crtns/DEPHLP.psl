DEPHLP	  /*
	ORIG: alagarss - 08/12/2005
	DESC: Column Help Documentation Utility

---- Comments --------------------------------------------------------

---- Revision History ------------------------------------------------
	   08/12/2005 - ALAGARSS - CR16677
	                Converted to PSL.
	                Also removed the revision history prior to 2005.
	   
----------------------------------------------------------------------
 */
 	
 	
 	
FID	// File ID
 	
 	type Boolean FINISH,FINISH1
 	type String DI,FID,LIB
 	type String FID
 	
 	set (FINISH,FINISH1)=0
 	
 	for  do { quit:FINISH
	 	write !!,"D/Q file name: "  read FID if FID="" set FINISH=1 quit
	 	
	 	set LIB="SYSDEV" 	
 		if 'Db.isDefined("DBTBL1","%LIBS=:LIB,1=:1,FID=:FID") write "  Invalid"  set FINISH=0 quit
 		for  do { quit:FINISH1
 			write !!,"    Data item: " read DI if DI="" set FINISH1=1 quit
 			do DSPDI
 			}
 		}	
 	quit
 	

DSPDI	//
 	type Public String FID,DI
 	type String LIB,DES,CMP,NOD,TYP,TBL,POS1
 	type Number LEN
	
 	
 	set LIB="SYSDEV"
 	 	
 	type ResultSet rs=Db.select("NOD,DES,POS,CMP,LEN,TYP,TBL","DBTBL1D","FID=:FID AND DI=:DI")
 	if rs.isEmpty() write ?20,"Invalid" quit
 	if rs.next() do {
 		set DES=rs.getCol("DES")
 		set NOD=rs.getCol("NOD")
 		set POS1=rs.getCol("POS")
 		set CMP=rs.getCol("CMP")
 		set LEN=rs.getCol("LEN")
 		set TYP=rs.getCol("TYP")
 		set TBL=rs.getCol("TBL")
 	}
 	
 	write !!?20,"Descr: ",DES
 	
 	if 'NOD.isNull() write !?20,"Field: ",NOD,!?20,"Piece: ",POS1
 	else  write !?20,"Cmptd: ",CMP
 	
 	write !?22,"Len: ",LEN,!?22,"Fmt: ",TYP
 	if TBL.length() write !?22,"Tbl: ",TBL
	quit
	
NOD //
	type Public String FID,DI,NOD
	type Public Number POS
	type Boolean FINISH2,FINISH3
	
	set (FINISH2,FINISH3)=0
	
	for  do { quit:FINISH2
 			
	 	write !!,"Field: "  read NOD if NOD="" set FINISH2=1 quit
 		for  do { quit:FINISH3

	 		write !,"  Pos: "  read POS if POS="" set FINISH3=1 quit
 
 			if FID.get()="" set FID="DEP" set DI=$$DILIST^DBSUTL8(FID,NOD,POS,"SYSDEV")
	 		if DI="" write ?23,"Invalid"  set FINISH3=0 quit 
		 	do DSPDI
 			} 
 		}
 	quit
 	
 		
SID	// 

 	type Boolean FINISH4
 	type String LIB,DESC,PFID,SID,OUTFMT,VPGM
 	 	
 	set FINISH4=0
 	for  do { quit:FINISH4
	 	set LIB="SYSDEV"
 		write !!,"Screen ID: "  read SID if SID="" set FINISH4=1 quit
		
	 	type ResultSet rs=Db.select("DESC,PFID,OUTFMT,VPGM","DBTBL2","SID=:SID")
 		if rs.isEmpty() write ?23,"Invalid"  set FINISH4=0 quit
	 	if rs.next() do {
 			set DESC=rs.getCol("DESC")
 			set PFID=rs.getCol("PFID")
	 		set OUTFMT=rs.getCol("OUTFMT")
 			set VPGM=rs.getCol("VPGM")
 			}
 		
	 	write !!?20,"   Desc: ",DESC,!?20,"File(s): ",PFID
 		write !?20,"Mode(s): ",OUTFMT,!?20,"  V Pgm: ",VPGM
 		}
  		quit
RID //

	type String LIB,PFID,PGM,DES
 	type Public String RID
 	type Boolean FINISH5
 	
 	set LIB="SYSDEV"
 	set FINISH5=0
 	
 	for  do {  quit:FINISH5
	 	set LIB="SYSDEV"
 	
 		write !!,"Report ID: "  read RID if RID="" set FINISH5=1 quit
 	
	 	type ResultSet rs=Db.select("DESC,PFID,PGM","DBTBL5H","RID=:RID")
 		if rs.next() do {
 			set PFID=rs.getCol("PFID")
	 		set PGM=rs.getCol("PGM")
	 		set DES=rs.getCol("DESC")
 			}
	 	if rs.isEmpty() write ?23,"Invalid"  set FINISH5=0 quit
	 	write !!?20,"   Desc: ",DES
 		write !?20,"File(s): ",PFID
	 	write !?20,"  R Pgm: ",PGM
 		}
 	quit	 
 	
 #OPTION ResultClass ON
Public String vSIG()	quit "60211^25627^Sanjay Chhrabria^3174"	// Signature - LTD^TIME^USER^SIZE
