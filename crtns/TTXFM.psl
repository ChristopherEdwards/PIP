public TTXFM(String TCMT, String TBL, String COL)

	/*
	
	Batch File Maintenance Posting Routine
	
	   ORIG:  David Caliendo (5527) - 06/28/88
	
	---- Revision History ------------------------------------------------
	  
	  05/131/05 - SmithCD - CR 15902
	  	     Labeled tags public that were called externally, and 
	  	     performed minor cleanup.
	  
	  07/14/03 - Erik Scheetz - 51349
		     PSL conversion clean up.

	  01/31/02 - SCOTTC - 43583
		     Convert to PSL.
	*/
	
	// Call to top returns the Table and Column being modified.
	
	//Invalid format
	if 'TCMT.isLike("%[%") do Runtime.setErrMSG("TTX",1350) quit
	
	set TBL=TCMT.piece("[",2)
	set TBL=TBL.piece("]",1)
	if TBL.isLike("%,%") set TBL=TBL.piece(",",2)
	
	set COL=TCMT.piece("]",2)
	set COL=COL.piece(":",1)
	
	type RecordDBTBL1D dbtbl1d=Db.getRecord("DBTBL1D","%LIBS=:%Library,FID=:TBL,DI=:COL",1)
	
	// Invalid data item
	if dbtbl1d.getMode()=0 do Runtime.setErrMSG("TTX",1298) quit
	
	// If date field, format to Julian Date
	if dbtbl1d.typ="D" do FMTDATE(.TCMT)
	
	quit


public	CIF(RecordCIF cif, String TCMT, String COL)

	// Update CIF with values with TCMT for column COL
	
	type String VAL=TCMT.piece(":",3)
	
	do cif.setAuditFlag(1)
	set cif.@COL=VAL
	do cif.save()

	quit


public	DEP(RecordDEP dep, String TCMT, String COL)

	// Update DEP with values with TCMT for column COL
	
	type String VAL=TCMT.piece(":",3)
	
	do dep.setAuditFlag(1)
	set dep.@COL=VAL
	do dep.save()

	quit


public	LN(RecordLN ln, String TCMT, String COL)

	// Update LN with values with TCMT for column COL
	
	type String VAL=TCMT.piece(":",3)
	
	do ln.setAuditFlag(1)
	set ln.@COL=VAL
	do ln.save()

	quit


FMTDATE(String TCMT)

	type Date DS

	// format old date value	
	set DS=TCMT.piece(":",2)
	if 'DS.isNull() set TCMT.piece(":",2)=$$^SCAJD(DS)

	// format new date value
	set DS=TCMT.piece(":",3)
	if 'DS.isNull() set TCMT.piece(":",3)=$$^SCAJD(DS)

	quit
 #OPTION ResultClass ON
Public String vSIG()	quit "60051^63734^Chad Smith^1779"	// Signature - LTD^TIME^USER^SIZE
