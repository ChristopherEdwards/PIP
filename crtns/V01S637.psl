V01S637(Number %ProcessMode,RecordUTBLCHKS UTBL)   //PBS -  - SID= <UTBLCHKS> Check Types
 ;;Copyright(c)2007 Sanchez Computer Associates, Inc.  All Rights Reserved - 08/30/2007 14:35 - joynerd
  /*
ORIG: CHENARDP - 03/03/2003
DESC: PSL Screen Compiler Template

---- Comments --------------------------------------------------------
	This procedure is used as the base template for the PSL screen compiler.
	It is referenced by the PSL screen compiler - procedure DBS2PSL4
	
	
---- Revision History ------------------------------------------------
	02/18/07 - Pete Chenard - CR23555
		   Corrected compiler warnings.
		   
	02/23/06 - Pete Chenard - CR19551
		   Fixed routine label.
		   
	05/19/05 - Pete Chenard - CR 14146
		   Modified to type variables.
		   
	12/1/03 - Spier -cr7178
	   	     Modifications to correct dead code warnings and
	   	     other issues that occurred during mass compile of screens.

	09/24/03 - Pete Chenard - 45497
		       Created screen template for compiler.
----------------------------------------------------------------------

 */

 #WARN SCOPE OFF
	type Public String %MODS,%PAGE,%PG,%REPEAT,ER,RM
	type String KEYS(),KVAR,VFSN(),VO,VODFT,VPGM,vPSL,VSID,VSNAME

	// %O (0-Create  1-Modify  2-Inquiry  3-Delete  4-Print  5-Blank screen)

	set:'%ProcessMode.exists() %ProcessMode=5
 if (%ProcessMode = 5) do {
  if 'UTBL.exists() set UTBL = Class.new("RecordUTBLCHKS")
 }
 set KVAR="kill %TAB,VFSN,VO,VPTBL,vtab",VSID="UTBLCHKS",VPGM=$T(+0),VSNAME="Check Types"
 set VFSN("UTBLCHKS")="zUTBL"
 set vPSL=1
 set KEYS(1)=UTBL.CHKS
 //
	// ==================== Display blank screen         (%O=5)

 if %ProcessMode=5 do VPR(.UTBL),VDA1(.UTBL),^DBSPNT() quit

 if '%ProcessMode do VNEW(.UTBL),VPR(.UTBL),VDA1(.UTBL)
 if %ProcessMode do VLOD(.UTBL) quit:$G(ER)  do VPR(.UTBL),VDA1(.UTBL)

	// ====================  Display Form
	do ^DBSPNT()
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=XECUTE
	if %ProcessMode=2!(%ProcessMode=3) do ^DBSCRT8A X:'$D(%PAGE) KVAR quit  // Inquiry/Delete
	// ====================  Set up data entry control table


 if %ProcessMode<2 do VTAB(.UTBL)
	quit


VNEW(RecordUTBLCHKS UTBL) // Initialize arrays if %O=0
 
 do VDEF(.UTBL)
 do VLOD(.UTBL)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
	
VDEF(RecordUTBLCHKS UTBL)
 quit:UTBL.CHKS.isNull() 
 quit:%ProcessMode  set ER=0 if (UTBL.CHKS="") set ER=1,RM=$$^MSG(1767,"CHKS") Q
 if Db.isDefined("UTBLCHKS","UTBLCHKS.CHKS=:UTBL.CHKS") S ER=1,RM=$$^MSG(2327) Q
 do UTBL.setAuditFlag(1)
 if UTBL.ACCNTNUM="" set UTBL.ACCNTNUM=0
 if UTBL.CHKCLS="" set UTBL.CHKCLS=0
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
 ;
VLOD(RecordUTBLCHKS UTBL) // Load data from disc - %O = (1-5)
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


	type Public String %MODS,%REPEAT
	quit
	

VPR(RecordUTBLCHKS UTBL) // Display screen prompts
 set VO="20||13|0"
 set VO(0)="9|0"
 set VO(1)=$C(9,22,35,1,0,0,0,0,0,0)_"01T Check Type User Table Maintenance "
 set VO(2)=$C(11,12,13,1,0,0,0,0,0,0)_"01T Description:"
 set VO(3)=$C(12,11,14,0,0,0,0,0,0,0)_"01TOffsite Print:"
 set VO(4)=$C(12,46,20,0,0,0,0,0,0,0)_"01TPermanent Hold Code:"
 set VO(5)=$C(13,6,19,1,0,0,0,0,0,0)_"01T Next Check Number:"
 set VO(6)=$C(13,39,27,0,0,0,0,0,0,0)_"01TCheck Number Format Option:"
 set VO(7)=$C(14,12,13,0,0,0,0,0,0,0)_"01T Check Class:"
 set VO(8)=$C(15,11,14,1,0,0,0,0,0,0)_"01T Check Format:"
 set VO(9)=$C(15,41,20,1,0,0,0,0,0,0)_"01T G/L Account Number:"
 set VO(10)=$C(16,5,20,1,0,0,0,0,0,0)_"01T Consolidate Checks:"
 set VO(11)=$C(17,48,13,1,0,0,0,0,0,0)_"01T Sort Option:"
 set VO(12)=$C(18,28,33,1,0,0,0,0,0,0)_"01T Print Option (0-Batch 1-Online):"
 set VO(13)=$C(19,2,24,0,0,0,0,0,0,0)_"01TDefault Comment (Batch):"
 set VO(14)=$C(20,8,11,2,0,0,0,0,0,0)_"01TCheck Type "
 set VO(15)=$C(20,21,4,0,0,0,0,0,0,0)_"01TA/P:"
 set VO(16)=$C(20,32,12,0,0,0,0,0,0,0)_"01TAnticipated:"
 set VO(17)=$C(20,47,22,0,0,0,0,0,0,0)_"01TRSP Acct Distribution:"
 set VO(18)=$C(21,7,18,1,0,0,0,0,0,0)_"01T Check Definition:"
 set VO(19)=$C(21,36,25,1,0,0,0,0,0,0)_"01T Check Number Definition:"
 set VO(20)=$C(22,3,22,0,0,0,0,0,0,0)_"01T DI for Customer Name:"
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VDA1(RecordUTBLCHKS UTBL)  // Display screen data
 new V
 //
 set VO="38|21|13|0"
 set VO(21)=$C(11,26,40,2,0,0,0,0,0,0)_"00T"_$E(UTBL.DESC,1,40)
 set VO(22)=$C(12,26,1,2,0,0,0,0,0,0)_"00L"_$S(UTBL.OFFSPNT:"Y",1:"N")
 set VO(23)=$C(12,67,2,2,0,0,0,0,0,0)_"00N"_UTBL.PHC
 set VO(24)=$C(13,26,12,2,0,0,0,0,0,0)_"00N"_UTBL.NCHKPNUM
 set VO(25)=$C(13,67,1,2,0,0,0,0,0,0)_"00N"_UTBL.ACCNTNUM
 set VO(26)=$C(14,26,1,2,0,0,0,0,0,0)_"00T"_$E(UTBL.CHKCLS,1,1)
 set VO(27)=$C(15,26,12,2,0,0,0,0,0,0)_"00T"_$E(UTBL.FORMAT,1,12)
 set VO(28)=$C(15,62,12,2,0,0,0,0,0,0)_"00N"_UTBL.CID
 set VO(29)=$C(16,26,1,2,0,0,0,0,0,0)_"00L"_$S(UTBL.CONCHK:"Y",1:"N")
 set VO(30)=$C(17,62,1,2,0,0,0,0,0,0)_"00N"_UTBL.SRTOPT
 set VO(31)=$C(18,62,1,2,0,0,0,0,0,0)_"00N"_UTBL.POPT
 set VO(32)=$C(19,26,40,2,0,0,0,0,0,0)_"00T"_$E(UTBL.COMM,1,40)
 set VO(33)=$C(20,26,1,2,0,0,0,0,0,0)_"00L"_$S(UTBL.AP:"Y",1:"N")
 set VO(34)=$C(20,45,1,2,0,0,0,0,0,0)_"00L"_$S(UTBL.AEC:"Y",1:"N")
 set VO(35)=$C(20,70,1,2,0,0,0,0,0,0)_"00L"_$S(UTBL.IRA:"Y",1:"N")
 set VO(36)=$C(21,26,6,2,0,0,0,0,0,0)_"00T"_$E(UTBL.DEFCHK,1,6)
 set VO(37)=$C(21,62,6,2,0,0,0,0,0,0)_"00T"_$E(UTBL.DEFNUM,1,6)
 set VO(38)=$C(22,26,40,2,0,0,0,0,0,0)_"00T"_$E(UTBL.DNAME,1,40)
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
	
	
VTAB(RecordUTBLCHKS UTBL)
 
 kill VSCRPP,REQ,%TAB,%MOD,%MODOFF,%MODGRP,%REPREQ,vtab
 set %MAX=18,VPT=9,VPB=22,PGM=$T(+0),DLIB="SYSDEV",DFID="UTBLCHKS"
 set OLNTB=22026
 
 set VFSN("UTBLCHKS")="zUTBL"
 //
 // 
	
	
 set %TAB(1)=$C(10,25,40)_"01T12401|1|[UTBLCHKS]DESC"
 set %TAB(2)=$C(11,25,1)_"00L12418|1|[UTBLCHKS]OFFSPNT"
 set %TAB(3)=$C(11,66,2)_"00N12421|1|[UTBLCHKS]PHC|[UTBLPHC]"
 set %TAB(4)=$C(12,25,12)_"00N12419|1|[UTBLCHKS]NCHKPNUM||||do VP1^V01S637(.UTBL)"
 set %TAB(5)=$C(12,66,1)_"00N12420|1|[UTBLCHKS]ACCNTNUM|[STBLCHKNUM]"
 set %TAB(6)=$C(13,25,1)_"00T12412|1|[UTBLCHKS]CHKCLS|[STBLCHKCLS]||do VP2^V01S637(.UTBL)"
 set %TAB(7)=$C(14,25,12)_"00T12403|1|[UTBLCHKS]FORMAT|[UTBLCHKFMT]|||do VP3^V01S637(.UTBL)"
 set %TAB(8)=$C(14,61,12)_"01N12405|1|[UTBLCHKS]CID|[GLAD]"
 set %TAB(9)=$C(15,25,1)_"00L12409|1|[UTBLCHKS]CONCHK"
 set %TAB(10)=$C(16,61,1)_"01N12410|1|[UTBLCHKS]SRTOPT|[STBLCHKSRT]"
 set %TAB(11)=$C(17,61,1)_"01N12411|1|[UTBLCHKS]POPT||||do VP4^V01S637(.UTBL)|0|1"
 set %TAB(12)=$C(18,25,40)_"00T12404|1|[UTBLCHKS]COMM"
 set %TAB(13)=$C(19,25,1)_"00L12406|1|[UTBLCHKS]AP|||do VP5^V01S637(.UTBL)"
 set %TAB(14)=$C(19,44,1)_"00L12407|1|[UTBLCHKS]AEC|||do VP6^V01S637(.UTBL)"
 set %TAB(15)=$C(19,69,1)_"00L12408|1|[UTBLCHKS]IRA|||do VP7^V01S637(.UTBL)"
 set %TAB(16)=$C(20,25,6)_"01T12413|1|[UTBLCHKS]DEFCHK|[UTBLCHKDEF1]|||do VP8^V01S637(.UTBL)"
 set %TAB(17)=$C(20,61,6)_"01T12414|1|[UTBLCHKS]DEFNUM|[UTBLCHKDEF1]|||do VP9^V01S637(.UTBL)"
 set %TAB(18)=$C(21,25,40)_"00T12415|1|[UTBLCHKS]DNAME||||do VP10^V01S637(.UTBL)"
 do VTBL(.UTBL)
	do ^DBSCRT8 	// data entry
	quit


VREQ   // Create REQ() array
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VTBL(RecordUTBLCHKS UTBL) //Create %TAB(array)
 	// 1 2 3  4 5   6   7-9 10-11
 	// DY,DX,SZ PT REQ TYPE DEL POS |NODE|ITEM NAME|TBL|FMT|PP|PRE|MIN|MAX|DEC

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


  //user-defined post procs
 //
VP1(RecordUTBLCHKS UTBL) //
	if (UTBL.OFFSPNT=0) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]NCHKPNUM","1","0")
		do PROTECT^DBSMACRO("[UTBLCHKS]NCHKPNUM")
		}

	if (UTBL.OFFSPNT=1) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]NCHKPNUM","1","0")
		do UNPROT^DBSMACRO("[UTBLCHKS]NCHKPNUM")
		do CHANGE^DBSMACRO("REQ","[UTBLCHKS]NCHKPNUM")
		}
	
	quit

VP2(RecordUTBLCHKS UTBL) //
	/*The check can be a Institution check (0) - Example to pay interest
	or a customer check (1)*/
	
	type public Number X

	if X=1 do {

		do DELETE^DBSMACRO("[UTBLCHKS]FORMAT","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]CID","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]CONCHK","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]SRTOPT","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]POPT","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]COMM","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]AP","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]AEC","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]IRA","1","0")
		do GOTO^DBSMACRO("[UTBLCHKS]DEFCHK")
		}

	else  do {

		do DELETE^DBSMACRO("[UTBLCHKS]DEFCHK","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]DEFNUM","1","0")
		do DELETE^DBSMACRO("[UTBLCHKS]DNAME","1","0")
		}

	quit

VP3(RecordUTBLCHKS UTBL) //
	if (UTBL.OFFSPNT=1) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]FORMAT","1","0")
		do PROTECT^DBSMACRO("[UTBLCHKS]FORMAT") 
		}
	if (UTBL.OFFSPNT=0) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]FORMAT","1","0")
		do UNPROT^DBSMACRO("[UTBLCHKS]FORMAT")
		do CHANGE^DBSMACRO("REQ","[UTBLCHKS]FORMAT")
		}

	quit

VP4(RecordUTBLCHKS UTBL) //
	if (UTBL.OFFSPNT=1) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]POPT","1","0")
		do DEFAULT^DBSMACRO("[UTBLCHKS]POPT",0)
		}
	if (UTBL.OFFSPNT=0) do DELETE^DBSMACRO("[UTBLCHKS]POPT","1","0")

	quit

VP5(RecordUTBLCHKS UTBL) //
	type public Boolean ER
	
	// Cannot use AP and AEC flag together
	if X,UTBL.AEC do Runtime.setErrMSG("UTBLCHKS",483) quit:ER

	// Cannot use AP and RPA flag together
	if X,UTBL.IRA do Runtime.setErrMSG("UTBLCHKS",484) quit:ER

	quit

VP6(RecordUTBLCHKS UTBL) //
	type public Boolean ER
	
	// Cannot use AP and AEC flag together
	if X,UTBL.AP do Runtime.setErrMSG("UTBLCHKS",484) quit:ER
	
	// Cannot use AEC and RPA flag together
	if X,UTBL.AEC do Runtime.setErrMSG("UTBLCHKS",482) quit:ER

	quit

VP7(RecordUTBLCHKS UTBL) //
	type public Boolean ER

	// Cannot use AP and RPA flag together
	if X,UTBL.AP do Runtime.setErrMSG("UTBLCHKS",484) quit:ER

	// Cannot use AEC and RPA flag together
	if X,UTBL.AEC do Runtime.setErrMSG("UTBLCHKS",482) quit:ER
	
	do GOTO^DBSMACRO("END")

	quit

VP8(RecordUTBLCHKS UTBL) //
	if (UTBL.OFFSPNT=1) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]DEFCHK","1","0")
		do PROTECT^DBSMACRO("[UTBLCHKS]DEFCHK") 
		}
	if (UTBL.OFFSPNT=0) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]DEFCHK","1","0")
		do UNPROT^DBSMACRO("[UTBLCHKS]DEFCHK")
		do CHANGE^DBSMACRO("REQ","[UTBLCHKS]DEFCHK") 
		}
		
	quit




		
 
VP9(RecordUTBLCHKS UTBL) //
	if (UTBL.OFFSPNT=1) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]DEFNUM","1","0")
		do PROTECT^DBSMACRO("[UTBLCHKS]DEFNUM") 
		}	

	if (UTBL.OFFSPNT=0) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]DEFNUM","1","0")
		do UNPROT^DBSMACRO("[UTBLCHKS]DEFNUM")
		do CHANGE^DBSMACRO("REQ","[UTBLCHKS]DEFNUM")
		}
	
	quit

VP10(RecordUTBLCHKS UTBL) //
	if (UTBL.OFFSPNT=1) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]DNAME","1","0")
		do PROTECT^DBSMACRO("[UTBLCHKS]DNAME") 
		}		   		

	if (UTBL.OFFSPNT=0) do {  quit
		do DELETE^DBSMACRO("[UTBLCHKS]DNAME","1","0")
		do UNPROT^DBSMACRO("[UTBLCHKS]DNAME")
		do CHANGE^DBSMACRO("REQ","[UTBLCHKS]DNAME") 
		}		
 
	quit

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit								// User defined post processor's


VRV(V,L) quit V_$J("",L-$L(V))
VREPRNT
 type Public RecordUTBLCHKS UTBL
 do VPR(.UTBL)
 do VDA1(.UTBL)
 do ^DBSPNT()
 quit

VW(RecordUTBLCHKS UTBL)
 do VDA1(.UTBL)
 do ^DBSPNT(10)
 quit

VDAPNT(RecordUTBLCHKS UTBL)
 do VDA1(.UTBL)
 do ^DBSPNT(0,2)
 quit

VDA
 type Public RecordUTBLCHKS UTBL
 do VDA1(.UTBL)
 quit

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
 
vSET(sn,di,X)
 type Public RecordUTBLCHKS UTBL
 if sn="UTBLCHKS" do vSET1(.UTBL,di,X)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
vSET1(RecordUTBLCHKS UTBL,di,X)
 do UTBL.setAuditFlag(1)
 set UTBL.@di=X
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
vREAD(fid,di)
 type Public RecordUTBLCHKS UTBL
 if fid="UTBLCHKS" quit $$vREAD1(.UTBL,di)
 quit ""
vREAD1(RecordUTBLCHKS UTBL,di)
 quit UTBL.@di
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
