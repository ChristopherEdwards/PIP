UPDSTAT(RecordDEP dep,RecordTRN trn)	// Update account status to Active
	/*
	    ORIG:  WAT - 18 JUN 1992
	    DESC:  Update the account status from inactive or dormant to 
		   active (log file maintenance entry)
	
	---- Revision History ------------------------------------------------

	06/13/02 - ZWITKOWITSM - 43583
		   Converted to PSL.

	11/29/01 - MBUIM - 48512
		   When an account status is changed from inactive or dormant
		   to active the TSO field is populated with HSEQ (e.g. 29)
		   in an incorrect format in SET^CRTFM. This then causes
		   incorrect TSO in ^MRPC004.
		   HSEQ was modified to get the correct format (i.e. HSEQ#29).

	--------------------------------------------------------------------
	*/

	// Update Last Customer Contact Date flag
	if 'trn.pcfd2 quit	

	if (dep.stat=1)!(dep.stat=2) do {

		new CID,OV,HSEQ

		set CID=dep.cid
		set OV=dep.stat
		set HSEQ=Db.nextVal("HIST","CID")

		set dep.stat=0

		type RecordHIST hist=Class.new("RecordHIST")

		set hist.cid=CID
		set hist.tseq=HSEQ
		set hist.tjd=%SystemDate
		set hist.efd=%EffectiveDate
		set hist.tlo=%UserStation
		set hist.tso=$$FIELDIN^UTSO(,"HSEQ",HSEQ)
		set hist.tcmt=CID_"[DEP]STAT:"_OV_":0"
		set hist.cdt=%CurrentDate
		set hist.time=%CurrentTime
		set hist.uid=%UserID
		set hist.spr=$G(SPR)

		do hist.save()
		}

	quit
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43627^Sanchez SCM Administrator^1207"	// Signature - LTD^TIME^USER^SIZE
