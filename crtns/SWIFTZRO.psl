SWIFTZRO	//

	/*
	   ORIG: TSAIT - 08/31/94
	   DESC: Set up the data under the low level of SWIFTQ global.
	       There are three data at the first level of SWIFTQ global, first
	       piece store the last sequence number in queue, second piece store
	       the total number of record in the queue and the third piece
	       represent how many records have been created into the queue.
	       This routine is to set the second and third piece for each queue
	       type.

	   KEYWORDS:

	   INPUTS:
	       . Data		SWQCNT,SWQCNTD,SWIFTQ1,SWIFTQ2

	   RETURNS: None

	   EXAMPLE:
	       D SWIFTZRO

	  ---- Revision History -------------------------------------------------

           07/26/05 - SkariahV- CR16679
	              Removed #WARN and #OPTIMIZE directives.
	              
	  06/12/03 - BHANGALEV - 51351
		     Converted to PSL 

	  -----------------------------------------------------------------------
	*/

	//Ready to transmit queue
	type RecordSWQCNTD fSWQCNTD=Db.getRecord("SWQCNTD","QUE='RTT',DT=:%SystemDate",1)

	//piece 2 - total entries in queue
	set fSWQCNTD.tot=$$QUEUE1("RTT")
	set fSWQCNTD.ptoday=fSWQCNTD.tot
	
	do fSWQCNTD.bypassSave()

	// Received queue
	type RecordSWQCNTD fSWQCN1=Db.getRecord("SWQCNTD","QUE='REC',DT=:%SystemDate",1)
	set fSWQCN1.tot=$$QUEUE1("REC")
	set fSWQCN1.ptoday=fSWQCN1.tot
	
	do fSWQCN1.bypassSave()

	//Process queue
	type RecordSWQCNT fSWQCNT=Db.getRecord("SWQCNT","QUE='PRC'",1)
	set fSWQCNT.tot=$$QUEUE2("PRC")
	set fSWQCNT.ptoday=fSWQCNT.tot
	
	do fSWQCNT.bypassSave()
	
	//Pending queue
	type RecordSWQCNT fSWQCNT2=Db.getRecord("SWQCNT","QUE='PND'",1)
	set fSWQCNT2.tot=$$QUEUE2("PND")
	set fSWQCNT2.ptoday=0

	do fSWQCNT2.bypassSave()

	//Repair queue
	type RecordSWQCNT fSWQCNT3=Db.getRecord("SWQCNT","QUE='REP'",1)
	set fSWQCNT3.tot=$$QUEUE2("REP")
	set fSWQCNT3.ptoday=0
	
	do fSWQCNT3.bypassSave()

	//Completed queue
	type RecordSWQCNTD fSWQCNTD=Db.getRecord("SWQCNTD","QUE='CMP',DT=:%SystemDate",1)
	set fSWQCNTD.tot=$$QUEUE1("CMP")
	set fSWQCNTD.ptoday=0

	do fSWQCNTD.bypassSave()

	quit


QUEUE1(String qtype)	//Count how many entries in the queue (with a date as a key).
	
	/*
	  ARGUMENTS:
	  	qtype		SWIFT Queue Name	/REQ/NONULL/MECH=VAL
	
	  RETURNS:
	  	. $$	The total entries in queue
	*/
	type Number I=0
	type ResultSet rs=Db.select("SEQ","SWIFTQ1","QUE=:qtype AND DT=:%SystemDate")
	while rs.next() set I=I+1
	
	quit (I)


QUEUE2(String qtype)	//Count how many entries in the queue (without date).

        /*
	  ARGUMENTS:
	  	qtype		SWIFT Queue Name	/REQ/NONULL/MECH=VAL
	
	  RETURNS:
	  	. $$	The total entries in queue
	*/
        type Number I=0
	type ResultSet rs=Db.select("SEQ","SWIFTQ2","QUE=:qtype")
	while rs.next() set I=I+1
	
	quit (I)
 #OPTION ResultClass ON
Public String vSIG()	quit "60107^27463^Viji Skariah^2621"	// Signature - LTD^TIME^USER^SIZE
