DEPSTS	 /* 
    ORIG: GRAY - 01/14/2000
    DESC: Deposit Inquiry and File Maintenence
   
    ---- Comments --------------------------------------------------------
  
    ---- Revision History ------------------------------------------------
 
	08/10/05 - NATRAJAH - 16674
		   Intialized the unscoped variables for DBI3 conversion.
		   Section INIT has been modified to avoid goto statement and
		   section VPG and VPG0 has been removed.

	05/06/03 - CARROLLJ - 51349
		   Removed the use of to array.

	12/08/99 - GRAY - 32507
	 	   Removed code no longer needed due to the Elimination of
		   Teller/Branch Character Interface and placed remaining code
		   into PSL'd procedure definition.  Only INQ^DEPSTS is
		   still being called by the Returned Item process.  Modified
		   to use screen DEP001 since screen names have been obsoleted
		   from the product type table.
	
 */
	
	quit
	
	
Public INQ	//
	type Public String EFDF
	set %ProcessMode=2,EFDF=""
	
INIT	//
	type Public Number %PAGE,%PG
	type Public Boolean ER
	type Public String VFMQ
	set %PG=0,%PAGE=1
        do VPG00 if "DFQ"[VFMQ.get()!ER.get() do VER quit
        set %PG=%PG+1
        do VPG01
        do VER
	quit
VPG00	// Set up
	type Public String CLS,OLNTB,VFMQ,ZCLS,%NOPRMT,%READ,%TAB()
	type Public Boolean ER
	set (CLS,ZCLS)="D"
	kill OLNTB
	
	set %TAB("CID")=".CID1/XPP=S %EXT=1 do ^UACN"
	set %TAB("IO")=$$IO^SCATAB($I)
	
	set %READ="@@%FN,,,CID/REQ,IO/REQ",%NOPRMT="N"
	do ^UTLREAD if VFMQ="Q" set ER=1 quit
	quit
	
VPG01	// Page 1 - Data entry
	
	new dep
	type Public Number ACN,CID,TYPE
	type Public Boolean ER
	type Public String CRCD,ET,GRP,IO,PGM,SID,VFMQ
	type RecordDEP dep=Db.getRecord("DEP","CID")

	set ACN=dep.acn
	set TYPE=dep.type
	set GRP=dep.grp
	set CRCD=dep.crcd
	
	set SID="DEP001"
	do ^USID if PGM="" set ET="INVLDSCR" do ERR quit
	
	if IO'=$I do OPEN^SCAIO if ER set VFMQ="Q" quit
	do ^@PGM
	quit
	
ERR	//
	type Public Boolean ER
	type Public String VFMQ
	set ER=1 do ^UTLERR
	set VFMQ="Q"
	quit
	
VER	//
 	type Public Boolean ER
	type Public String VFMQ	
	if %ProcessMode=2!(%ProcessMode=4)!(VFMQ="Q")!(ER.get()) do END
	quit
	
END	//
	quit

vSIG()	quit "60123^40533^Hari Natrajan^2047"	// Signature - LTD^TIME^USER^SIZE
