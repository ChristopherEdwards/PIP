LNFIL3 // LN DATA-QWIK filer, part (5)
 // Copyright(c)2007 Sanchez Computer Associates, Inc.  All Rights Reserved - 05/09/2007 16:36 - joynerd

	quit		// Not called from top


public VINDEX(RecordLN ln) // Update index entries

		type Public String vx()

	if %ProcessMode=1 do { quit
		type String vf,vi,viMap,vxn
		set viMap=",CONVACN,~1~|,ANOFFDT,~2~|,BNDT,~3~|,CNVDT,~4~|,COLEXTRDYS,~5~|,ICHND,~6~|,INDEX,~7~|,INTOFFDT,~8~|,CCL,~9~|,CCL,TRACN,~10~|,LNFEETA,~11~|,CVCID,~12~|,INTMAT,~13~|,MDT,~14~|,PAYLKTO,~15~|,PCHND,~16~|,PCOFFDT,~17~|,RANDOFF,~18~|,RDT,~19~|,SCHND,~20~|,SDTA,~21~|,SRCDT,~22~|,SUBPLN,~23~|,WDND,~24~|,CLS,ACN,~25~|,BOO,~26~|,CC,CLS,GRP,TYPE,~27~|,CLS,GRP,TYPE,~28~|,CLS,~29~|,CLS,GRP,TYPE,CRCD,~30~|,CLS,"
		set viMap=viMap_"BOO,PROVCAT,TYPE,~31~|"
		set vf=0
		set vxn=""
		for  set vxn=vx(vxn).order() quit:vxn=""  do {
			for  set vf=$F(viMap,(","_vxn_","),vf) quit:vf=0  do {
				set vi=viMap.extract(vf,999).piece("~",2)
				set viMap.piece("|",vi)=""
				do @("vi"_vi_"(.ln)")
			}
		}
	}
	do vi1(.ln)
	do vi2(.ln)
	do vi3(.ln)
	do vi4(.ln)
	do vi5(.ln)
	do vi6(.ln)
	do vi7(.ln)
	do vi8(.ln)
	do vi9(.ln)
	do vi10(.ln)
	do vi11(.ln)
	do vi12(.ln)
	do vi13(.ln)
	do vi14(.ln)
	do vi15(.ln)
	do vi16(.ln)
	do vi17(.ln)
	do vi18(.ln)
	do vi19(.ln)
	do vi20(.ln)
	do vi21(.ln)
	do vi22(.ln)
	do vi23(.ln)
	do vi24(.ln)
	do vi25(.ln)
	do vi26(.ln)
	do vi27(.ln)
	do vi28(.ln)
	do vi29(.ln)
	do vi30(.ln)
	do vi31(.ln)

	quit
	

vi1(RecordLN ln) // Maintain ACONVACN index entries (Converted Account/Account)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.convacn
	type String v2 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if v1'="" if '$D(^XCONVACN(v1,v2)) do vidxerr("ACONVACN")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if v1'="" if %ProcessMode<2 set ^XCONVACN(v1,v2)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CONVACN").exists() set v1=vx("CONVACN").piece("|",1)
	if v1.isNull() quit

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XCONVACN(v1,v2)
	quit

vi2(RecordLN ln) // Maintain ANOFF index entries (Payment Change Analysis Date )

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.anoffdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"ANOFF",v3)) do vidxerr("ANOFF")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"ANOFF",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("ANOFFDT").exists() set v1=vx("ANOFFDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"ANOFF",v3)
	quit

vi3(RecordLN ln) // Maintain BNDT index entries (Billing - Next Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.bndt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"BNDT",v3)) do vidxerr("BNDT")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"BNDT",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("BNDT").exists() set v1=vx("BNDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"BNDT",v3)
	quit

vi4(RecordLN ln) // Maintain CNVDT index entries (Conversion Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.cnvdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"LNRNW",v3)) do vidxerr("CNVDT")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"LNRNW",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CNVDT").exists() set v1=vx("CNVDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"LNRNW",v3)
	quit

vi5(RecordLN ln) // Maintain COLEXTRDYS index entries (Collection Extract Days)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.colextrdys
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("COLEXTRDYS",v2,v3)) do vidxerr("COLEXTRDYS")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("COLEXTRDYS",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("COLEXTRDYS").exists() set v2=vx("COLEXTRDYS").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("COLEXTRDYS",v2,v3)
	quit

vi6(RecordLN ln) // Maintain ICHND index entries (Loan Int Change Next Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.ichnd
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"ICHND",v3)) do vidxerr("ICHND")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"ICHND",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("ICHND").exists() set v1=vx("ICHND").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"ICHND",v3)
	quit

vi7(RecordLN ln) // Maintain INTINDEX index entries (Interest Index)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.index
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("INDEX",v2,v3)) do vidxerr("INTINDEX")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("INDEX",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("INDEX").exists() set v2=vx("INDEX").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("INDEX",v2,v3)
	quit

vi8(RecordLN ln) // Maintain INTOFF index entries (Interest Review Offset Days)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.intoffdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"INTOFF",v3)) do vidxerr("INTOFF")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"INTOFF",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("INTOFFDT").exists() set v1=vx("INTOFFDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"INTOFF",v3)
	quit

vi9(RecordLN ln) // Maintain LCOM index entries (Commitment Cross-reference)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.ccl
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("LCOM",v2,v3)) do vidxerr("LCOM")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("LCOM",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CCL").exists() set v2=vx("CCL").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("LCOM",v2,v3)
	quit

vi10(RecordLN ln) // Maintain LCOMACN index entries (Loan Commitment Bullet XREF)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.ccl
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.tracn
	if v3.isNull() set v3=(PSL.maxCharValue-1).char()
	type String v4 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("LNKCOM",v2,v3,v4)) do vidxerr("LCOMACN")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("LNKCOM",v2,v3,v4)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CCL").exists() set v2=vx("CCL").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()
	if vx("TRACN").exists() set v3=vx("TRACN").piece("|",1) set:v3.isNull() v3=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("LNKCOM",v2,v3,v4)
	quit

vi11(RecordLN ln) // Maintain LNFEETA index entries (Fee Target Account)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.lnfeeta
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("LNFEETA",v2,v3)) do vidxerr("LNFEETA")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("LNFEETA",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("LNFEETA").exists() set v2=vx("LNFEETA").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("LNFEETA",v2,v3)
	quit

vi12(RecordLN ln) // Maintain LNSUB index entries (Loan Sub-Account)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.cvcid
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("LNSUB",v2,v3)) do vidxerr("LNSUB")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("LNSUB",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CVCID").exists() set v2=vx("CVCID").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("LNSUB",v2,v3)
	quit

vi13(RecordLN ln) // Maintain MATRIX index entries (Interest Matrix Processing)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.intmat
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("MATATT",v2,v3)) do vidxerr("MATRIX")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("MATATT",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("INTMAT").exists() set v2=vx("INTMAT").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("MATATT",v2,v3)
	quit

vi14(RecordLN ln) // Maintain MDT index entries (Account Maturity Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.mdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"MDT",v3)) do vidxerr("MDT")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"MDT",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("MDT").exists() set v1=vx("MDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"MDT",v3)
	quit

vi15(RecordLN ln) // Maintain PAYLKTO index entries (Payoff - Lockout to Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.paylkto
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"POLO",v3)) do vidxerr("PAYLKTO")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"POLO",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("PAYLKTO").exists() set v1=vx("PAYLKTO").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"POLO",v3)
	quit

vi16(RecordLN ln) // Maintain PCHND index entries (P&I Payment Change Next Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.pchnd
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"PCHND",v3)) do vidxerr("PCHND")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"PCHND",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("PCHND").exists() set v1=vx("PCHND").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if (%ProcessMode=3)!(v1>%SystemDate)  kill ^DAYEND(v1,"PCHND",v3) // Save old index entry
	quit

vi17(RecordLN ln) // Maintain PCOFF index entries (P&I Payment Change Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.pcoffdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"PCOFF",v3)) do vidxerr("PCOFF")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"PCOFF",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("PCOFFDT").exists() set v1=vx("PCOFFDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if (%ProcessMode=3)!(v1>%SystemDate)  kill ^DAYEND(v1,"PCOFF",v3) // Save old index entry
	quit

vi18(RecordLN ln) // Maintain RANDOFF index entries (Reamortization Offset)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.randoff
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"RAOFF",v3)) do vidxerr("RANDOFF")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"RAOFF",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("RANDOFF").exists() set v1=vx("RANDOFF").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if (%ProcessMode=3)!(v1>%SystemDate)  kill ^DAYEND(v1,"RAOFF",v3) // Save old index entry
	quit

vi19(RecordLN ln) // Maintain RDT index entries (Return Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.rdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"RETURN",v3)) do vidxerr("RDT")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"RETURN",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("RDT").exists() set v1=vx("RDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"RETURN",v3)
	quit

vi20(RecordLN ln) // Maintain SCHND index entries (Scheduled Payment - Next Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.schnd
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"SCH",v3)) do vidxerr("SCHND")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"SCH",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("SCHND").exists() set v1=vx("SCHND").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"SCH",v3)
	quit

vi21(RecordLN ln) // Maintain SDTA index entries (Scheduled Disbursement Target)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.sdta
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("SDTA",v2,v3)) do vidxerr("SDTA")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("SDTA",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("SDTA").exists() set v2=vx("SDTA").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("SDTA",v2,v3)
	quit

vi22(RecordLN ln) // Maintain SRCDT index entries (Strike Rate Compare Date)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.srcdt
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"SRCDT",v3)) do vidxerr("SRCDT")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"SRCDT",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("SRCDT").exists() set v1=vx("SRCDT").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"SRCDT",v3)
	quit

vi23(RecordLN ln) // Maintain SUBPLN index entries (Subsidy Plan)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.subpln
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("SUBPLN",v2,v3)) do vidxerr("SUBPLN")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("SUBPLN",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("SUBPLN").exists() set v2=vx("SUBPLN").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("SUBPLN",v2,v3)
	quit

vi24(RecordLN ln) // Maintain WDND index entries (Loan Withdrawal Limit Next Da)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.wdnd
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^DAYEND(v1,"LNWDL",v3)) do vidxerr("WDND")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^DAYEND(v1,"LNWDL",v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("WDND").exists() set v1=vx("WDND").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^DAYEND(v1,"LNWDL",v3)
	quit

vi25(RecordLN ln) // Maintain XACN index entries (Primary CIF/Account Index)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.cls
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v2 = ln.acn
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XACN(v1,v2,v3)) do vidxerr("XACN")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XACN(v1,v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CLS").exists() set v1=vx("CLS").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()
	if vx("ACN").exists() set v2=vx("ACN").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XACN(v1,v2,v3)
	quit

vi26(RecordLN ln) // Maintain XBRCD index entries (Branch of Ownership/Account)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = +ln.boo
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("XBRCD",v2,v3)) do vidxerr("XBRCD")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("XBRCD",v2,v3)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("BOO").exists() set v2=vx("BOO").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("XBRCD",v2,v3)
	quit

vi27(RecordLN ln) // Maintain XCC index entries (Cost Center Cross-Reference)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.cc
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v2 = ln.cls
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.grp
	if v3.isNull() set v3=(PSL.maxCharValue-1).char()
	type String v4 = ln.type
	if v4.isNull() set v4=(PSL.maxCharValue-1).char()
	type String v5 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XCC(v1,v2,v3,v4,v5)) do vidxerr("XCC")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XCC(v1,v2,v3,v4,v5)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CC").exists() set v1=vx("CC").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()
	if vx("CLS").exists() set v2=vx("CLS").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()
	if vx("GRP").exists() set v3=vx("GRP").piece("|",1) set:v3.isNull() v3=(PSL.maxCharValue-1).char()
	if vx("TYPE").exists() set v4=vx("TYPE").piece("|",1) set:v4.isNull() v4=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XCC(v1,v2,v3,v4,v5)
	quit

vi28(RecordLN ln) // Maintain XCLS index entries (Class/Group/Type)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.cls
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v2 = ln.grp
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.type
	if v3.isNull() set v3=(PSL.maxCharValue-1).char()
	type String v4 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XCLS(v1,v2,v3,v4)) do vidxerr("XCLS")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XCLS(v1,v2,v3,v4)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CLS").exists() set v1=vx("CLS").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()
	if vx("GRP").exists() set v2=vx("GRP").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()
	if vx("TYPE").exists() set v3=vx("TYPE").piece("|",1) set:v3.isNull() v3=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XCLS(v1,v2,v3,v4)
	quit

vi29(RecordLN ln) // Maintain XCLSACN index entries (Class/Account)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.cls
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v2 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XCLSACN(v1,v2)) do vidxerr("XCLSACN")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XCLSACN(v1,v2)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CLS").exists() set v1=vx("CLS").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XCLSACN(v1,v2)
	quit

vi30(RecordLN ln) // Maintain XCRCD index entries (Currency Code)

	type Public String vx()
	type Boolean vdelete = 0
	type String v1 = ln.cls
	if v1.isNull() set v1=(PSL.maxCharValue-1).char()
	type String v2 = ln.grp
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = ln.type
	if v3.isNull() set v3=(PSL.maxCharValue-1).char()
	type String v4 = ln.crcd
	if v4.isNull() set v4=(PSL.maxCharValue-1).char()
	type String v5 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XCRCD(v1,v2,v3,v4,v5)) do vidxerr("XCRCD")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XCRCD(v1,v2,v3,v4,v5)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CLS").exists() set v1=vx("CLS").piece("|",1) set:v1.isNull() v1=(PSL.maxCharValue-1).char()
	if vx("GRP").exists() set v2=vx("GRP").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()
	if vx("TYPE").exists() set v3=vx("TYPE").piece("|",1) set:v3.isNull() v3=(PSL.maxCharValue-1).char()
	if vx("CRCD").exists() set v4=vx("CRCD").piece("|",1) set:v4.isNull() v4=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XCRCD(v1,v2,v3,v4,v5)
	quit

vi31(RecordLN ln) // Maintain XREFXLNR index entries (Provision Accounts)

	type Public String vx()
	type Boolean vdelete = 0
	type String v2 = ln.cls
	if v2.isNull() set v2=(PSL.maxCharValue-1).char()
	type String v3 = +ln.boo
	if v3.isNull() set v3=(PSL.maxCharValue-1).char()
	type String v4 = ln.provcat
	if v4.isNull() set v4=(PSL.maxCharValue-1).char()
	type String v5 = ln.type
	if v5.isNull() set v5=(PSL.maxCharValue-1).char()
	type String v6 = ln.cid

	if %ProcessMode=2 do { quit

		// Allow global reference
		#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
		if '$D(^XREF("PROVPOST",v2,v3,v4,v5,v6)) do vidxerr("XREFXLNR")
		}


	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	if %ProcessMode<2 set ^XREF("PROVPOST",v2,v3,v4,v5,v6)="" 
	quit:%ProcessMode=0

	if %ProcessMode=3 set vdelete=1
	if vx("CLS").exists() set v2=vx("CLS").piece("|",1) set:v2.isNull() v2=(PSL.maxCharValue-1).char()
	if vx("BOO").exists() set v3=vx("BOO").piece("|",1) set:v3.isNull() v3=(PSL.maxCharValue-1).char()
	if vx("PROVCAT").exists() set v4=vx("PROVCAT").piece("|",1) set:v4.isNull() v4=(PSL.maxCharValue-1).char()
	if vx("TYPE").exists() set v5=vx("TYPE").piece("|",1) set:v5.isNull() v5=(PSL.maxCharValue-1).char()

	// Allow global reference
	#ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602
	kill ^XREF("PROVPOST",v2,v3,v4,v5,v6)
	quit

public VIDXBLD(List vlist) // Rebuild index files (External call)


	type Number %ProcessMode=0                             // Create mode
	type Number i

	if vlist.get().isNull() set vlist="VINDEX"             // Build all

	type DbSet ds=Db.selectDbSet("LN")

	while ds.next() do {
		type RecordLN ln=ds.getRecord("LN")
		if vlist.contains("VINDEX") do VINDEX(.ln) quit
		if vlist.contains("ACONVACN") do vi1(.ln)
		if vlist.contains("ANOFF") do vi2(.ln)
		if vlist.contains("BNDT") do vi3(.ln)
		if vlist.contains("CNVDT") do vi4(.ln)
		if vlist.contains("COLEXTRDYS") do vi5(.ln)
		if vlist.contains("ICHND") do vi6(.ln)
		if vlist.contains("INTINDEX") do vi7(.ln)
		if vlist.contains("INTOFF") do vi8(.ln)
		if vlist.contains("LCOM") do vi9(.ln)
		if vlist.contains("LCOMACN") do vi10(.ln)
		if vlist.contains("LNFEETA") do vi11(.ln)
		if vlist.contains("LNSUB") do vi12(.ln)
		if vlist.contains("MATRIX") do vi13(.ln)
		if vlist.contains("MDT") do vi14(.ln)
		if vlist.contains("PAYLKTO") do vi15(.ln)
		if vlist.contains("PCHND") do vi16(.ln)
		if vlist.contains("PCOFF") do vi17(.ln)
		if vlist.contains("RANDOFF") do vi18(.ln)
		if vlist.contains("RDT") do vi19(.ln)
		if vlist.contains("SCHND") do vi20(.ln)
		if vlist.contains("SDTA") do vi21(.ln)
		if vlist.contains("SRCDT") do vi22(.ln)
		if vlist.contains("SUBPLN") do vi23(.ln)
		if vlist.contains("WDND") do vi24(.ln)
		if vlist.contains("XACN") do vi25(.ln)
		if vlist.contains("XBRCD") do vi26(.ln)
		if vlist.contains("XCC") do vi27(.ln)
		if vlist.contains("XCLS") do vi28(.ln)
		if vlist.contains("XCLSACN") do vi29(.ln)
		if vlist.contains("XCRCD") do vi30(.ln)
		if vlist.contains("XREFXLNR") do vi31(.ln)
	}

	quit


public VIDXBLD1(RecordLN ln, List vlist) // Rebuild index files for one record (External call)


	type Number i

	if vlist.contains("VINDEX") do VINDEX(.ln) quit
	if vlist.contains("ACONVACN") do vi1(.ln)
	if vlist.contains("ANOFF") do vi2(.ln)
	if vlist.contains("BNDT") do vi3(.ln)
	if vlist.contains("CNVDT") do vi4(.ln)
	if vlist.contains("COLEXTRDYS") do vi5(.ln)
	if vlist.contains("ICHND") do vi6(.ln)
	if vlist.contains("INTINDEX") do vi7(.ln)
	if vlist.contains("INTOFF") do vi8(.ln)
	if vlist.contains("LCOM") do vi9(.ln)
	if vlist.contains("LCOMACN") do vi10(.ln)
	if vlist.contains("LNFEETA") do vi11(.ln)
	if vlist.contains("LNSUB") do vi12(.ln)
	if vlist.contains("MATRIX") do vi13(.ln)
	if vlist.contains("MDT") do vi14(.ln)
	if vlist.contains("PAYLKTO") do vi15(.ln)
	if vlist.contains("PCHND") do vi16(.ln)
	if vlist.contains("PCOFF") do vi17(.ln)
	if vlist.contains("RANDOFF") do vi18(.ln)
	if vlist.contains("RDT") do vi19(.ln)
	if vlist.contains("SCHND") do vi20(.ln)
	if vlist.contains("SDTA") do vi21(.ln)
	if vlist.contains("SRCDT") do vi22(.ln)
	if vlist.contains("SUBPLN") do vi23(.ln)
	if vlist.contains("WDND") do vi24(.ln)
	if vlist.contains("XACN") do vi25(.ln)
	if vlist.contains("XBRCD") do vi26(.ln)
	if vlist.contains("XCC") do vi27(.ln)
	if vlist.contains("XCLS") do vi28(.ln)
	if vlist.contains("XCLSACN") do vi29(.ln)
	if vlist.contains("XCRCD") do vi30(.ln)
	if vlist.contains("XREFXLNR") do vi31(.ln)

	quit


vidxerr(di) // Error message

	D SETERR^DBSEXECU("LN","MSG",1225,"LN."_di)

	quit
