UTLPRNT	
  /*
	ORIG: alagarss - 12/05/2005
	DESC: Generic Print Utility

	---- Comments --------------------------------------------------------
	
	---- Revision History ------------------------------------------------
	03/30/06 - ALAGARSS - 20446
		   Modified the INIT section to call VPG01.
	
	12/05/05 - ALAGARSS - 16677
                   Migrated from Bilbo v70dev.
        ----------------------------------------------------------------------
 */
 
 
INIT    //
              
        type public Number OLNTB,%PG,%PAGE,%ZTSEQ,%ZTHANG 
        type public String ET,RM,VFMQ
        
        set %PG=1 
        set %PAGE=1   
        set %ProcessMode=1  
        catch vERROR {  
                
                set ET=vERROR.type
 
                if ET["%GTM-" do ZE^UTLERR quit
 
                set ET=ET_"-"_vERROR.thrownAt
                set RM=vERROR.description

                do ^UTLERR

                }
        do VPG01 quit 
        
VPG01   // Screen
        type public Number COPIES
        type public String DIR,VFMQ
        
        set COPIES=1

        set DIR=$$SCAU^%TRNLNM("SPOOL")

        //Define user's login directory
        if DIR="" set DIR=$$HOME^%TRNLNM()  

        do DRV^USID(%ProcessMode,"PRINT")

        if VFMQ="Q" do END quit
        
        quit


FILE    // File data

        /*Print each file in array FILE to the specified device (IO), COPIES
          number of times       
        */  
        type Number I,J
        type String X
        type public Number COPIES,IO
        type public Boolean ER
        type public String FILE()
        
        for I=1:1 set X=$G(FILE(I)) do { quit:X=""  
                for J=1:1:COPIES do { quit:ER
                        set ER=$$COPYFIL^%OSSCRPT(X,IO)
                        }
                }
	quit

END     //
      	type public String RM,VFMQ
      	type public Number ER
        
        if $G(ER) quit

        // Files not printed  
        if VFMQ="Q" set RM=$$^MSG(1099)

        // Files printed
        else  set RM=$$^MSG(1100)
        set ER="W"
        quit

 
 #OPTION ResultClass ON
Public String vSIG()	quit "60354^27038^Sivakumar Alagarsamy^1986"	// Signature - LTD^TIME^USER^SIZE
