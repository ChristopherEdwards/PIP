FORMCOPY	  /*
ORIG: waltonj - 07/07/2000
DESC: Copy Form

---- Comments --------------------------------------------------------

---- Revision History ------------------------------------------------

	12/16/05 - PrakashJ - 17423
		Removed unscoped variables.
		
	07/26/00 - Ofaltr - 40116
		Modified POST section to only allow one variation for
		forms IRAMADNOT and IRAMADMIN.


 ****** Consider using setAuditFlag for all objects in this procedure
   example :do dep.setAuditFlag(1)

 */

	type String %TAB,%READ
	type String CO,FORM,VAR,VFMQ,XCO1,XVAR1
	
	set %TAB("CO")="[UTBLFORMVAR]CO"
	set %TAB("FORM")="[UTBLFORMVAR]FORM"
	set %TAB("VAR")="[UTBLFORMVAR]VAR/TBL=[UTBLFORMVAR]"
	set %TAB("XCO1")="/DES=Copy to new Company Code/LEN=12/TYP=T/TBL=[UTBLCO]DES/REQ/XPP=S XVAR1=$$POST1^FORMCOPY(X,FORM,VAR)" 
	set %TAB("XVAR1")="/DES=Variation/LEN=3/TYP=N/XPP=D POST^FORMCOPY(XCO1,FORM,X)/REQ/XPR=D DSP^DBSMACRO(XVAR1,5)"
	set %READ="@@%FN/REV/CEN,,CO,FORM,VAR,,,XCO1,XVAR1"
	do ^UTLREAD quit:VFMQ="Q"

	type RecordUTBLFORMVAR form1=Db.getRecord("UTBLFORMVAR","CO,FORM,VAR")
	type RecordUTBLFORMVAR form2=form1.copy()

	set form2.co=XCO1
	set form2.var=XVAR1
	do form2.bypassSave()

	quit

	//----------------------------------------------------------------
POST1(String XCOD,String XFORMD,Number XVARD)	//
	//----------------------------------------------------------------

	type RecordUTBLFORMVAR formvar=Db.getRecord("UTBLFORMVAR","CO=:XCOD,FORM=:XFORMD,VAR=:XVARD",1)
	if formvar.getMode() quit Db.nextVal("UTBLFORMVAR","XCOD,XFORMD")
	quit XVARD

	//----------------------------------------------------------------
POST(String XCOD,String XFORMD,Number XVARD)	//
	//----------------------------------------------------------------

	type public Boolean ER
	type public String FORM,RM,XCO1

	type RecordUTBLFORMVAR frmvar=Db.getRecord("UTBLFORMVAR","CO=:XCOD,FORM=:XFORMD,VAR=:XVARD",1)
	if frmvar.getMode() set ER=1 do Runtime.setErrMSG("4475")

	if ((FORM="IRAMADNOT")!(FORM="IRAMADMIN"))&(Db.currVal("UTBLFORMVAR","XCO1,FORM")) set ER=1,RM=$$^MSG(4474,FORM)
	quit
 #OPTION ResultClass ON
Public String vSIG()	quit "60295^32769^Jaimano Prakash^2000"	// Signature - LTD^TIME^USER^SIZE
