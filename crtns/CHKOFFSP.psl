CHKOFFSP	  /*
ORIG: VETSENM - 04/26/2000
DESC: Check Offsite Printing

---- Comments --------------------------------------------------------

---- Revision History ------------------------------------------------

 */

 
	 new XTJD
         set XTJD=%SystemDate-1
	 new offsite
         type ResultSet offsite=Db.select("OFFSPNT","UTBLCHKS")
         for  quit:'offsite.next()  do {
         	new OFFSPNT
                set OFFSPNT=offsite.getCol(1)
         	if OFFSPNT=1  do CHKSET(OFFSPNT)
		}
 		quit
CHKSET(OFFSPNT)    	 
	new chkset
        type ResultSet chkset=Db.select("CHKS,NCHKPNUM,CID","UTBLCHKS","OFFSPNT=:OFFSPNT")
        for  quit:'chkset.next()  do {
        	new CKTYP,XCKNO,GL
                set CKTYP=chkset.getCol(1)
                set XCKNO=chkset.getCol(2)
                set GL=chkset.getCol(3)
                if CKTYP'=""  do XPDO(CKTYP,XCKNO,GL)
		}
		quit 
         	
XPDO(CKTYP,XCKNO,GL)
	new rs
        type ResultSet rs=Db.select("CKTYP,CID,CO,TAMT","XPDO","TJD=:XTJD AND CKTYP=:CKTYP")

	for  quit:'rs.next()  do {
		new TJD,CKTYP,CKNO
         
		set TJD=XTJD
                set CKTYP=rs.getCol(1)
                set CID=rs.getCol(2)
                set CO=rs.getCol(3)
		set TAMT=rs.getCol(4)
                set CKNO=XCKNO
                                              
                do OFFSITE^CHKBPNT(TJD,CKTYP,CKNO,CID,GL,CO,TAMT)
    	}	
        quit
 #OPTION ResultClass ON
Public String vSIG()	quit "60025^39066^Balaji Gopalkrishnan^1337"	// Signature - LTD^TIME^USER^SIZE
