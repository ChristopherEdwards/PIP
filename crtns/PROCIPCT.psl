PROCIPCT		/*

	---- Revision History ------------------------------------------------
	11/26/05 - ALAGARSS - CR 18006
		   Removed deprecated method Db.getOneRow and replaced with
		   Db.getRecord.
		   
	08/12/99 - Terrie Dougherty 33890
		   Convert to PSL

	*/
	
	quit 

VERPCT(ICID,PCT,CLFLG)	// Verify the validity of investment percentage

	/*
	This section handles all necessary validation for inserting/updating
	[DEP101]PCT (Percentage Allocation) for a sweep-investment account
 	relationship. It is called from the DEP101 filer for insertion
	(for both existing investment accounts and automatic investment
	account create) and update (BU_PCT).
	*/
	type public Boolean ER
	type public Number PCTMIN,STAT
	
	type RecordCUVAR cuvar=Db.getRecord("CUVAR")
	set PCTMIN=cuvar.invpctmin

	// Percentage allocation for ~p1 must equal 0% or between 10% and 100% inclusive
	if PCT>0,PCT<PCTMIN do Runtime.setErrMSG("DEP101",2804,"ICID~PCTMIN") quit:ER 
	if (PCT>100)!(PCT<0) do Runtime.setErrMSG("DEP101",2804,"ICID~PCTMIN") quit:ER 
	
	// Do not check closeout error
	if 'CLFLG quit
	
		
	type RecordDEP dep=Db.getRecord("DEP","CID=:ICID")
	set STAT=dep.stat

	// Percentage allocation for ~p1 must be zero when closeout in process
	if PCT,STAT=5 do Runtime.setErrMSG("DEP101",2803,ICID) quit:ER 
	quit 
 #OPTION ResultClass ON
Public String vSIG()	quit "60235^37374^Sivakumar Alagarsamy^1253"	// Signature - LTD^TIME^USER^SIZE
