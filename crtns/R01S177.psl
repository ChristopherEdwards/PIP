R01S177	// SCA105 - IRS 1098 Report by Tax Identification
	// Copyright(c)2007 Sanchez Computer Associates, Inc.  All Rights Reserved - 08/30/2007 14:53 - joynerd

	type public Number ER=0
	type public Number vbatchq
	type public String IO,RM,VRWOPT()
	type public String CTOF,PROTVAL
	type String CTOFA=0
	type Number OLNTB
	type String %READ,RID,RN,%TAB,VFMQ

	set RID="SCA105"
	set RN="IRS 1098 Report by Tax Identification"
	if IO.get()="" set IO=$I

	do INIT^%ZM()

	do VPREBQ quit:VFMQ.get()			// Pre-processor (before query)

	set %TAB("IO")=$$IO^SCATAB

	set %READ="IO/REQ,"

	// Skip device prompt option
	if VRWOPT("NOOPEN").get() set %READ=%READ.piece(",",2,99)

	set VFMQ=""
	if %READ'="" do { quit:VFMQ.get()="Q"
		set OLNTB=30
		set %READ="@RN/CEN#1,,"_%READ
		do ^UTLREAD
		}

	if 'vbatchq.get() do V0
	quit

V0	// External report entry point

	type public Number AUXPTR,ER,VTBLNAM
	type public String IO,IOPAR,IOSL,IOTYP,%MSKD,RM,VDISTKEY,VRWOPT()
	type public String CTOF,PROTVAL
	type public String CTOFA=0
	type Number vcrt,VD(),VFMQ,vh(),vI,vlc,VLC,VNEWHDR,VOFFLG,VPN,VR,VRG,vs(),VSEQ,VT()
	type String %TIM,BALPTYE,CC,CONAM,IPYE,NAM,PNTSPY,PREFINT,RID,RN,TAXID,VL,VLOF,VRF(),VSTATS(),vCOL,vHDG,vc1,vc2,vc3,vc4,vc5,vc6,vc7,vc8,vc9,vovc1,vovc2,vovc3,vovc4,vovc5,vovc6,vovc7,vovc8,vrundate,vsysdate

	type RecordCUVAR cuvar=Db.getRecord("CUVAR")

	set CONAM=CUVAR.conam
	set ER=0,RID="SCA105",RN="IRS 1098 Report by Tax Identification"
	set VL=""

	use 0 if 'VRWOPT("NOOPEN").get() do { quit:ER
		if 'VRWOPT("IOPAR").get().isNull() set IOPAR = VRWOPT("IOPAR")
		else  if ((IOTYP.get()="RMS")!(IOTYP.get()="PNTQ")),('IOPAR.get().isLike("%/OCHSET=%")),$$VALID^%ZRTNS("UCIOENCD") do {
			// Accept warning if ^UCIOENCD does not exist
			#ACCEPT Date=07/26/06; Pgm=RussellDS; CR=22121; Group=MISMATCH
			type String CHRSET=$$^UCIOENCD("Report","SCA105","V0","*")
			if 'CHRSET.isNull() set IOPAR = IOPAR_"/OCHSET="_CHRSET
		}
		do OPEN^SCAIO
	}
	set vcrt=(IOTYP="TRM")
	if 'vcrt set IOSL=60				// Non-interactive
	else  do {					// Interactive
		do TERM^%ZUSE(IO,"WIDTH=133")
		write $$CLEARXY^%TRMVT
		write $$SCR132^%TRMVT			// Switch to 132 col mode
		}

	do INIT^%ZM()

	set vCOL="[TMPRPT7]KEY6#56#12"

	// Print Report Banner Page
	if cuvar.banner,'VRWOPT("NOBANNER").get(),IOTYP'="TRM",'AUXPTR.get() do {
		type String VBNRINFO(),VWHERE


		set VWHERE="TMPRPT7.PID=:%ProcessID"
		set VBNRINFO("WHERE")=VWHERE

		set VBNRINFO("DESC")="IRS 1098 Report by Tax Identification"
		set VBNRINFO("PGM")="R01S177"
		set VBNRINFO("RID")="SCA105"
		set VBNRINFO("TABLES")="TMPRPT7"

		set VBNRINFO("ORDERBY",1)="[SYSDEV,TMPRPT7]PID"
		set VBNRINFO("ORDERBY",2)="[SYSDEV,TMPRPT7]KEY1"
		set VBNRINFO("ORDERBY",3)="[SYSDEV,TMPRPT7]KEY2"
		set VBNRINFO("ORDERBY",4)="[SYSDEV,TMPRPT7]KEY3"
		set VBNRINFO("ORDERBY",5)="[SYSDEV,TMPRPT7]KEY4"
		set VBNRINFO("ORDERBY",6)="[SYSDEV,TMPRPT7]KEY5"
		set VBNRINFO("ORDERBY",7)="[SYSDEV,TMPRPT7]KEY6"
		set VBNRINFO("ORDERBY",8)="[SYSDEV,TMPRPT7]KEY7"


		do ^DBSRWBNR(IO,.VBNRINFO)		// Print banner
		}

	// Initialize variables
	set (vc1,vc2,vc3,vc4,vc5,vc6,vc7,vc8,vc9)=""
	set (VFMQ,vlc,VLC,VOFFLG,VPN,VRG)=0
	set VNEWHDR=1
	set VLOF=""
	set %TIM=$$TIM^%ZM
	set vrundate=%CurrentDate.toString(),vsysdate=%SystemDate.toString()

	do {
		type Number I,J,K
		for I=0:1:8 do {
			set (vh(I),VD(I))=0,vs(I)=1	// Group break flags
			set VT(I)=0			// Group count
			for J=1:1:4 do {
				for K=1:1:3 set VT(I,J,K)=""	// Initialize function stats
				}
			}
		}

	do Db.delete("TMPRPTBR","JOBNO=:%ProcessID")	// Report browser data
	set vh(0)=0

	// Run report directly
	do VINILAST
	type ResultSet rwrs=Db.select("TMPRPT7.PID,TMPRPT7.KEY1,TMPRPT7.KEY2,TMPRPT7.KEY3,TMPRPT7.KEY4,TMPRPT7.KEY5,TMPRPT7.KEY6,TMPRPT7.KEY7,TMPRPT7.DATA","TMPRPT7","TMPRPT7.PID=:%ProcessID","TMPRPT7.PID,TMPRPT7.KEY1,TMPRPT7.KEY2,TMPRPT7.KEY3,TMPRPT7.KEY4,TMPRPT7.KEY5,TMPRPT7.KEY6,TMPRPT7.KEY7","","DQMODE=1")
	if ER.get() use 0 write $$MSG^%TRMVT(RM.get(),"",1)	// Debug Mode
	if rwrs.isEmpty() do VEXIT(1) quit
	while rwrs.next() do { quit:VFMQ
		type String V,VI
		set V=rwrs.getRow().toString()
		set VI=""
		do VGETDATA(V,VI)
		do VPRINT quit:VFMQ
		do VSAVLAST
		}
	do VEXIT(0)

	quit


VINILAST	// Initialize last access key values
	type Public String vovc1,vovc2,vovc3,vovc4,vovc5,vovc6,vovc7,vovc8
	set vovc1="",vovc2="",vovc3="",vovc4="",vovc5="",vovc6="",vovc7="",vovc8=""
	quit

VSAVLAST	// Save last access keys values
	type Public String vovc1,vc1,vovc2,vc2,vovc3,vc3,vovc4,vc4,vovc5,vc5,vovc6,vc6,vovc7,vc7,vovc8,vc8
	set vovc1=vc1,vovc2=vc2,vovc3=vc3,vovc4=vc4,vovc5=vc5,vovc6=vc6,vovc7=vc7,vovc8=vc8
	quit


VGETDATA(String V,String VI)	//
	type Public String vc1,vc2,vc3,vc4,vc5,vc6,vc7,vc8,vc9
	set vc1=V.piece($C(9),1)			// TMPRPT7.PID
	set vc2=V.piece($C(9),2)			// TMPRPT7.KEY1
	set vc3=V.piece($C(9),3)			// TMPRPT7.KEY2
	set vc4=V.piece($C(9),4)			// TMPRPT7.KEY3
	set vc5=V.piece($C(9),5)			// TMPRPT7.KEY4
	set vc6=V.piece($C(9),6)			// TMPRPT7.KEY5
	set vc7=V.piece($C(9),7)			// TMPRPT7.KEY6
	set vc8=V.piece($C(9),8)			// TMPRPT7.KEY7
	set vc9=V.piece($C(9),9)			// TMPRPT7.DATA
	quit

	// User-defined pre/post-processor code

VPREBQ	// Pre-processor (before query)

 /*
  ---- Revision History ------------------------------------------------

	05/23/07 - Lance Lan - CR 24982
		   Added logic for the Tax ID masking.
 
        11/18/05 - TITOVE - CR 17287
                   Converted into PSL.
 */

 //Incoming=CTOF,PROTVAL

 type public Boolean CTOFA = 0
 type public Number CTOF,PROTVAL
 
 type Number ACN, FRM98(), IPYE, PNTSPY
 type String BRREG
 
 type RecordUTBLIRS utblirs = Db.getRecord("UTBLIRS", "KEY = '1098'", 1)
 
 // Form Cutoff Amount
 set CTOF = utblirs.fctoff
 
 // Apply 1098 Cutoff to CIF flag
 set CTOFA = CUVAR.ctof1098
 
  // Create a temp table with report data
 
 type DbSet ds = Db.selectDbSet("LN", "(IRSEXM<>1 OR IRSEXM IS NULL) AND (PCIDSTAT=0 OR PCIDSTAT IS NULL)")
 
 if ds.isEmpty() quit
 
 while ds.next() do {
 
        type RecordLN ln = ds.getRecord("LN")
 
        set IPYE = $S('ln.iplcf:ln.ipty,1:ln.ipty+ln.penpty)
 
        set PNTSPY = ln.pntspy
 
        set BRREG = ln.brreg

        if (IPYE < 0) set IPYE = 0
 
        if (PNTSPY < 0) set PNTSPY = 0
 
        if BRREG.isNull() set BRREG = "*"
 
        if ((IPYE + PNTSPY + ln.prefint) = 0) quit
 
        if (ln.irsexm = 2),((ln.ipye + PNTSPY + ln.prefint) < CTOF) quit
 
        if 'CTOFA,((ln.ipye + PNTSPY + ln.prefint) < CTOF) quit
 
        if CTOFA,'(ln.ipye + PNTSPY + ln.prefint) quit
        
        if CTOFA,(ln.irsexm '= 2) set FRM98(ln.acn) = FRM98(ln.acn).get() + ln.ipye + PNTSPY + ln.prefint
 
        type RecordCIF cif = Db.getRecord("CIF", "ACN = :ln.acn", 1)
 
        type RecordTMPRPT7 rpt7 = Db.getRecord("TMPRPT7", "PID = :%ProcessID, KEY1 = :BRREG, KEY2 = :ln.cls, KEY3 = :cif.taxid, KEY4 = :ln.grp, KEY5 = :ln.type, KEY6 = :ln.cid, KEY7 = :ln.acn", 1)
 
        set rpt7.data = cif.nam_"|"_cif.cc_"|"_ln.ipye_"|"_ln.balptye_"|"_PNTSPY_"|"_ln.prefint
 
        do rpt7.save()
        }
 
 set ACN = ""
 
 for  set ACN = FRM98(ACN).order() quit:ACN.isNull()  do {
 
        if (FRM98(ACN) < CTOF) do Db.delete("TMPRPT7","PID=:%ProcessID AND KEY7=:ACN")
        }
 
  /*
   Check if the data item protection scheme is set up on the
   CIF.TAXID column corresponding to report's TAXID variable field.
   After the protection value on the column is determined, and appears
   that a user class has no access to the column's value, the TAXID
   field will be masked in its pre-processor.
  */

 type ResultSet rs = Db.select("TAXID","CIF",,,,"/PROTECTION=2")
 if rs.next() set PROTVAL = rs.getColProt("TAXID")
 else  set PROTVAL = ""
	quit

VRPOST	// Report post-processor

 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 
 do Db.delete("TMPRPT7","PID=:%ProcessID")
	quit

VBRSAVE(Number LINE,String DATA)	// Save for report browser
	type RecordTMPRPTBR tmprptbr=Class.new("RecordTMPRPTBR")
	set tmprptbr.jobno=%ProcessID
	set tmprptbr.lineno=LINE
	set tmprptbr.pageno=0
	set tmprptbr.seq=0
	set tmprptbr.data=DATA
	do tmprptbr.bypassSave()
	quit

VEXIT(NOINFO)	// Exit from report
	type Public Number IOSL,vcrt,VFMQ,vh(),VLC,VPN,VRWOPT,VSTATS()
	type Public String IO,VTBLNAM
	type Number I,PN,vs(),z
	type String VL=""
	set vs(1)=0,vs(2)=0,vs(3)=0,vs(4)=0,vs(5)=0,vs(6)=0,vs(7)=0,vs(8)=0
	if 'VFMQ do VSUM
	if 'VFMQ do VRSUM
	if 'VFMQ do {
		// No information available to display
		if NOINFO=1 set VL=$$^MSG(4655) do VOM
		if vcrt set VL="" for z=VLC+1:1:IOSL do VOM

		if 'VTBLNAM.exists() do {
			set vs(2)=0
			do VRPOST			// Report Post-Processor
			}
		}

	if 'VFMQ,vcrt set PN=-1 do ^DBSRWBR(2)
	if 'VRWOPT("NOCLOSE").get() do CLOSE^SCAIO
	do Db.delete("TMPRPTBR","JOBNO=:%ProcessID")	// Report browser data

	quit

VPRINT	// Print section
	type Public Number VD(),VFMQ,VH0,vh(),VNEWHDR,VR,VRG,VRWOPT,VSEQ
	type Number vskp()

	if VRWOPT("NODTL").get() set vskp(7)=1		// Skip detail
	do VBREAK
	do VSUM quit:VFMQ

	if VH0.get() set vh(0)=0,VNEWHDR=1 kill VH0	// Page Break
	if 'vh(0) do VHDG0 quit:VFMQ
	if 'vskp(7).get() do VDTL7 quit:VFMQ
	do VSTAT
	quit

VBREAK	//
	type Public Number VD(),vh(),VH0,vs(),VT()
	quit:'VT(8)
	type Public String vc1,vovc1,vc2,vovc2,vc3,vovc3,vc4,vovc4,vc5,vovc5,vc6,vovc6,vc7,vovc7,vc8,vovc8
	type Number vb1,vb2,vb3,vb4,vb5,vb6,vb7,vb8
	set (vb1,vb2,vb3,vb4,vb5,vb6,vb7,vb8)=0
	if vb1!(+vovc1'=+vc1) set vs(2)=0,vh(2)=0,VD(1)=0,vb2=1,vb3=1,vb4=1,vb5=1,vb6=1,vb7=1,vb8=1,VH0=1
	if vb2!(vovc2'=vc2) set vs(3)=0,vh(3)=0,VD(2)=0,vb3=1,vb4=1,vb5=1,vb6=1,vb7=1,vb8=1,VH0=1
	if vb3!(vovc3'=vc3) set vs(4)=0,vh(4)=0,VD(3)=0,vb4=1,vb5=1,vb6=1,vb7=1,vb8=1
	if vb4!(vovc4'=vc4) set vs(5)=0,vh(5)=0,VD(4)=0,vb5=1,vb6=1,vb7=1,vb8=1
	if vb5!(vovc5'=vc5) set vs(6)=0,vh(6)=0,VD(5)=0,vb6=1,vb7=1,vb8=1
	if vb6!(vovc6'=vc6) set vs(7)=0,vh(7)=0,VD(6)=0,vb7=1,vb8=1
	if vb7!(vovc7'=vc7) set vs(8)=0,vh(8)=0,VD(7)=0,vb8=1
	quit

VSUM	// Report Group Summary
	type Public Number VFMQ,vs()
	if 'vs(8) set vs(8)=1 do stat^DBSRWUTL(8)
	if 'vs(7) set vs(7)=1 do stat^DBSRWUTL(7)
	if 'vs(6) set vs(6)=1 do stat^DBSRWUTL(6)
	if 'vs(5) set vs(5)=1 do stat^DBSRWUTL(5)
	if 'vs(4) set vs(4)=1 do stat^DBSRWUTL(4)
	if 'vs(3) set vs(3)=1 do stat^DBSRWUTL(3)
	if 'vs(2) set vs(2)=1 do stat^DBSRWUTL(2)
	quit

VSTAT	// Data field statistics
	type Public Number VRWOPT(),VT(),BALPTYE,IPYE,PNTSPY,PREFINT
	type Public String VSTATS

	set VT(8)=VT(8)+1
	set VT(8,1,1)=VT(8,1,1)+BALPTYE			// @TOT(<<BALPTYE>>)
	set VT(8,2,1)=VT(8,2,1)+IPYE			// @TOT(<<IPYE>>)
	set VT(8,3,1)=VT(8,3,1)+PNTSPY			// @TOT(<<PNTSPY>>)
	set VT(8,4,1)=VT(8,4,1)+PREFINT			// @TOT(<<PREFINT>>)
	quit

VDTL7	// Detail
	type public String %TIM,BALPTYE,CC,CTOF,CTOFA=0,IOSL,IPYE,NAM,PNTSPY,PREFINT,PROTVAL,TAXID,V,VD(),VFMQ,VL,VLC,VO,VOFFLG,VPN,VRG,VT(),vc1,vc2,vc3,vc4,vc5,vc6,vc7,vc8,vc9,verror,vh(),vovc1,vovc2,vovc3,vovc4,vovc5,vovc6,vovc7,vovc8,vrundate,vsysdate

	quit:VD(7)  set VD(7)=1				// Print flag
	if VLC+2>IOSL do VHDG0 quit:VFMQ

	do VP1 quit:VFMQ!verror.get()  set V=$E(TAXID,1,11) set VL=V
	do VP2 quit:VFMQ!verror.get()  set V=$E(NAM,1,40)
	set VL=VL_$J("",13-VL.length())_V
	set VL=VL_$J("",55-VL.length())_$J(vc7,12)
	do VP3 quit:VFMQ!verror.get()  set V=$J(CC,6)
	set VL=VL_$J("",69-VL.length())_V
	do VP4 quit:VFMQ!verror.get()  set V=$S(IPYE="":"",1:$J(IPYE,0,2))
	set VL=VL_$J("",84-VL.length())_V
	do VP5 quit:VFMQ!verror.get()  set V=$S(BALPTYE="":"",1:$J(BALPTYE,0,2))
	set VL=VL_$J("",101-VL.length())_V
	do VOM
	do VP6 quit:VFMQ!verror.get()  set V=$S(PNTSPY="":"",1:$J(PNTSPY,0,2)) set VL="                                                                              "_V
	do VP7 quit:VFMQ!verror.get()  set V=$S(PREFINT="":"",1:$J(PREFINT,0,2))
	set VL=VL_$J("",101-VL.length())_V
	do VOM
	quit


VHDG0	// Page Header
	type Public Number ER,IOSL,vcrt,verror,VFMQ,vh(),VLC,VNEWHDR,VPN,VRG,VRWOPT()
	type public String %MSKD,%TIM,BALPTYE,CC,CONAM,CTOF,CTOFA=0,IPYE,NAM,PNTSPY,PREFINT,PROTVAL,RID,RN,TAXID,VL,vc1,vc2,vc3,vc4,vc5,vc6,vc7,vc8,vc9,vovc1,vovc2,vovc3,vovc4,vovc5,vovc6,vovc7,vovc8,vrundate,vsysdate
	type Number PN,V,VO
	if VRWOPT("NOHDR").get() quit			// Skip page header
	set vh(0)=1,VRG=0
	if VL'="" do VOM
	if vcrt,VPN>0 do { quit:VFMQ!'VNEWHDR
		type Number PN,X
		set VL=""
		for X=VLC+1:1:IOSL do VOM
		set PN=VPN
		do ^DBSRWBR(2)
		set VLC=0
		quit:VFMQ
		if VNEWHDR write $$CLEARXY^%TRMVT
		else  set VLC=VLC+9,VPN=VPN+1
		}

	set ER=0,VPN=VPN+1,VLC=0

	set VL=$E($G(CONAM),1,45)
	set VL=VL_$J("",100-VL.length())_"Run Date:"
	set VL=VL_$J("",110-VL.length())_$E(vrundate,1,10)
	set VL=VL_$J("",123-VL.length())_$E(%TIM,1,8)
	do VOM
	set VL=RN_"  ("_RID_")"
	set VL=VL_$J("",102-VL.length())_"System:"
	set VL=VL_$J("",110-VL.length())_$E(vsysdate,1,10)
	set VL=VL_$J("",122-VL.length())_"Page:"
	set VL=VL_$J("",128-VL.length())_$J(VPN,3)
	do VOM
	set VL="" do VOM
	set VL="1098 Cutoff Amount: "_CTOF
	do VOM
	set VL="" do VOM
	set VL="     "_"Tax ID  Name                                           Account  Cost Center        Interest                Balance"
	do VOM
	set VL="                                                                                     "_"Points Paid             Int Refund"
	do VOM
	set VL="===================================================================================================================================="
	do VOM
	set VL="" do VOM

	set VNEWHDR=0
	if vcrt set PN=VPN do ^DBSRWBR(2,1)		// Lock report page heading

	quit


VRSUM	// Report Summary
	type Public Number IOSL,verror,VFMQ,vh,VLC,VT(),VX()
	type Public String %TIM,BALPTYE,CC,CTOF,IPYE,NAM,PNTSPY,PREFINT,TAXID,VPN,vovc1,vovc2,vovc3,vovc4,vovc5,vovc6,vovc7,vovc8,vrundate,vsysdate
	type Number I
	type String V,VL

	set VL=""
	if 'vh(0) do VHDG0 quit:VFMQ
	if VLC+3>IOSL do VHDG0 quit:VFMQ

	set VL="" do VOM
	set VL="Report Totals:"
	set V=(VT(0)+VT(1)+VT(2)+VT(3)+VT(4)+VT(5)+VT(6)+VT(7)+VT(8))	// @CNT(0,N,4)
	set VL=VL_$J("",16-VL.length())_$J(V,4)
	set VL=VL_$J("",21-VL.length())_"Accounts"
	set V=0						// @TOT(<<IPYE>>,0)
	for I=0:1:8 set V=V+VT(I,2,1)
	set VL=VL_$J("",78-VL.length())_$S(V="":"",1:$J(V,0,2))
	set V=0						// @TOT(<<BALPTYE>>,0)
	for I=0:1:8 set V=V+VT(I,1,1)
	set VL=VL_$J("",101-VL.length())_$S(V="":"",1:$J(V,0,2))
	do VOM
	set V=0						// @TOT(<<PNTSPY>>,0)
	for I=0:1:8 set V=V+VT(I,3,1)
	set VL="                                                                              "_$S(V="":"",1:$J(V,0,2))
	set V=0						// @TOT(<<PREFINT>>,0)
	for I=0:1:8 set V=V+VT(I,4,1)
	set VL=VL_$J("",101-VL.length())_$S(V="":"",1:$J(V,0,2))
	do VOM
	quit

VOM	// Output print line
	type Public Number AUXPTR,vcrt,vlc,VLC,VRG
	type Public String IO,VL

	use IO

	// Advance to a new page
	if 'VLC,'vcrt do {				// Non-CRT device (form feed)
		if 'AUXPTR.get() write $C(12),!
		else  write $$PRNTFF^%TRMVT,!
		set $Y=1
		}

	if vcrt<2 write VL,!				// Output line buffer
	if vcrt set vlc=vlc+1 do VBRSAVE(vlc,VL)	// Save in BROWSER buffer
	set VLC=VLC+1,VL=""				// Reset line buffer
	quit

	// Pre/post-processors

VP1	// Column pre-processor - Variable: TAXID

	type public String vc4
        type public Number PROTVAL

        type public String TAXID = vc4

        // If DATA-QWIK column protection scheme is set on CIF.TAXID column,
        // mask TAXID variable field's value.

        if PROTVAL = 3 set TAXID = "***********"


 

 
	quit

VP2	// Column pre-processor - Variable: NAM

	type public String vc9
 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 type public String NAM = vc9.piece("|",1)
	quit

VP3	// Column pre-processor - Variable: CC

	type public String vc9
 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 type public String CC = vc9.piece("|",2)
	quit

VP4	// Column pre-processor - Variable: IPYE

	type public String vc9
 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 type public Number IPYE = vc9.piece("|",3)
	quit

VP5	// Column pre-processor - Variable: BALPTYE

	type public String vc9
 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 type public Number BALPTYE = vc9.piece("|",4)
	quit

VP6	// Column pre-processor - Variable: PNTSPY

	type public String vc9
 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 type public Number PNTSPY = vc9.piece("|",5)
	quit

VP7	// Column pre-processor - Variable: PREFINT

	type public String vc9
 /*
  ---- Revision History ------------------------------------------------
 
        11/16/05 - TITOVE - CR 17287
                   Converted into PSL.
 */
 type public Number PREFINT = vc9.piece("|",6)
	quit
