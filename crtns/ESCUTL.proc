ESCUTL	  	/*
	ORIG: srinivar - 09/26/2005
	DESC: Escrow Utility

	Comments 
	 
	Revision History
	
	01/13/06 - SmithCD - CR 19545
		   Corrected undefined errors in LNTRS and CNT sections caused 
		   by passing "" as the file name to Runtime.setErrMSG(). Also 
		   added a check for create mode in case the escrow type 
		   entered does not exist in LNTRS.
	
	09/26/05 -  srinivar - CR 16890
		    Converted to PSL.
 	*/
 	
	quit


public LNTRS(String X)		// Escrow type

	// Check to see if a valid escrow type 

	type public String DESC
	
	type RecordLNTRS lntrs = Db.getRecord("LNTRS", "TRTYPE=:X", 1)
	
	// Invalid Escrow Category - ~P1
	if lntrs.getMode() = 0 do Runtime.setErrMSG("LNTRS", 1326, X) quit
	if lntrs.nepf do Runtime.setErrMSG("LNTRS", 1326, X) quit
	if X = "ESC" do Runtime.setErrMSG("LNTRS", 1326, X) quit
	if '$$ESC^LNU(X) do Runtime.setErrMSG("LNTRS", 1326, X) quit
	
	// Find and display description
	set DESC = lntrs.TRDES
	
	quit


public CNT 
	
	/*
	Verifies that no more than 28 escrow transfer types are added per 
	loan product type
	*/

	type public Number TYPE
	
	// Not create mode
	if %ProcessMode quit
	
	type ResultSet rs = Db.select("COUNT(ITEM)", "ESCGRP", "TYPE=:TYPE")
	
	// Maximum of 28 Escow types		
	if rs.next(), rs.getRow() = 28 do Runtime.setErrMSG("ESCGRP", 8546)

	quit

vSIG()	quit "60309^58772^Chad Smith^1250"	// Signature - LTD^TIME^USER^SIZE
