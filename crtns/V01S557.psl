V01S557(Number %ProcessMode,RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)   //PBS - DEP - SID= <SRVPLNQ2> Service Fee Plan Definition 
 ;;Copyright(c)2007 Sanchez Computer Associates, Inc.  All Rights Reserved - 08/30/2007 14:34 - joynerd
 // This screen is used to modify the specifications for a fee item in category 2
 // (event-related fees) of a service fee plan.  It is also used to associate one
 // or more queries with the fee plan item or to modify the specifications for
 // existing queries.
  /*
ORIG: CHENARDP - 03/03/2003
DESC: PSL Screen Compiler Template

---- Comments --------------------------------------------------------
	This procedure is used as the base template for the PSL screen compiler.
	It is referenced by the PSL screen compiler - procedure DBS2PSL4
	
	
---- Revision History ------------------------------------------------
	02/18/07 - Pete Chenard - CR23555
		   Corrected compiler warnings.
		   
	02/23/06 - Pete Chenard - CR19551
		   Fixed routine label.
		   
	05/19/05 - Pete Chenard - CR 14146
		   Modified to type variables.
		   
	12/1/03 - Spier -cr7178
	   	     Modifications to correct dead code warnings and
	   	     other issues that occurred during mass compile of screens.

	09/24/03 - Pete Chenard - 45497
		       Created screen template for compiler.
----------------------------------------------------------------------

 */

 #WARN SCOPE OFF
	type Public String %MODS,%PAGE,%PG,%REPEAT,ER,RM
	type String KEYS(),KVAR,VFSN(),VO,VODFT,VPGM,vPSL,VSID,VSNAME

	// %O (0-Create  1-Modify  2-Inquiry  3-Delete  4-Print  5-Blank screen)

	set:'%ProcessMode.exists() %ProcessMode=5
 if (%ProcessMode = 5) do {
  if 'fFEEQRY(1).exists() set fFEEQRY(1) = Class.new("RecordFEEQRY")
  if 'fFEESRV.exists() set fFEESRV = Class.new("RecordFEESRV")
  if 'fFEEPLN.exists() set fFEEPLN = Class.new("RecordFEEPLN")
 }
 set KVAR="kill %TAB,VFSN,VO,VPTBL,vtab",VSID="SRVPLNQ2",VPGM=$T(+0),VSNAME="Service Fee Plan Definition "
 set VFSN("FEEPLN")="zfFEEPLN",VFSN("FEEQRY")="zfFEEQRY",VFSN("FEESRV")="zfFEESRV"
 set vPSL=1
 set KEYS(1)=fFEEPLN.PLAN
 set KEYS(2)=fFEEPLN.FEEDT
 //
	// ==================== Display blank screen         (%O=5)

 if %ProcessMode=5 set %MODS=1,%REPEAT=9 do VPR(.fFEEQRY(),.fFEESRV,.fFEEPLN),VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN),V5^DBSPNT quit

 if '%ProcessMode do VNEW(.fFEEQRY(),.fFEESRV,.fFEEPLN),VPR(.fFEEQRY(),.fFEESRV,.fFEEPLN),VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 if %ProcessMode do VLOD(.fFEEQRY(),.fFEESRV,.fFEEPLN) quit:$G(ER)  do VPR(.fFEEQRY(),.fFEESRV,.fFEEPLN),VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN)

	// ====================  Display Form
	do ^DBSPNT()
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=XECUTE
	if %ProcessMode=2!(%ProcessMode=3) do ^DBSCRT8A X:'$D(%PAGE) KVAR quit  // Inquiry/Delete
	// ====================  Set up data entry control table


 if %ProcessMode<2 do VTAB(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 type Number ptr
 set ptr=""
 for  set ptr = fFEEQRY(ptr).order() quit:ptr.isNull()  do {
     if fFEEQRY(ptr).QUERY="" kill fFEEQRY(ptr)
     }
	quit


VNEW(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) // Initialize arrays if %O=0
 
 do VDEF(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 do VLOD(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
	
VDEF(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
 ;
VLOD(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) // Load data from disc - %O = (1-5)
 if '$D(%REPEAT) set %REPEAT=9
 if '$D(%MODS) set %MODS=1
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


	type Public String %MODS,%REPEAT
	quit
	

VPR(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) // Display screen prompts
 set VO="21||13|"
 set VO(0)="|0"
 set VO(1)=$C(1,25,29,1,0,0,0,0,0,0)_"01T Service Fee Plan Definition "
 set VO(2)=$C(3,4,17,0,0,0,0,0,0,0)_"01TService Fee Plan:"
 set VO(3)=$C(3,45,21,0,0,0,0,0,0,0)_"01TEvent Related Fees - "
 set VO(4)=$C(3,66,10,0,0,0,0,0,0,0)_"01TCategory 2"
 set VO(5)=$C(4,9,12,0,0,0,0,0,0,0)_"01TDescription:"
 set VO(6)=$C(4,50,15,0,0,0,0,0,0,0)_"01TEffective Date:"
 set VO(7)=$C(6,2,8,2,0,0,0,0,0,0)_"01TFee Type"
 set VO(8)=$C(6,16,11,2,0,0,0,0,0,0)_"01TDescription"
 set VO(9)=$C(6,37,3,2,0,0,0,0,0,0)_"01TOpt"
 set VO(10)=$C(6,48,6,2,0,0,0,0,0,0)_"01TAmount"
 set VO(11)=$C(6,56,8,2,0,0,0,0,0,0)_"01TSchedule"
 set VO(12)=$C(6,67,9,2,0,0,0,0,0,0)_"01TFee Table"
 set VO(13)=$C(7,45,9,2,0,0,0,0,0,0)_"01TMax Daily"
 set VO(14)=$C(11,31,17,0,0,0,0,0,0,0)_"01TQuery Definition "
 set VO(15)=$C(12,2,5,2,0,0,0,0,0,0)_"01TQuery"
 set VO(16)=$C(12,16,11,2,0,0,0,0,0,0)_"01TDescription"
 set VO(17)=$C(12,38,3,2,0,0,0,0,0,0)_"01TPri"
 set VO(18)=$C(12,48,6,2,0,0,0,0,0,0)_"01TAmount"
 set VO(19)=$C(12,56,8,2,0,0,0,0,0,0)_"01TSchedule"
 set VO(20)=$C(12,67,9,2,0,0,0,0,0,0)_"01TFee Table"
 set VO(21)=$C(13,45,9,2,0,0,0,0,0,0)_"01TMax Daily"
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VDA1(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)  // Display screen data
 new V
 if %ProcessMode=5 new FDESC
 if  set (FDESC)=""
 else  set FDESC=$G(FDESC)
 
 s FDESC=$G(FDESC)
 //
 set VO="31|22|13|"
 set VO(22)=$C(3,22,5,2,0,0,0,0,0,0)_"01T"_$E(fFEEPLN.PLAN,1,5)
 set VO(23)=$C(4,22,25,2,0,0,0,0,0,0)_"01T"_$E(fFEEPLN.DESC,1,25)
 set VO(24)=$C(4,66,10,2,0,0,0,0,0,0)_"01D"_$$DAT^%ZM(fFEEQRY(1).FEEDT)
 set VO(25)=$C(8,2,8,2,0,0,0,0,0,0)_"01T"_$E(fFEESRV.FEETYP,1,8)
 set VO(26)=$C(8,16,20,2,0,0,0,0,0,0)_"01T"_FDESC.get()
 set VO(27)=$C(8,38,1,2,0,0,0,0,0,0)_"00N"_fFEESRV.CHGOPT
 set V=$S(fFEESRV.FEEAMT="":"",1:$J(fFEESRV.FEEAMT,0,2)) set VO(28)=$C(8,42,12,2,0,0,0,0,0,0)_"00$"_$S(fFEESRV.FEEAMT="":"",1:$J(fFEESRV.FEEAMT,0,2))
 set VO(29)=$C(8,58,6,2,0,0,0,0,0,0)_"00T"_$E(fFEESRV.FEESCH,1,6)
 set VO(30)=$C(8,67,12,2,0,0,0,0,0,0)_"00T"_$E(fFEESRV.FEETBL,1,12)
 set V=$S(fFEESRV.MAXDLY="":"",1:$J(fFEESRV.MAXDLY,0,2)) set VO(31)=$C(9,42,12,2,0,0,0,0,0,0)_"00$"_$S(fFEESRV.MAXDLY="":"",1:$J(fFEESRV.MAXDLY,0,2))
  
 set:'%MODS.exists() %MODS=1 set VX=VO.piece("|",2)+9,DY=14 for I=%MODS:1:%REPEAT+%MODS-1 do VRDA(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 set VO.piece("|",1)=VX quit  // EOD pointer
 
VRDA(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)  // Display data %REPEAT times
 //instantiate new object if necessary
  #ACCEPT;DATE=08/08/06; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEPRECATED
  if 'fFEEQRY(I).getPointer() do {
     set fFEEQRY(I)=Class.new("RecordFEEQRY","$G(KEYS(1)),$G(KEYS(2))")
     }
 set VO(VX+1)=$C(DY,2,12,2,0,0,0,0,0,0)_"00T"_$E(fFEEQRY(I).QRYNAME,1,12)
 set VO(VX+2)=$C(DY,16,20,2,0,0,0,0,0,0)_"01T"_$E(fFEEQRY(I).DESC,1,20)
 set VO(VX+3)=$C(DY,39,1,2,0,0,0,0,0,0)_"00N"_fFEEQRY(I).PRI
 set V=$S(fFEEQRY(I).FEEAMT="":"",1:$J(fFEEQRY(I).FEEAMT,0,4)) set VO(VX+4)=$C(DY,42,12,2,0,0,0,0,0,0)_"00N"_$S(fFEEQRY(I).FEEAMT="":"",1:$J(fFEEQRY(I).FEEAMT,0,4))
 set VO(VX+5)=$C(DY,58,6,2,0,0,0,0,0,0)_"00T"_$E(fFEEQRY(I).FEESCH,1,6)
 set VO(VX+6)=$C(DY,67,12,2,0,0,0,0,0,0)_"00T"_$E(fFEEQRY(I).FEETBL,1,12)
 set V=$S(fFEEQRY(I).MAXDLY="":"",1:$J(fFEEQRY(I).MAXDLY,0,2)) set VO(VX+7)=$C(DY+1,42,12,2,0,0,0,0,0,0)_"00$"_$S(fFEEQRY(I).MAXDLY="":"",1:$J(fFEEQRY(I).MAXDLY,0,2))
 set DY=DY+2,VX=VX+7
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
	
	
VTAB(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)
 
 kill VSCRPP,REQ,%TAB,%MOD,%MODOFF,%MODGRP,%REPREQ,vtab set %MODGRP=2
 set %MODOFF=10,%MOD=7,%MAX=(%MOD*%REPEAT)+%MODOFF,VPT=1,VPB=13+(%REPEAT*2),BLKSIZ=(75*%REPEAT)+111,PGM=$T(+0),DLIB="SYSDEV",DFID="FEEQRY,FEESRV,FEEPLN",VSCRPP=1,VSCRPP=1
 set OLNTB=VPB*1000
 
 set VFSN("FEEPLN")="zfFEEPLN",VFSN("FEEQRY")="zfFEEQRY",VFSN("FEESRV")="zfFEESRV"
 //
 for I=18:1:%MAX set %TAB(I)=""
	
	
 set %TAB(1)=$C(2,21,5)_"21T12401|1|[FEEPLN]PLAN||if X?1AN.AN"
 set %TAB(2)=$C(3,21,25)_"21T12401||[FEEPLN]DESC"
 set %TAB(3)=$C(3,65,10)_"21D12402|1|[FEEQRY]FEEDT"
 set %TAB(4)=$C(7,1,8)_"21T12404|1|[FEESRV]FEETYP"
 set %TAB(5)=$C(7,15,20)_"20T|*FDESC|[*]@FDESC"
 set %TAB(6)=$C(7,37,1)_"01N12402||[FEESRV]CHGOPT|[STBLFEECO]||do VP1^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)"
 set %TAB(7)=$C(7,41,12)_"00$12403||[FEESRV]FEEAMT|||do VP2^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)||||2"
 set %TAB(8)=$C(7,57,6)_"00T12404||[FEESRV]FEESCH|[UTBLFEESCH]FEESCH:DISTINCT||do VP3^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)"
 set %TAB(9)=$C(7,66,12)_"00T12408||[FEESRV]FEETBL|[UTBLFEETBL]||do VP4^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)"
 set %TAB(10)=$C(8,41,12)_"00$12405||[FEESRV]MAXDLY|||do VP5^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)||||2"
 set %TAB(11)=$C(13,1,12)_"00T12401|1|[FEEQRY]QRYNAME|[DBTBL4]||do VP6^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)"
 set %TAB(12)=$C(13,15,20)_"20T12406|1|[FEEQRY]DESC|||||||||40"
 set %TAB(13)=$C(13,38,1)_"00N12405|1|[FEEQRY]PRI|||do VP7^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)||1|5"
 set %TAB(14)=$C(13,41,12)_"00N12402|1|[FEEQRY]FEEAMT|||do VP8^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)||0|999999|4"
 set %TAB(15)=$C(13,57,6)_"00T12403|1|[FEEQRY]FEESCH|[UTBLFEESCH]FEESCH:DISTINCT||do VP9^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)"
 set %TAB(16)=$C(13,66,12)_"00T12408|1|[FEEQRY]FEETBL|[UTBLFEETBL]||do VP10^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)"
 set %TAB(17)=$C(14,41,12)_"00$12404|1|[FEEQRY]MAXDLY|||do VP11^V01S557(.fFEEQRY,.fFEESRV,.fFEEPLN)||||2"
 do VTBL(.fFEEQRY(),.fFEESRV,.fFEEPLN)
	do ^DBSCRT8 	// data entry
	quit


VREQ   // Create REQ() array
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VTBL(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //Create %TAB(array)
 	// 1 2 3  4 5   6   7-9 10-11
 	// DY,DX,SZ PT REQ TYPE DEL POS |NODE|ITEM NAME|TBL|FMT|PP|PRE|MIN|MAX|DEC

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


VSPP   // screen post proc
 type Public RecordFEEQRY fFEEQRY()
 type Public RecordFEESRV fFEESRV
 type Public RecordFEEPLN fFEEPLN
 do VSPP1(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 #ACCEPT Date=11/05/03; pgm=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
VSPP1(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)
	do PLNQSPP^SRVPLN(.fFEESRV,.fFEEQRY(),1)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit


  //user-defined post procs
 //
VP1(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	quit:X=""

	quit:'Db.isDefined("STBLFEECO","OPT=:X")

	if X'=2,fFEEPLN.pltp do {
		set ER=1
		// Usage credit plans only assess on analysis (charge option 2)
		set RM=$$^MSG(3135)
		}

	if X'=1,%IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEESRV]MAXDLY","1","0")
		// No daily maximum can be applied
		set RM=$$^MSG(1922)
		}

	quit
VP2(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	quit:X=""

	if %IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEESRV]FEESCH","1","0")
		do DELETE^DBSMACRO("[FEESRV]FEETBL","1","0")
		if fFEESRV.chgopt=1 do GOTO^DBSMACRO("[FEESRV]MAXDLY") quit 
		do GOTO^DBSMACRO("[FEEQRY]QRYNAME")
		}
	quit
VP3(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	quit:X=""

	type ResultSet rs=Db.select("FEESCH","UTBLFEESCH","FEESCH=:X")
	quit:rs.isEmpty()

	if %IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEESRV]FEEAMT","1","0")
		do DELETE^DBSMACRO("[FEESRV]FEETBL","1","0")
		if fFEESRV.chgopt'=1 do GOTO^DBSMACRO("[FEEQRY]QRYNAME")
		}
	quit
VP4(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if X="",fFEESRV.feeamt="",fFEESRV.feesch="" do { quit
		set ER=1
		// Fee amount, fee schedule, or fee lookup table required
		set RM=$$^MSG(1063)
		}

	quit:X=""

	if %IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEESRV]FEEAMT","1","0")
		do DELETE^DBSMACRO("[FEESRV]FEESCH","1","0")
		if fFEESRV.chgopt'=1 do GOTO^DBSMACRO("[FEEQRY]QRYNAME")
		}

	quit
VP5(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if X'="",fFEESRV.chgopt'=1 do {
		set ER=1
		// Daily maximum not allowed unless charged at time of service (Chg Opt=1)
		set RM=$$^MSG(725)
		}

	quit
VP6(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if X="",V'="" do { quit 
		// DELETE ALL IF THERE WAS AN ENTRY IN THIS FIELD
		if %IPMODE.get()'["NOINT" do {
			do DELETE^DBSMACRO("[FEEQRY]DESC","1","0")
			do DELETE^DBSMACRO("[FEEQRY]PRI","1","0")
			do DELETE^DBSMACRO("[FEEQRY]FEEAMT","1","0")
			do DELETE^DBSMACRO("[FEEQRY]FEESCH","1","0")
			do DELETE^DBSMACRO("[FEEQRY]FEETBL","1","0")
			do DELETE^DBSMACRO("[FEEQRY]MAXDLY","1","0")
			}
		}

	quit:X=""

	type RecordDBTBL4 dbtbl4=Db.getRecord("DBTBL4","LIBS=""SYSDEV"",QID=:X",1)
	quit:'dbtbl4.getMode()

	do DEFAULT^DBSMACRO("[FEEQRY]DESC",dbtbl4.desc,"1","0","0")

	quit
VP7(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if fFEEQRY(I(1)).qryname'="",X="" do { quit
		set ER=1
		// Priority 1-5 required
		set RM=$$^MSG(2233)
		}

	if fFEEQRY(I(1)).qryname="",X'="" do {
		set ER=1
		// No entry allowed without query name
		set RM=$$^MSG(1929)
		}

	quit
VP8(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if fFEEQRY(I(1)).qryname="",X'="" do { quit
		set ER=1 
		// No fee amount allowed without query name
		set RM=$$^MSG(1935)
		}

	quit:X=""

	if %IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEEQRY]FEESCH","1","0")
		do DELETE^DBSMACRO("[FEEQRY]FEETBL","1","0")
		do GOTO^DBSMACRO("[FEEQRY]MAXDLY")
		}

	quit
VP9(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if fFEEQRY(I(1)).qryname="",X'="" do { quit
		set ER=1 
		// No fee schedule allowed without query name
		set RM=$$^MSG(1937)
		}

	quit:fFEEQRY(I(1)).qryname=""
	quit:X=""
	
	type ResultSet rs=Db.select("FEESCH","UTBLFEESCH","FEESCH=:X")
	quit:rs.isEmpty()

	if %IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEEQRY]FEEAMT","1","0")
		do DELETE^DBSMACRO("[FEEQRY]FEETBL","1","0")
		}

	quit
VP10(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if fFEEQRY(I(1)).qryname="",X'="" do { quit
		set ER=1 
		// No fee lookup table allowed without query name
		set RM=$$^MSG(35)
		}

	quit:fFEEQRY(I(1)).qryname=""

	if X="",fFEEQRY(I(1)).feeamt="",fFEEQRY(I(1)).feesch="" do { quit
		set ER=1
		// Fee amount, fee schedule, or fee lookup table required
		set RM=$$^MSG(1063)
		}

	quit:X=""

	if %IPMODE.get()'["NOINT" do {
		do DELETE^DBSMACRO("[FEEQRY]FEEAMT","1","0")
		do DELETE^DBSMACRO("[FEEQRY]FEESCH","1","0")
		}

	quit
VP11(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN) //
	if fFEEQRY(I(1)).qryname="",X'="" do { quit
		set ER=1 
		// No daily maximum allowed without query name
		set RM=$$^MSG(1921)
		}
	if fFEESRV.chgopt'=1,X'="" do {
		set ER=1
		// Daily maximum not allowed unless charged at time of service (Chg Opt=1)
		set RM=$$^MSG(725)
		}

	quit
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit								// User defined post processor's


VRV(V,L) quit V_$J("",L-$L(V))
VREPRNT
 type Public RecordFEEQRY fFEEQRY()
 type Public RecordFEESRV fFEESRV
 type Public RecordFEEPLN fFEEPLN
 do VPR(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 do VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 do ^DBSPNT()
 quit

VW(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)
 do VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 do ^DBSPNT(10)
 quit

VDAPNT(RecordFEEQRY fFEEQRY(),RecordFEESRV fFEESRV,RecordFEEPLN fFEEPLN)
 do VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 do ^DBSPNT(0,2)
 quit

VDA
 type Public RecordFEEQRY fFEEQRY()
 type Public RecordFEESRV fFEESRV
 type Public RecordFEEPLN fFEEPLN
 do VDA1(.fFEEQRY(),.fFEESRV,.fFEEPLN)
 quit

	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
 
vSET(sn,di,X)
 type Public RecordFEEQRY fFEEQRY()
 if sn="FEEQRY" do vSET1(fFEEQRY(I(1)),di,X)
 type Public RecordFEESRV fFEESRV
 if sn="FEESRV" do vSET2(.fFEESRV,di,X)
 type Public RecordFEEPLN fFEEPLN
 if sn="FEEPLN" do vSET3(.fFEEPLN,di,X)
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
vSET1(RecordFEEQRY fFEEQRY,di,X)
 do fFEEQRY.setAuditFlag(1)
 set fFEEQRY.@di=X
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
vSET2(RecordFEESRV fFEESRV,di,X)
 do fFEESRV.setAuditFlag(1)
 set fFEESRV.@di=X
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
vSET3(RecordFEEPLN fFEEPLN,di,X)
 do fFEEPLN.setAuditFlag(1)
 set fFEEPLN.@di=X
 #ACCEPT Date=11/5/03;PGM=Screen Compiler;CR=UNKNOWN;GROUP=SYNTAX
 quit
	
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
vREAD(fid,di)
 type Public RecordFEEQRY fFEEQRY()
 if fid="FEEQRY" quit $$vREAD1(fFEEQRY(I(1)),di)
 type Public RecordFEESRV fFEESRV
 if fid="FEESRV" quit $$vREAD2(.fFEESRV,di)
 type Public RecordFEEPLN fFEEPLN
 if fid="FEEPLN" quit $$vREAD3(.fFEEPLN,di)
 quit ""
vREAD1(RecordFEEQRY fFEEQRY,di)
 quit fFEEQRY.@di
vREAD2(RecordFEESRV fFEESRV,di)
 quit fFEESRV.@di
vREAD3(RecordFEEPLN fFEEPLN,di)
 quit fFEEPLN.@di
	#ACCEPT DATE=11/05/03; PGM=Screen Compiler;CR=UNKNOWN;GROUP=DEAD
	quit
