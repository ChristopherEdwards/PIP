LNFIL(RecordTTX ttx)	//Public;File Loan Record
	/*
	   ORIG:

	   Files Changes Made To Loan Account Record Via File Maintenance

	   ARGUMENTS:

		.  ttx  Transaction Object      /TYP=RecordTTX/NOREQ/MECH=REF

	   INPUTS:
		 .  CID - Loan Account Number				/TYP=N/REQ/MECH=VAL
		 .  UX - Array of changes made to to account values	/TYP=T/NOREQ/MECH=VAL 

			     UX(FID,DI)=1|2|3|4||6

			     FID - DQ File Short Name
			      DI - DQ Data Item Name
			       1 - Original Value of Data Item
			       2 - New (Changed) Value Of Data Item
			       3 - Account Node Placement of Data Item
			       4 - Account Node Piece of Data Item
			       6 - History Indicator (0 = File, 1 = Do Not File)

	  ---- Revision History ------------------------------------------------

	  08/07/02 - KESTELMANN - 43583
		     PSL conversion.
		     This procedure will be obsoleted later. It was converted
		     to PSL because the process is still supported in native
		     Profile. Also, some of the converted procedures are still
		     building an UX array and all these procedures will be
		     cleaned up during the second phase of the PSL conversion
		     project.

	  10/23/00 - Allan Mattson - 42428
		     Eliminated calls to PBSCLI.  These calls were executed on
		     a front-end processor (FEP or "native" client).  Starting
		     in V6.3, this UI is no longer supported by P/A.


	*/

	if ttx.getPointer() do FILE(ttx,1) quit
 
	do FILE(,1)

	quit


public FSSP(RecordTTX ttx)
	/*

	External line tag called when: operating from a front end, integrity
	check should be skipped, and in modify mode (normally when there is
	only one page involved or when UX array is not defined).

	Arguments:
 
		.  ttx  Transaction Object      /TYP=RecordTTX/NOREQ/MECH=REF
 
	Input:
		CID - Loan Account Number

	*/
	new FSSP
	set FSSP=1

	if ttx.getPointer() do FILE(ttx,0) quit

	do FILE(,0)

	quit


public SKIPIC(RecordTTX ttx)	

	/*
	 External line tag called when one account is filed and the integrity
	 check should be skipped.

	Arguments:

		.  ttx  Transaction Object      /TYP=RecordTTX/NOREQ/MECH=REF
 
	Input:
		CID - Loan Account Number			/TYP=N/REQ/MECH=VAL
		UX  - Array of changes made to account values	/TYP=T/NOREQ/MECH=VAL 
	*/

	if ttx.getPointer() do FILE(ttx,0) quit
	
	do FILE(,0)

	quit


public FILE(RecordTTX ttx,CTL)	

	/*
	Call Loan Filer program to update.
 
	Arguments:
		.  CTL - Control variable 	/TYP=N/REQ/MECH=VAL
		.  ttx  Transaction Object      /TYP=RecordTTX/NOREQ/MECH=REF 
	Input:
		CID - Loan Account Number			/TYP=N/REQ/MECH=VAL
		UX -  Array of changes made to account values	/TYP=T/NOREQ/MECH=VAL 
	*/

	new DI,VAL

	type RecordLN ln=Db.getRecord("LN","CID",1)

	// Account does not exist.
	if ln.getMode()=0 do Runtime.setErrMSG("LN",57) quit

	// Account exists.
	do ln.setAuditFlag(1)
 
	// Replace the old value in the object to the new one from UX array.
	set DI=""
	for  set DI=$O(UX("LN",DI)) quit:DI=""  do { quit:ER
 
		// New (Changed) Value Of Data Item
		set VAL=$P($G(UX("LN",DI)),"|",2)
		set ln.@DI=VAL
 
		}
	
	// Do integrity check before update
	if $E(CTL) do ln.save() quit:ER

	// Update the record without integrity check
	if '$E(CTL) do ln.bypassSave() quit:ER
		
	/*
	If transaction were generated as part of file maintenance,
	file the transaction.
	*/

	// if ttx.getPointer(),ttx.etc'="FM" do TRNUPD^TRNSDRV(.ttx)

	kill LN,OV,UX("LN"),V,X,COL,COLL,%TAB,%SCRID,PMTPI 
	kill NV,NF,ND,NO,PV,PF,PO,DE,HIST,DTJFM,KN 
	quit

public DFT	// Handle node 49 and default indicator

	quit
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43535^Sanchez SCM Administrator^3346"	// Signature - LTD^TIME^USER^SIZE
