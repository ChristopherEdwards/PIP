private FORMDQ2B(Number OPT)	// Option
		 
	/*
	Define OOE function dispatch table

	---- Revision History -------------------------------------------------
	05/23/06 - RussellDS - CR20967
		   Converted to PSL.

	-----------------------------------------------------------------------
	*/

	if (OPT = 2) do {
		
		do DEFINE^FORMDEF("LOAD D LOAD^FORMDQ2($G(SID))")
		do DEFINE^FORMDEF("SAVE S SAVE=$$SAVE^FORMDQ2(SID)")
		do DEFINE^FORMDEF("EXIT D EXIT^FORMDQ2C(SID)")
		do DEFINE^FORMDEF("BACKUP D BACKUP^FORMDQ2C(SID)")

		do DEFINE^FORMDEF("SCR_DATA D ^FORMVAR()")
		do DEFINE^FORMDEF("SCR_OBJ D ^FORMVAR("""",1)")
		do DEFINE^FORMDEF("SCR_VAR D ^FORMVAR("""",2)")
		do DEFINE^FORMDEF("SCR_EXP D ^FORMVAR("""",3)")
		do DEFINE^FORMDEF("SCR_QL D QL^FORMDQ2C()")
		do DEFINE^FORMDEF("SCR_DEF D ^FORMDQ2C($G(SID))")
		do DEFINE^FORMDEF("SCR_FUNC D FUNC^FORMDQ2C(SID)")

		do DEFINE^FORMDEF("FRAME D ^FORMFRM($G(RHTMAR))")

		do key("KPE" , 0, "SCR_DEF")
		do key("KP0" , 0, "SCR_FUNC")
		do key("PF2" , 0, "SCR_DATA")
		do key("KPE",1,"SCR_QL")
		
		do MAP
	}
	else  if (OPT = 5) do {

		do DEFINE^FORMDEF("BACKUP D BACKUP^FORMDQ5C")
		do DEFINE^FORMDEF("LOAD K M D LOAD^FORMDQ5("""",1)")
		do DEFINE^FORMDEF("SAVE S SAVE=$$SAVE^FORMDQ5()")
		do DEFINE^FORMDEF("EXIT D EXIT^FORMDQ5C")

		// Regular data item [fid]di, variable <<VAR>>, functions @FUN

		do DEFINE^FORMDEF("RW_DATA D ^FORMVAR()")

		// Other object types: Variable, Function, Marker, Report Header

		do DEFINE^FORMDEF("RW_OBJ D ^FORMVAR("""",1)")
		do DEFINE^FORMDEF("RW_FUN D ^FORMVAR("""",2)")
		do DEFINE^FORMDEF("RW_VAR D ^FORMVAR("""",3)")
		do DEFINE^FORMDEF("RW_MATH D ^FORMVAR("""",4)")
		do DEFINE^FORMDEF("RW_MARK D ^FORMVAR("""",5)")
		do DEFINE^FORMDEF("RW_HDR D ^FORMVAR("""",6)")

		do DEFINE^FORMDEF("RW_QL D QL^FORMDQ5C()","OPTION")
		do DEFINE^FORMDEF("RW_DEF D DEF^FORMDQ5C()")
		do DEFINE^FORMDEF("RW_FUNC D FUNC^FORMDQ5C()")
		do DEFINE^FORMDEF("RW_COM D COMMAND^FORMDQ5D()")

		do key("KPE", 0, "RW_DEF")
		do key("KP0", 0, "RW_FUNC")
		do key("PF2", 0, "RW_DATA")
		do key("KP0", 1, "RW_COM")
		do key("KPE", 1, "RW_QL")
		
		do MAP
	}
	
	quit


MAP
	/*
	Assign same key function for both system
	*/

	do DEFINE^FORMDEF("EXPORT D EXPORT^FORMEXCH()")
	do DEFINE^FORMDEF("SEL_FORM D SELALL^FORMSEL(3)")

	do key^FORMINST("KP.", 1, "SAVE")
	do key^FORMINST("KP.", 0, "EXIT")
	do key^FORMINST("F20", 0, "COMMAND")
     
	quit
	
	
key(String KEY,
    Boolean GOLD,
    String COMMAND)

	/*
	Create local key() command table
	*/
	
	type public String key()
	
	if GOLD set key("*"_KEY) = COMMAND
	else  set key(KEY) = COMMAND
	
	quit

vSIG()	quit "60425^3057^Dan Russell^2476"	// Signature - LTD^TIME^USER^SIZE
