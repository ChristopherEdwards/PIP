XSGNCRDF	  /*
ORIG: MYERSK - 09/19/2001
DESC: Remove Obsolete XSGNCRD entries

---- Comments --------------------------------------------------------

	This is a one-time fix to remove extraneous entries from XSGNCRD.
	XSGNCRD is now defined as a true index on DEP and LN.
	This will prevent extraneous entries from being created in the future.

---- Revision History ------------------------------------------------
  */
	new acn,CID,PSGNCRDR,OSGNCRDC,rs,SGNCRD,SJD
 
	type ResultSet rs=Db.select("SJD,SGNCRD,OSGNCRDC,PSGNCRDR,CID","XSGNCRD",,"SJD DESC")
	quit:rs.isEmpty()
	for  quit:'rs.next()  do {
		set SJD=rs.getCol(1)
		set SGNCRD=rs.getCol(2)
		set OSGNCRDC=rs.getCol(3)
		set PSGNCRDR=rs.getCol(4)
		set CID=rs.getCol(5)
 
		type RecordACN acn=Db.getRecord("ACN","CID")

		if +SGNCRD'=+acn.sgncrd do DELETE quit
		if +OSGNCRDC'=+acn.osgncrdc do DELETE quit
		if +PSGNCRDR'=+acn.psgncrdr do DELETE quit
		if SJD<acn.sgncrdchgdt do DELETE quit

		set acn.sgncrdchgdt=SJD
		do acn.bypassSave()
	}
	quit
 
	//---------------------------------------------------------------
DELETE  /* Delete XSGNCRD entry
	---------------------------------------------------------------*/
	do Db.fastDelete("XSGNCRD","SJD,SGNCRD,OSGNCRDC,PSGNCRDR,CID")
	quit
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43631^Sanchez SCM Administrator^1195"	// Signature - LTD^TIME^USER^SIZE
