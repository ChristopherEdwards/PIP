ZLETTERU ; Procedure ZLETTERUTL - Utilities for ZLETTER
 ;;Copyright(c)2005 Sanchez Computer Associates, Inc.  All Rights Reserved - 07/29/05 12:34 - entressr
 ;
 ; **** This is a DATA-QWIK generated routine (level 25) ****
 ;
        quit
 
        //-------------------------------------------------------------
FILE(CID,XLETCD,XSEQ,XREC)     //
        //-------------------------------------------------------------
 
        new zletter
        type RecordZLETTER zletter=Class.new("RecordZLETTER")
 
        set zletter.tjd=Db.getOneRow("TJD","CUVAR")
        set zletter.cid=CID
        set zletter.letcd=XLETCD
        set zletter.seq=+XSEQ
        set zletter.record=XREC
 
 
        do zletter.bypassSave()
 
        quit
 
 
        //----------------------------------------------------------------
HEADER(TYP,XLETCD,XSEQ,XCID,XACN)      //
        //----------------------------------------------------------------
 
        new BANK,FILL,STCODE,XTYP
        set BANK=Db.getOneRow("CO","CUVAR")
	set BANK=$E($$BLK^ZFIL(BANK,8),1,8)
        set FILL=$$BLK^ZFIL("",26)
        set XACN=+XACN
 
        set STCODE=Db.getOneRow("MSTATE","CIF","XACN")
        set STCODE=$$BLK^ZFIL(STCODE,4)
        if $L(XCID)'=12 set XCID=$$ZERO^ZFIL(XCID,12)
        set XACN=$$ZERO^ZFIL(XACN,12)
 
        set XSEQ=$$ZERO^ZFIL(XSEQ,3)
        set XTYP=$$ZERO^ZFIL(TYP,4)_" "
        quit BANK_XTYP_XLETCD_XSEQ_"TRN"_XACN_XCID_"00000000"_FILL_STCODE
 
        //----------------------------------------------------------------
ADDR(XACN)     // Address from CIF table
        //----------------------------------------------------------------
 
        new cif,MAD1,MAD2,MAD3,MCITY,MSTATE,MZIP,NAM
 
        type RecordCIF cif=Db.getRecord("CIF","XACN")
 
        set NAM=$$BLK^ZFIL(cif.nam,40)
        set MAD1=$$BLK^ZFIL(cif.mad1,40)
        set MAD2=$$BLK^ZFIL(cif.mad2,40)
        set MAD3=$$BLK^ZFIL(cif.mad3,40)
        set MCITY=$$BLK^ZFIL(cif.mcity,20)
        set MSTATE=$$BLK^ZFIL(cif.mstate,2)
        set MZIP=$$BLK^ZFIL(cif.mzip,10)
 
        quit NAM_MAD1_MAD2_MAD3_MCITY_MSTATE_MZIP
 
        //----------------------------------------------------------------
AADDR(XCID)      // Address from ACNADDR table
        //----------------------------------------------------------------
 
        new addr,MAD1,MAD2,MAD3,MCITY,MSTATE,MZIP,NAM
        type RecordACNADDR addr=Db.getRecord("ACNADDR","XCID")
 
        set NAM=Db.getOneRow("TITLE1","ACN","XCID")
        set NAM=$$BLK^ZFIL(NAM,40)
        set MAD1=$$BLK^ZFIL(addr.ad1,40)
        set MAD2=$$BLK^ZFIL(addr.ad2,40)
        set MAD3=$$BLK^ZFIL(addr.ad3,40)
        set MCITY=$$BLK^ZFIL(addr.city,20)
        set MSTATE=$$BLK^ZFIL(addr.state,2)
        set MZIP=$$BLK^ZFIL(addr.mzip,10)
 
        quit NAM_MAD1_MAD2_MAD3_MCITY_MSTATE_MZIP

vSIG()	quit "59886^43632^Sanchez SCM Administrator^2502"	// Signature - LTD^TIME^USER^SIZE
