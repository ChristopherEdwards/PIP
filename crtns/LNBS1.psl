public LNBS1
        /*
               ORIG:
          CALLED BY:
              CALLS:  ^SCAIO,^UACN,^USID,^UTLERR,^UTLREAD
           PROJ #'S:
               DESC:
 
 
              INPUT:
             OUTPUT:
 
          ---- Revision History----------------------------------------------

	   07/31/06 - KELLYP - CR 22048
	   	      Modified VPG00 section to eliminate PRECEDENCE warning.

  	   04/14/05 - JERUCHIMC - 14822
                      Fetched from v70dev

           09/18/02 - KESHAVANN - 49451
                      Converted to PSL
          
	---------------------------------------------------------------------
        */
        
        do UPD
        
        quit

public UPD     //
        do INIT(1)
        quit
 
 
public STS     //
        do INIT(2)
        quit
 
 
INIT(%ProcessMode)      //
        new VFMQ
        type RecordLN LN
        set %PG=0
        set %PAGE=1
        do VPG(.LN)
        quit
 
VPG(RecordLN LN)        // Page control
        new FINISH
        set FINISH=0
        for  do { quit:FINISH
                if %PG=0 do VPG00(.LN) if ER set FINISH=1 quit
                if %PG>0 do VPG01(.LN)
 
                if "DFQ"[VFMQ set FINISH=1 quit
                set %PG=%PG+1
                }
        quit
 
VPG00(RecordLN LN)      // Set up
 
        set %TAB("CID")=".CID3/XPP=S %EXT=1 D ^UACN"
        set (CLS,ZCLS)="L"
 
        set %TAB("IO")=$$IO^SCATAB($I)
 
        set %READ="@@%FN,,,CID/REQ,IO/REQ"
 
        do ^UTLREAD
 
        if VFMQ="Q" set ER=1 quit     
	if IO'=$I do OPEN^SCAIO
 
        if ER quit
        set I=1
        type DbSet rs=Db.selectDbSet("LNBIL1","CID=:CID","SCHSEQ DESC")
        while rs.next() do {
                type RecordLNBIL1 flnbil1=rs.getRecord("LNBIL1")
                set $P(fLNBS1(I),"|",1)=flnbil1.schseq
                set $P(fLNBS1(I),"|",2)=flnbil1.cirn
                set $P(fLNBS1(I),"|",3)=flnbil1.cdpd
                set $P(fLNBS1(I),"|",4)=flnbil1.ctab
                set $P(fLNBS1(I),"|",5)=$$INT(.flnbil1)
	        set a=flnbil1.cdib
                set $P(fLNBS1(I),"|",6)=flnbil1.cdib
                set $P(fLNBS1(I),"|",7)=flnbil1.copb
                set $P(fLNBS1(I),"|",8)=flnbil1.coia
                set $P(fLNBS1(I),"|",9)=flnbil1.cirn
                set $P(fLNBS1(I),"|",10)=flnbil1.casd
                set $P(fLNBS1(I),"|",11)=flnbil1.cpib
                set $P(fLNBS1(I),"|",12)=flnbil1.cpid
                set I=I+1
                }
  
	set %REPEAT=5
        set CNT=I-1
        set %PAGE=('(CNT#%REPEAT=0))+(CNT\%REPEAT)
 
        // No payment records on file
        if 'CNT do {
                set ER="W"
                set RM=$$^MSG(1969)
                set VFMQ="Q"
                }
        quit
 
INT(RecordLNBIL1 flnbil1)       //
        if flnbil1.PE01="" quit ""
        if flnbil1.PE01EA="I" quit flnbil1.pe01ab
        if flnbil1.PE02="" quit ""
        if flnbil1.PE02EA="I" quit flnbil1.PE02AB
        if flnbil1.PE03="" quit ""
        if flnbil1.PE03EA="I" quit flnbil1.PE03AB
        if flnbil1.PE04="" quit ""
        if flnbil1.PE04EA="I" quit flnbil1.PE04AB
        if flnbil1.PE05="" quit ""
        if flnbil1.PE05EA="I" quit flnbil1.PE05AB
        if flnbil1.PE06="" quit ""
        if flnbil1.PE06EA="I" quit flnbil1.PE06AB
        if flnbil1.PE07="" quit ""
        if flnbil1.PE07EA="I" quit flnbil1.PE07AB
	if flnbil1.PE08="" quit ""
        if flnbil1.PE08EA="I" quit flnbil1.PE08AB
        if flnbil1.PE09="" quit ""
        if flnbil1.PE09EA="I" quit flnbil1.PE09AB
        if flnbil1.PE10="" quit ""
        if flnbil1.PE10EA="I" quit flnbil1.PE10AB
	if flnbil1.PE11="" quit ""
        if flnbil1.PE11EA="I" quit flnbil1.PE11AB
        if flnbil1.PE12="" quit ""
        if flnbil1.PE12EA="I" quit flnbil1.PE12AB
	if flnbil1.PE13="" quit ""
 	if flnbil1.PE13EA="I" quit flnbil1.PE13AB
        if flnbil1.PE14="" quit ""
        if flnbil1.PE14EA="I" quit flnbil1.PE14AB
        if flnbil1.PE15="" quit ""
        if flnbil1.PE15EA="I" quit flnbil1.PE15AB
        if flnbil1.PE16="" quit ""
        if flnbil1.PE16EA="I" quit flnbil1.PE16AB
        if flnbil1.PE17="" quit ""
        if flnbil1.PE17EA="I" quit flnbil1.PE17AB
        if flnbil1.PE18="" quit ""
        if flnbil1.PE18EA="I" quit flnbil1.PE18AB
        if flnbil1.PE19="" quit ""
        if flnbil1.PE19EA="I" quit flnbil1.PE19AB
        if flnbil1.PE20="" quit ""
        if flnbil1.PE20EA="I" quit flnbil1.PE20AB
        quit

VPG01(RecordLN LN)      // Screen
        set %REPEAT=5
        set %MODS=%PG*5-4
        if %REPEAT+%MODS>CNT set %REPEAT=CNT-%MODS+1
        set LN=Db.getRecord("LN","CID=:CID")
 
        do DRV^USID(%ProcessMode,"LNBS1",.LN)
 
        quit
 
 
END     //
        kill %TAB
        quit
 #OPTION ResultClass ON
Public String vSIG()	quit "60477^65448^Pat Kelly^4585"	// Signature - LTD^TIME^USER^SIZE
