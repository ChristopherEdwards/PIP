UTSRVITM	 /*
    ORIG: GRAY - 01/13/2000
    DESC: Service Item ID Maintenance
    
    ---- Comments --------------------------------------------------------
    
    ---- Revision History ------------------------------------------------

	05/10/05 - KELLYP - CR 15872
		   Removed reference to SRVCHKSELL screen which was 
		   obsoleted and modified entire procedure to conform 
		   to current PSL standards.  Also removed GENNAME
		   section (code was incorporated into MSRVITM) and
		   removed pre-2003 revision history.
 */

	quit


public PP
	/*
	Verify if the prompt contains "#" or "~"
	SRVCAT,SRVTYP,SRVLOC,SRVID are used in TSO and should't contain 
	these characters. This should be done when creating a category, 
	type or location.
	
	Input 	X - Variable to test
	*/

	type public Boolean ER
	type public String X

	// May not enter ~p1 characters
	if X["#" do Runtime.setErrMSG("SRVITM","1700","#") quit:ER
	if X["~" do Runtime.setErrMSG("SRVITM","1700","~") quit:ER
	
	quit


public FILE	// File data

	// Called by ^MSRVITM,^SRVITMBL,^SRVITMTR,^UTSRVCHK
	
	type public Boolean DASGNFLG
	type public String SRVCAT,SRVID,SRVLOC,SRVTYP
	
	type RecordSRVITM srvitm=Db.getRecord("SRVITM","SRVCAT,SRVTYP,SRVLOC,SRVID",1)

	// De-assign Service Item	
	if DASGNFLG.get() set srvitm.srva=0
	
	do srvitm.save()
	
	quit
	
	
public CMPTFDA(Number FEE,Date NDDT,Date LDDT)	// Compute - Per Diem Amount [SRVITM]SRVFDA
	/*
	Arguments:
	   .  FEE    Service Fee Amount  [SRVITM]FEE
	   .  NDDT   Next Billing Date   [SRVITM]NDDT
	   .  LDDT   Last Billing Date   [SRVITM]LDDT
	
	Calculation:  Service Fee Amount/Number of Days in the Period
	                 
	    Where: 
	    Number of Days in Period:   Next Billing Date-Last Billing Date
	
	Returns:
	    .  $$  Per Diem Amount      /TYP=$
	
	       Conditions: 
	       -  If Number of Days in the Period is zero or less than zero
	          null value will be returned    
	*/
	
	type Number DYSINPRD,SRVFDA
	
	set DYSINPRD=NDDT-LDDT
	if DYSINPRD>0 set SRVFDA=FEE/DYSINPRD
	
	quit SRVFDA.get()

	
public SRVLOC  // Location Table for query for Service Item Location creation

	type public Boolean ER	
	type public String SRVCAT,X
	
	type RecordUTBLSRVCAT usrvcat=Db.getRecord("UTBLSRVCAT","SRVCAT",1)
	
	// Invalid branch code
	if '$$EXIST^DBSEDIT(usrvcat.table,X) do Runtime.setErrMSG("UTBLSRVCAT","1273") quit:ER
	
	quit

vSIG()	quit "60033^40481^Pat Kelly^2276"	// Signature - LTD^TIME^USER^SIZE
