LNLCMET(%ProcessMode)	//;PBS - LN - V3.0 - LATE CHARGE METHODS
	/*
	  ---- Revision History ------------------------------------------------
	
	  04/11/05 - Hillanbrand - 13281
	             Corrected various errors found in DBI2 UT.	
		
	  08/21/02 - TELIV - 49451
      	  	     Converted to PSL	 				
    	  ---------------------------------------------------------------------
	*/
	

	set %PG=0
	set %PAGE=1
	type RecordLNPOPT fLNPOPT
	do VPG(.fLNPOPT)

	quit


VPG(RecordLNPOPT fLNPOPT)	// Page control
      new FINISH
      set FINISH=0
      for  do { quit:FINISH=1

	if %PG=0 do VPG00 if ER!("DFQ"[VFMQ) set FINISH=1 quit

	if %PG>0 do VPG01(.fLNPOPT)

	if "DFQ"[VFMQ do VER(.fLNPOPT) set FINISH=1 quit

	set %PG=%PG+1
	}
	quit


VPG00	// Set up
	set %TAB("GRP")=".LPG/TBL=[STBLGRP]GRP:DISTINCT:QU ""[STBLGRP]CLS=L"""
	if '%ProcessMode set %TAB("POPT")=".POPT2/TBL=[LNPOPT]POPT:NOVAL:DISTINCT:QU ""[LNPOPT]GRP=<<GRP>>""/XPP=if $$POPT^LNLCMET(GRP,X) set ET=""LNONFIL"" do ERR^LNLCMET"
	if %ProcessMode set %TAB("POPT")=".POPT2/TBL=[LNPOPT]POPT:DISTINCT:QU ""[LNPOPT]GRP=<<GRP>>"""
	set %READ="@@%FN,,,GRP/REQ,POPT/REQ"

	do ^UTLREAD

	quit


POPT(GRP,X)	//Check Whether Record Exists
        new cnt
	set cnt=""
        set cnt=Db.isDefined("LNPOPT","GRP=:GRP,POPT=:X")
        quit cnt


VPG01(RecordLNPOPT fLNPOPT)	// Screen
	set fLNPOPT=Db.getRecord("LNPOPT","GRP=:GRP,POPT=:POPT",1)
	do fLNPOPT.setAuditFlag(1)
	
	do DRV^USID(%ProcessMode,"LNPOPT",.fLNPOPT)
	
	quit


ERR	//
	
	set ER=1 
	
	do ^UTLERR
	
	set VFMQ="Q"
	quit


VER(RecordLNPOPT fLNPOPT)	//	
	
	if %ProcessMode=2!(%ProcessMode=4)!(VFMQ="Q") do END quit
	do FILE(.fLNPOPT)
	
	do END
	
	quit


FILE(RecordLNPOPT fLNPOPT)	// File data

	do fLNPOPT.save()
	quit


END	//	
	kill %TAB lock 
	if ER!(%ProcessMode=2)!(%ProcessMode=4) quit
	set POPT=$G(POPT)

	if VFMQ="Q" do {

		// Method ~p1 not created
		if %ProcessMode=0 set RM=$$^MSG(1725,POPT) quit
		
		// Method ~p1 not modified
		if %ProcessMode=1 set RM=$$^MSG(1727,POPT) quit
		
		// Method ~p1 not deleted
		set RM=$$^MSG(1726,POPT)
		}
	else  do {
		
		// Method ~p1 created
		if %ProcessMode=0 set RM=$$^MSG(1722,POPT) quit
		
		// Method ~p1 modified
		if %ProcessMode=1 set RM=$$^MSG(1724,POPT) quit
		
		// Method ~p1 deleted
		set RM=$$^MSG(1723,POPT)
		}
	set ER="W"
	quit
	
 #OPTION ResultClass ON
Public String vSIG()	quit "60001^43736^Laura Hillanbrand^2131"	// Signature - LTD^TIME^USER^SIZE
