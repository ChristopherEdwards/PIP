MLTEOD3(DATE,CLS,TYPE,CHGNUM1)	// Template code for batch file maintenance
	/*
	PROCEDURE:  MLTEOD3
	ORIG: Tom Locke - 03/17/87
	DESC: Batch file maintenance updates template

	---- Comments --------------------------------------------------------

	This procedure is never run independently.  It is used as a template
	by MLTEOD1 for the compilation of the batch file maintenance update
	procedures.

	Comments that are of the form //*... are indicators to MLTEOD1 as
	to where to place code.

	General process is to get a record ID using a generated result set,
	call PROCREC to instantiate the record and call query and update
	sections for each set of changes.  All updates will be applied
	then a save of the record reflecting the net changes.

	Errors within a record will log and process will continue with next
	record.

	ARGUMENTS:
		. DATE		Date key for DAYENDBFM	/TYP=D/REQ/MECH=VAL

		. CLS		Class key for DAYENDBFM	/TYP=T/REQ/MECH=VAL

		. TYPE		Type key for DAYENDBFM	/TYP=N/REQ/MECH=VAL

		. CHGNUM1	Change number key for	/TYP=N/REQ/MECH=VAL
				first change number in
				DAYENDBFM

	RETURNS:
		. ER		Error flag	/TYP=L

		. RM		Error message	/TYP=T

 	---- Revision History ------------------------------------------------
 	
 	05/24/05 - RussellDS - CR16071
		   Converted M TP commands to PSL Runtime methods.
		   
		   Removed old revision history.

	01/14/05 - ARPAVC 13861
		   Fixed compile errors and miscellaneous issues.  
		   - Properly scoped all variables
	*/

	// Catch GT.M errors
	catch error {
		type Public Boolean ER
		type Public String RM
		
		do ZE^UTLERR
		set ER=1
		}

	// Instantiate DAYENDBFM record to update LASTREC field
	type RecordDAYENDBFM debfm=Db.getRecord("DAYENDBFM","TJD=:DATE,CLS=:CLS,TYPE=:TYPE,CHGNUM=:CHGNUM1,SEQ=1")
	
	//*result_set - add result set code above here
	
	quit


PROCREC(RECID,RecordDAYENDBFM debfm)	// Process single record

	type Public Boolean ER
	type Public String RM

	// Catch GT.M errors but continue with next record
	catch error {
		new ET,%ZTSEQ
		do ZE^UTLERR
		set ER=1
		//Error Log Sequence #~p1
		if $D(%ZTSEQ) set %ZTSEQ=$$^MSG(3389,%ZTSEQ)
		// Error in account, not processed
		set ET=$$^MSG(3511)
		// Log error in exception file
		// End of Day Product Type Changes
		do LOG^UTLEXC($T(+0),"*",$$^MSG(4540),"",$G(%ZTSEQ),ET)
	}

	new UID,TLO			// Will be set in generated code

	do Runtime.start("BA")

	//*procrec - add record loading and calls to queries and updates above

	set debfm.lastrec=RECID
	do debfm.bypassSave()

	do Runtime.commit()

	quit

	//*queries - add queries above here

	//*updates - add updates and saves above here

vSIG()	quit "60044^75080^Dan Russell^2455"	// Signature - LTD^TIME^USER^SIZE
