MRPC094(return,versn,CID,PTY,APCND,GRP)
        /*
        Procedure ID: MRPC094

        DESC:New procedure to do Off-Cycle Escrow Analysis based on 
	     Loan account.  


        KEYWORDS: RPC,Off-Cycle Escrow Analysis
 
        ARGUMENTS:
		. return	/TYP=N/REQ/MECH=REFNAM
 
		. versn		/TYP=N/REQ/MECH=VAL
        	                 current version=1
		. CID		Acount number

		. PTY		Product Type

		. APCND		Escrow Analysis Point Changed Next Date

		. GRP		Product Type Group
        RETURNS:
		. $$      Error Message                 /TYP=T
                          Null= No Error
		. RETURN               
                                
        RELATED:
		. $$^PBSMRPC - MRPC Service Class Driver
 
        EXAMPLE:
                S RM=$$^MRPC094(.return,versn,CID,PTY,APCND,GRP)


 
	---- Revision History-------------------------------------------------------------           01/24/00 - Spier -31126

	12/17/02 - Varsha Malhotra - 47547
		   Added code to exit with appropriate error messages when
		   MRPC=1. 

	03/10/00 - BECKEYW - 35870

		   Changed code to use MRPC line tage.  Also set CTL = 1	


	*/ 
        //----------------------------------------------------------------------
	// Version number of client message is not compatible with server
	if $G(versn)'=1 quit $$ERRMSG^PBSUTL($$^MSG(2951))

	new CNTESC,CTL,EFD,FLG,LCID,MRPC,OPT,str
	
	if $G(CID)="" set return=""		
	if $G(PTY)="" set return=""		
	if $G(APCND)="" set return=""
	if $G(GRP)="" set return=""
	set CNTESC=0
	set CTL=1	
	set OPT=4	//Analyze by Loan Account
	set MAX(4)=CID
	set EFD=$$DSJD^SCADAT(APCND)  //Pass in date to get julian date format

	set MRPC=1
	do MRPC^LNEABOC

	// Account in analysis, Off-cycle analysis not conducted
	if ER=1 set RM=$$^MSG(4070) quit $$ERRMSG^PBSUTL(RM)
	
	//Analysis has already been posted
	if FLG set RM=$$^MSG(5195) quit $$ERRMSG^PBSUTL(RM)

	if $G(ER)=0 set str=1
	else  set str=0
	set return=$$V2LV^MSG(str)
	quit ""

        //-----------------------------------------------------------------
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43589^Sanchez SCM Administrator^1913"	// Signature - LTD^TIME^USER^SIZE
