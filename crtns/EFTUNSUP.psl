EFTUNSUP		/*
	  DESC: Reprocess Suppressed Collection Orders

	  This routine will provide institutions with the ability to reprocess
	  payment/collection orders that have been suppressed.

	  When institutions run this function, they will identify the
	  account number and the order's sequence number.  The system will
	  perform an edit check to confirm that the order has a status of 
	  "SUP" (Suppressed).  If the order does not have a status of "SUP"
	  the system will return the following error message:

	  Function can only be run with Suppressed status

	  If the order does have a status of "SUP", the function will modify
	  the order to be processed on the next dayend, with a status of "A"
	  (Added) and the Override Stop set to "Y".  Therefore, when a
	  collection order is processed, the system will bypass the Collection
	  Order Stop Type functionality and process the collection order as 
	  normal. 

	  ---- Revision History -----------------------------------------------

	  06/13/02 - SIGDAE - 50866
		Removed code that inserted a record directly into DAYENDEFT.

		Removed older revision history
	*/

	// Prompt for EFTPAY account number and sequence
	set EFTQRY="[EFTPAY]CID=<<CID>>"
	set %TAB("CID")=".CID1/XPP=D POSCID^EFTUNSUP"
	set %TAB("SEQ")="[EFTPAY]SEQ/TBL=[EFTPAY]:QU EFTQRY/XPP=D POSSEQ^EFTUNSUP"
	set %READ="@@%FN,,,CID/REQ,SEQ/REQ"
	do ^UTLREAD
	if VFMQ="Q" quit

	/*
	 Update Status to 'A'dded.  EFTPAY BEFORE_STATUS trigger will
	 then update EFD and PROCDT if required.
	*/
	type RecordEFTPAY eftpay

	set eftpay=Db.getRecord("EFTPAY","CID,SEQ")
	do eftpay.setAuditFlag(1)

	set eftpay.status="A"
	set eftpay.ovstop=1  
	do eftpay.save()

	quit


POSCID  // Account number post-processor
	set %EXT=1 do ^UACN I ER S CID=""

	quit


POSSEQ  // Sequence number post-processor

	type RecordEFTPAY eftpayck

	// Sequence does not exist
	if 'Db.isDefined("EFTPAY","CID,X") set ER=1,RM=$$^MSG(7227) quit

	set eftpayck=Db.getRecord("EFTPAY","CID,X")

	// Function can only be run with Suppressed status
	if eftpayck.status'="SUP" S ER=1,RM=$$^MSG(4005) quit

	quit
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43515^Sanchez SCM Administrator^2021"	// Signature - LTD^TIME^USER^SIZE
