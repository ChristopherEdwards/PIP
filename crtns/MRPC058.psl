MRPC058(return,versn,cid,base,pmtdat,baseamt)	// Public; Linked fee
	/*
	   ORIG: GORMAN - 05/01/97

	   Calculate linked fee changes when top level fee amount changes.
	   Used, for example, with client payment record maintenance
	   functions.

	   KEYWORDS:	 Client/Server, Loan Utilities

	   ARGUMENTS:

	  	 . return	 Payment record detail

	  	 . versn 	 ^MRPC057 version number 	 /TYP=N/REQ
	    			 Current version = 1 		 /MECH=VAL

	  	 . cid 		 Account number  		 /TYP=N/REQ
	        						 /MECH=VAL

	  	 . base 	 Base element  			 /TYP=T/REQ
	        						 /MECH=VAL

	  	 . pmtdat	 Payment due date 		 /TYP=D/REQ
	        						 /MECH=VAL

	  	 . baseamt	 Base amount.  In payment	 /TYP=D/REQ
	    			 record maintenance functions,	 /MECH=VAL
	    			 this is the amount to which
	    			 the user changes the base
	    			 element.


	   RETURNS:
	  	 . $$ 		 Error message  		 /TYP=T
	    			 Null = No error

	  	 . return	 Linked fee amounts (not deltas) in the
	    			 following structure:

	    			 linked_fee <<tab>> amount <<CrLf>>
	    			 linked_fee <<tab>> amount etc.


	   RELATED:
	  	 . $$^PBSMRPC - MRPC Service Class Driver

	   EXAMPLE:
	  	 Text of example (line one)

	  ---- Revision History ------------------------------------------------
	   11/04/02 - SRIVASTAVAN - 49794
		      Converted to PSL
	   11/06/01 - SKLYUTD - 47955
	       	      Modified call to the BASIS^LNFEEU to pass arguments in a
	              correct order.
	*/

	catch vERROR {
                new ET,RM
                set ET=vERROR.type
 
        	if ET["%GTM-" do { quit
        		do ZE^UTLERR
        		}
 
        	set ET=ET_"-"_vERROR.thrownAt
        	set RM=vERROR.description
        	do ^UTLERR
        	}
	
	// Version number of client message is not compatible with server
	if $G(versn)'=1 quit $$ERRMSG^PBSUTL($$^MSG(2951))

	new linkamt

	set cid=$G(cid)
	set base=$G(base)
	set pmtdat=$G(pmtdat)
	set baseamt=$G(baseamt)
	set return=""
	
	/*
	Pass client input to loan fee utility using following parameters:

	p1: Account number 		 Pass input parameter 'cid'
	p2: Payment due date		 Pass input parameter 'pmtdat'
	p3: Base element amount		 Pass input parameter 'baseamt'
	p4: Base element		 Pass input parameter 'base'
	p5: Control			 Pass null
	p6: Return array
	p7: Bill array		 	 Pass null
	p8: Computation method	 	 Limit to billing based fees (method 3)
	*/
	type RecordLN ln=Db.getRecord("LN","CID=:cid")
	
	do BASIS^LNFEEU(.ln,,cid,pmtdat,baseamt,base,,.linkamt,,3)

	if ER quit $$ERRMSG^PBSUTL($G(RM),$G(ET))
	
	set fee="" for  set fee=$O(linkamt(fee)) quit:fee=""  do {

		set return=return_fee_$C(9)_linkamt(fee)_$C(13,10)

		}

	set return=$$V2LV^MSG(return)

	quit ""
	
 #OPTION ResultClass ON
Public String vSIG()	quit "59886^43586^Sanchez SCM Administrator^2536"	// Signature - LTD^TIME^USER^SIZE
