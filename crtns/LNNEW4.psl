LNNEW4	 /* 
    ORIG: GRAY - 01/18/2000
    DESC: New Collateral Records
    
    ---- Comments --------------------------------------------------------
    
    ---- Revision History ------------------------------------------------
	11/11/05 - ARPAVC - 18183
		   Removed reference to LNCOLC and changed it to reference LNCOL
		   since the index table is being removed.
		   
		   Cleaned up PSL code to conform to standards and remove use 
		   of DBSDB as it is being obsoleted.  Replaced with 
		   dynamic select statement.
		   
        07/29/00 - ROYTENBERGG - 41319
                   Removed references GRP,COL in the beginning of section CDES.
                   GRP will be defined from ACN.GRP.
 
	12/21/99 - GRAY - 32507
		   Removed code no longer needed due to the Elimination
		   of Teller/Branch Character Interface and placed remaining
		   code into PSL'd procedure definition.
 */
	
	quit
	
	
Public CDES( Number CSEQ, Number CID)	// Collateral record description 
	
	if CSEQ="" quit ""

	type Number I
	type String COL,RET,RETCOL,V
	
	set CID=CID.get()
	if CID="" do {
		type ResultSet rs 
		set rs=Db.select("CID","LNCOL","COLL=:CSEQ","CID ASC")
		if 'rs.next() quit
		set CID=rs.getCol("CID")
                }
                
        if CID="" quit ""
		
	type RecordACN acn=Db.getRecord("ACN","CID=:CID")
	if acn.grp="" quit ""
		
	type RecordCOL col=Db.getRecord("COL","COLL=:CSEQ")
	if col.scolcd="" quit ""
	
	type RecordUTBLCOLCD ucolcd=Db.getRecord("UTBLCOLCD","GRP=:acn.grp,KEY=:col.scolcd")
	set COL=ucolcd.pcs
	
	set RETCOL=""
	for I=1:1:COL.length(",") do {
		set V=COL.piece(",",I)
		if V.beginsWith("'"), V.endsWith("'") quit
		set RETCOL=RETCOL_","_V
		}
		
	// Include literal in desc.
	if 'RETCOL.beginsWith(",") quit COL.translate("'","")	
	
	set RETCOL=RETCOL.extract(2,RETCOL.length())

	// use dynamic select statement to retrieve columns
	#ACCEPT DATE=12/07/05; PGM=Vince Arpa
	type ResultSet rs1 = Db.select(RETCOL, "COL", "COLL=:CSEQ")
	set RETCOL=""
        if rs1.next() do {
		type Number I
		for I=1:1:COL.length(",") do {
			if I>1 set RETCOL=RETCOL_","
			set RETCOL=RETCOL_rs1.getCol(I)
        		}
		}

	set COL=RETCOL.translate(",'"," ")
	
	quit COL
 #OPTION ResultClass ON
Public String vSIG()	quit "60242^55093^Vincent Arpa^2116"	// Signature - LTD^TIME^USER^SIZE
