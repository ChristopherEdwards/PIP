UAVB2	 /*

ORIG: DOUGHERTYT - 09/26/2000
DESC: Computed Statement Values Status

---- Revision History ------------------------------------------------
	09/26/05 - ALAGARSS - CR 16677
		   Removed deprecated method Db.getOneRow and replaced with
		   Db.getRecord. 
	
	09/26/00 - Terrie Dougherty -42059
		   Restored line tags FDPP and ERR for UAVB2.

 */

Public FDPP	// History cut-off (purge)

	type Public Date %MSKD,OD,xod
	type Public Number CID
	type Public String ET,X
	type Public Boolean ER
	
	if X="" quit

	new cls,odt,hisctf

	type RecordACN acn=Db.getRecord("ACN","CID=:CID")
	set cls=acn.cls
	set odt=acn.odt
	set hisctf=acn.hisctf

	if cls="D" do {
		new dlr
		type RecordDEP dep=Db.getRecord("DEP","CID=:CID")
		set dlr=dep.dlr
		set OD=$S(dlr:dlr,1:odt)
		}

	else  do {
		new odd,revf
		type RecordLN ln=Db.getRecord("LN","CID=:CID")
		set odd=ln.odd
		set revf=ln.revf
		set OD=odd if revf,odt<OD set OD=odt
		}

	; Precedes opening date of ~p1
	if X<OD set ER=1 set xod=$$DAT^%ZM(OD,$G(%MSKD)) do Runtime.setErrMSG("ACN",2215,"xod") quit
	if hisctf,hisctf<X set ET="UAVB1" do ERR
	quit


ERR    
	type Public Boolean ER
	type Public String VFMQ
	 
	set ER=1 do ^UTLERR
        set VFMQ="Q"
        quit

vSIG()	quit "60193^26214^Sanjay Chhrabria^1157"	// Signature - LTD^TIME^USER^SIZE
