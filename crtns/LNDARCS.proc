LNDARCS ; Procedure LNDARCS - Single Acct Delinquency Reclassification
 ;;Copyright(c)2005 Sanchez Computer Associates, Inc.  All Rights Reserved - 08/09/05 10:33 - spatola
 ;
 ; **** This is a DATA-QWIK generated routine (level 25) ****
 ;
 /*
    ORIG: GRAY - 01/14/2000
    DESC: Single Acct Delinquency Reclassification
 
    ---- Comments --------------------------------------------------------
    
    ---- Revision History ------------------------------------------------
 
	08/14/03 - GRAY - 51351
		   Replaced sub-routine POSNPDT which had been removed in
		   error under ARQ# 32507.  This was originally reported
		   under CR #'s 5534 and 5536.

	08/08/01 - GRAY - 46859
		   Corrected undefined local variable error from occurring.
	
	12/21/99 - GRAY - 32507
		   Removed code no longer needed due to the Elimination
		   of Teller/Branch Character Interface and placed remaining
		   code into PSL'd procedure definition.

 */

	quit
	
	#WARN
	
Public NPDT	// Get exisitng DAYENDDARC Next posting dates. 
	// Called by reports SCA539 and SCA540 as well as LNDARC.M AND LNDARCS.M
	
	type String NPDT=""
	type Public String ZNPDT()

	type ResultSet rs=Db.select("NPDT","DAYENDDARC")	
	if rs.isEmpty() set ZNPDT(NPDT)="" quit

	// Reports SCA539 and SCA540 rely on array ZNPDT for possible report run dates
	while rs.next() do {
		set NPDT=rs.getCol("NPDT")
		set ZNPDT(NPDT)=""
		}
	
	set NPDT=ZNPDT("").order(-1)

	quit


Public POSNPDT(Date DATE)   //
	/*
	If TGL has been posted, bring up menu bar to continue
        Only Inquiry of Posting Date less than system date allowed.
        Creation, Modification, Deletion and Regeneration all must
        be for a posting date that is equal to or greater than
        than today's date.
	*/
        
	type Public Number %OSAVE,ER
	type Public String MSG,RM,YN

	// Date must be today or future
        if %OSAVE.get()'=2,DATE<%SystemDate set ER=1,RM=$$^MSG(6047) quit
        
	type RecordTGL1 tgl1=Db.getRecord("TGL1","TDT=:DATE,SRC=7",1)
	if tgl1.prcmp'="*" quit
        
	// General Ledger is posted" " Continue?
        set MSG=$$^MSG(730)_" "_$$^MSG(603)

	 // Menu bar. Yes No Quit
        set YN=$$^DBSMBAR(1)

        if YN'=1 set ER=1

        quit

vSIG()	quit "59886^43532^Sanchez SCM Administrator^1909"	// Signature - LTD^TIME^USER^SIZE
