ZPAUTHCM		/*
	 ORIG: JEFF - 02/16/2007
	 DESC: 
	
	 ---- Comments --------------------------------------------------------
	
	 ---- Revision History ------------------------------------------------
	
	 ****** Consider using setAuditFlag for all objects in this procedure
	   example :do dep.setAuditFlag(1)
	
	*/

	type ResultSet rs,rs1
	type String pgm,q,CODE,XAPP,XFID,XFILTER,XTEST

	set q=$C(34)
	set pgm="ZISO"
	do hdr(pgm)

	do add("Public AUTH()")
	
	set XFID="ZFILTER"
	set rs1=Db.select("DI","DBTBL1D","FID=:XFID AND REQ='N'")
	if 'rs1.isEmpty() while rs1.next() do {
                set XDI=rs1.getCol(1)
 
                set CODE=" set "_XDI_"="_XDI_".get()"
                do add(CODE)
        }	

	set rs=Db.select("FILTER,APPROVE,TEST","ZUTBLPAUTH",,"APPROVE DESC")
	if 'rs.isEmpty() while rs.next() do {
		set XFILTER=rs.getCol(1)
		set XAPP=rs.getCol(2)
		set XTEST=rs.getCol(3)

		set CODE=" if "_XTEST_" quit "_q_XAPP_"|"_XFILTER_q 
		do add(CODE)
	}
	
	do add(" quit 1")
	do CPGM(pgm,.m2src)
	quit

CPGM(pgm,String m2src)
 
        type String commands,mcode,ltags
        type public Boolean ER
        do main^UCGM(.m2src,.mcode,.ltags,,.commands) quit:ER
        write $$^MSG(3005,"",pgm),$$TIM^%ZM,!
        do ^DBSCMPF(pgm,.mcode)
        quit



hdr(pgm)	// Routine Header & Copyright message
 
        type String z
 
        do add(pgm_" ; Entrinsic Functions for LETTER")
        do ^SCACOPYR(.z),add(z)
        do add(" ;")
        do add(" ; ***********This is a Function generated routine***********")
        do add(" ;")
        do add(" ;    Run function @ZPAUTHCOM to generated this routine")
        do add(" ;")
        do add(" ; **********************************************************")
        do add(" ;")
	do add(" ;")
 
        quit

add(String x)
 
        type public String commands,mcode,ltags,m2src()
        type String n
        set n=m2src("").order(-1)+1
        set m2src(n)=x
        quit
 #OPTION ResultClass ON
Public String vSIG()	quit "60782^58664^Jeff Walton^1856"	// Signature - LTD^TIME^USER^SIZE
